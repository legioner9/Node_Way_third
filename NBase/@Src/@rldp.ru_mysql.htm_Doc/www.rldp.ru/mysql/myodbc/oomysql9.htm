<HTML>
<HEAD>
  <TITLE>OpenOffice.org 1.0, ODBC и MySQL</TITLE>
  <META NAME="Author" CONTENT="Alexey V. Pautov">
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=koi8-r">
  <META NAME="GENERATOR" CONTENT="Dos Navigator 1.51.04/DOS.">
</HEAD>

<BODY>

<script type="text/javascript">
nN = navigator.appName;
function fsearch(str)
{
  if (document.fform.myradio[0].checked) {
     open('../../../yandex.ru/sitesearch@text=' + str + '&site=' +
          document.location.hostname);
  } else {open('../../../yandex.ru/sitesearch@text=' + str);}
}

function MouseUpHandler(e)
{
  if (nN == 'Netscape' || nN == 'Opera') {
     if (document.getSelection()) {
        str = document.getSelection();
        newstr = str.replace(/\n+/g, ' ');
        str = newstr.replace(/\ +/g, ' ');
        if (str.length > 100) {
           var i;
           i = 0;
           str = str.slice(0, 100);
           i = str.lastIndexOf(' ');
           if (i > 0){str = str.slice(0, i);}
        }
        document.fform.strf.value = str;
     }
  } else if(nN == 'Microsoft Internet Explorer') {
    if (document.selection.createRange()) {
       var range = document.selection.createRange();
       var str = range.text;
    }
    if (str) {
       str = str.replace(/\ +/g, " ");
       document.fform.strf.value = str;
    }
  }
  return true;
}
if (window.Event) {document.captureEvents(Event.MOUSEUP);}
document.onmouseup = MouseUpHandler;
</script>

<center><table><tr><td><a href="../../default.htm">
<IMG SRC="../../img/b_book.gif" ALT="RussianLDP" HEIGHT=48 WIDTH=55
ALIGN=ABSCENTER></a></td>

<td><!--Rating@Mail.ru COUNTEr-->
<a target=_top href="../../../top.mail.ru/jump@from=1364238">
<img src="../../../d1.cd.b4.a1.top.list.ru/counter@id=1364238;t=230"
border=0 height=31 width=88 alt="Рейтинг@Mail.ru"/></a>
</td><!--/COUNTER-->

<td><!-- begin of Top100 code -->
<script id="top100Counter" type="text/javascript"
src="../../../cnt.rambler.ru/top100.jcn@1448139"></script>
<noscript><a href="../../../top100.rambler.ru/top100/default.htm">
<img src="../../../cnt.rambler.ru/top100.cnt@1448139" alt="Rambler's Top100"
width="81" height="63" border="0" /></a></noscript>
<!-- end of Top100 code --></td>

<td><!-- HotLog -->
<script type="text/javascript" language="javascript">
hotlog_js="1.0";
hotlog_r=""+Math.random()+"&s=525943&im=127&r="+escape(document.referrer)+
"&pg="+escape(window.location.href);
document.cookie="hotlog=1; path=/"; hotlog_r+="&c="+(document.cookie?"Y":"N");
</script>
<script type="text/javascript" language="javascript1.1">
hotlog_js="1.1";hotlog_r+="&j="+(navigator.javaEnabled()?"Y":"N")
</script>

<script type="text/javascript" language="javascript1.2">
hotlog_js="1.2";
hotlog_r+="&wh="+screen.width+'x'+screen.height+"&px="+
(((navigator.appName.substring(0,3)=="Mic"))?
screen.colorDepth:screen.pixelDepth)</script>

<script type="text/javascript" language="javascript1.3">
hotlog_js="1.3"</script>
<script type="text/javascript" language="javascript">
hotlog_r+="&js="+hotlog_js;
document.write("<a href='../../../click.hotlog.ru/@525943' target='_top'>
<img "+" src='http://hit27.hotlog.ru/cgi-bin/hotlog/count?"+
hotlog_r+"&' border=0 width=88 height=31 alt=HotLog><\/a>")</script>

<noscript>
<a href="../../../click.hotlog.ru/@525943" target="_top">
<img src="../../../hit27.hotlog.ru/cgi-bin/hotlog/count@s=525943&im=127"
border="0" width="88" height="31" alt="HotLog"></a></noscript></td>
<!-- /HotLog -->

<td><!--LiveInternet counter--><script type="text/javascript"><!--
document.write("<a href='../../../www.liveinternet.ru/click' "+
"target=_blank><img src='http://counter.yadro.ru/hit?t52.15;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";"+Math.random()+"' alt='' title='LiveInternet: показано число просмотров и"+
" посетителей за 24 часа' "+"border=0 width=88 height=31><\/a>")//-->
</script></td></tr>
<!--/LiveInternet-->

<tr><td><FONT SIZE=-1><b>WebMoney:&nbsp;</b><br>
WMZ Z294115950220&nbsp;<br>
WMR R409981405661&nbsp;<br>
WME E134003968233&nbsp;</FONT></td>

<td><FONT SIZE=-1><b>Visa&nbsp;</b><br>
4274 3200 2453 6495&nbsp;</FONT></td>
</tr></table></center>
<P><index><table><tr><td>

<H1>7 OpenOffice.org 1.0, ODBC и MySQL</H1>
<H2>Access для Linux</H2>
<P>Появление OpenOffice.org 1.0 в 2002 году устранило одну из главных проблем
распространения Linux на конторских машинах. Наконец-то пользователи Linux
получили нормальное конторское программное обеспечение: текстовый процессор,
электронную таблицу, графику, которое не только работает по крайней мере
также как эквиваленты из Microsoft Office, но может также работать с
форматами данных из Microsoft Office и имеет открытые исходные тексты.
Однако, это не предотвратило возражения пользователей пакетов Microsoft, что
они все еще не могут перейти на Linux, поскольку "Linux не имеет аналога
Microsoft Access". Ну да, не имеет! Еще как имеет. Один из скрытых нюансов
OpenOffice.org 1.0 то, что он также имеет интерфейс для баз данных. Все, что
Вы должны сделать, это подключиться к любой базе данных под Linux, а их уже
написано немало. Этот документ объясняет, как сделать это соединение, а затем
обеспечивает краткий просмотр инструментальных средств баз данных внутри
OpenOffice.org 1.0. Многие пользователи не придают значения скрытым
возможностям, порой даже не знают о них, и бывают поражены ими.

<H2>Параметры программного обеспечения</H2>
<P>OpenOffice.org 1.0 использует ODBC 1 для связи с базами данных. Здесь
рассказано о том, как подключить OpenOffice.org 1.0 к MySQL через unixODBC,
но нет ограничений на то, какую именно СУБД использовать, лишь бы она имела
драйвер для ODBC. Поскольку задачей было все настроить под RedHat Linux 9,
все примеры показывают установку из пакетов RPM. Если Вы используете другой
формат или дистрибутив, общие принципы остаются теми же.

<H2>Замечания для пользователей MS Windows</H2>
<P>Следующий раздел этого документа применяется только к OpenOffice.org 1.0
под Linux. Можно (и довольно просто) установить OpenOffice.org 1.0, MySQL и
MyODBC под MS Windows. Если Вы используете MS Windows, переходите к разделу
"<I>Использование инструментов Data Source Tools в OpenOffice.org 1.0</I>".

<H2>Подсоединение OpenOffice.org 1.0 к MySQL через ODBC</H2>
<I><P>Установка MySQL</B></I>
<P>Проверьте сначала, установлен ли MySQL на Вашей системе. Из меню RedHat:
<P>System Settings
<P>Add/Remove Applications
<P>Выберите "Select SQL Database Server", щелкните на Details и
удостоверьтесь, что MySQL выбран.

<P>Вы должны гарантировать, что сервер базы данных MySQL пребывает в
готовности и выполняется. Из меню RedHat выберите:
<P>System Settings
<P>Server Settings
<P>Services
<P>Удостоверьтесь, что сервис mysqld service запущен.

<P>По умолчанию, процесс установки создает пустую базу данных называемую
<I>test</I>, доступную пользователю <I>test</I> без пароля (обратите внимание:
имя пользователя MySQL представляет собой идентификатор, который Вы передаете
MySQL, когда создаете соединение, это не то имя пользователя, которое Вы
используете, чтобы входить в систему).

<H2>Тестирование MySQL</H2>
<P>Теперь, когда сервер выполняется, и Вы имеете установленное клиентское
программное обеспечение, Вы должны проверить как все это работает. Вы можете
обратиться к серверу из оболочки пользователя. Здесь я войду в систему как
<I>pautov</I>, но с сервером соединюсь как MySQL-пользователь <I>test</I>. Я
дам команду select version()</I>; для проверки работоспособности:
<PRE>
[pautovv@joker pautovv]$ mysql -u test
Welcome to the MySQL monitor. Commands end with ; or \g.
Your MySQL connection id is 1 to server version: 3.23.54
Type 'help;' or '\h' for help. Type '\c' to clear the buffer.
mysql&gt; select version();
+-----------+
| version() |
+-----------+
| 3.23.54   |
+-----------+
1 row in set (0.27 sec)
mysql&gt; exit
Bye
[pautovv@joker pautovv]$
</PRE>

<H2>Установка unixODBC</H2>
<P>Вы должны также убедиться, что программное обеспечение unixODBC было
установлено. К сожалению, RedHat не ставит драйверы MyODBC, которые соединяют
unixODBC с MySQL, и единственый способ установить их: командная строка.
Однако, драйверы MyODBC включены в Disk 2, так что их установка проста:
<PRE>
# rpm -ivh /mnt/cdrom/RedHat/RPMS/MyODBC-2.50.39-11.i386.rpm
warning: /mnt/cdrom/RedHat/RPMS/MyODBC-2.50.39-11.i386.rpm:
         V3 DSA signature: NOKEY, key ID db42a60e
Preparing... ###########################################
[100%]
1:MyODBC     ###########################################
[100%]
[root@joker root]#
</PRE>

<H2>Создание .ini-файлов для ODBC</H2>
<P>Теперь Вы должны установить .ini-файлы, используемые ODBC. Они
представляют собой простые текстовые файлы, которые Вы можете редактировать
используя Ваш любимый текстовый редактор. RedHat помещает шаблоны в /etc.

<P><I>odbcinst.ini</I> перечисляет ODBC-драйверы, установленные в системе. Вы
должны определить только MySQL-драйвер в /etc/odbcinst.ini:
<PRE>
[MySQL]
Description = ODBC for MySQL
Driver = /usr/lib/libmyodbc.so
FileUsage = 1
</PRE>

<P><I>odbc.ini</I> определяет связи, которые пользователи используют, чтобы
работать с фактической базой данных через драйвер. Связи в
<I>/etc/odbc.ini</I> доступны всем пользователям Вашей Linux-системы:
<PRE>
[MySQL-test]
Description = MySQL database test
Driver = MySQL
Server = localhost
Database = test
Port = 3306
</PRE>

<H2>Тестирование ODBC</H2>
<P>Теперь проверим как работает соединение, на сей раз через ODBC. В пакет
unixODBC входит простое средство <I>isql</I>:
<PRE>
[[pautovv@joker pautovv]$ isql MySQL-test test
+---------------------------------------+
| Connected!                            |
| sql-statement                         |
| help [tablename]                      |
| quit                                  |
+---------------------------------------+
SQL&gt; select version()
+----------+
| version()|
+----------+
| 3.23.54  |
+----------+
1 rows affected
1 rows returned
SQL&gt; quit
[pautovv@joker pautovv]$
</PRE>

<P>Если это не работает, попробуйте <I>isql MySQL-test -v</I>, чтобы получить
более полные сообщения об ошибках.

<P>Заметьте, что параметр, который Вы передаете isql (<I>MySQL-test</I>)
передается программному обеспечению ODBC. Оно ищет этот параметр в
<I>odbc.ini</I> и находит драйвер <I>MySQL</I> и информацию для связи. Оно
затем ищет <I>MySQL</I> в <I>odbcinst.ini</I> и находит библиотеки.

<P>Если все это работает, Вы теперь можете спокойно работать с базой данных
MySQL, доступной из ODBC.

<H2>Установка ODBC внутри OpenOffice.org 1.0</H2>
<P>Вы теперь должны сообщить OpenOffice.org 1.0 все относительно Вашего
ODBC-соединения. Внутри OpenOffice.org 1.0 выберите
<I>Tools/Data Sources...</I> из главного меню. Затем нажмите кнопку
<I>New Data Source</I>, чтобы открыть окно <I>Data Source Administration</I>.
Введите в Name <I>MySQL-test</I>, выберите в качестве Database type
<I>ODBC</I> и нажмите кнопку <I>[...]</I>. Затем выберите источник данных,
который Вы только что создали в диалоге <I>Data Source</I>. Нажмите
<I>OK</I>. Теперь в окне <I>Data Source Administration </I> на вкладке
<I>ODBC</I> введите имя пользователя <I>test</I> и нажмите кнопку OK.

<H2>Если Вы используете более раннюю версию RedHat или другой метод установки
</H2>
<P>Если Вы делаете новую рабочую станцию RedHat 9, действуйте как показано
здесь, все будет работать. Кроме драйверов MyODBC, RedHat наконец дозрела до
совместимых версий программных пакетов в одной версии дистрибутива. Более
ранние версии RedHat не работали и требовали, чтобы различные обновления
программного обеспечения были установлены. Например, следующее работает:
<TABLE><TR><TD>RedHat 9</TD><TD>RedHat 8.0</TD><TD>RedHat 7.3</TD></TR>
<TR><TD>mysql-server-3.23.54a-11</TD><TD>mysql-server-3.23.54a-4</TD>
<TD>MySQL-server-3.23.49-1</TD></TR>
<TR><TD>mysql-3.23.54a-11</TD><TD>mysql-3.23.54a-4</TD><TD>MySQL-3.23.49-1
</TD></TR>
<TR><TD>unixODBC-2.2.3-6</TD><TD>unixODBC-2.2.2-3</TD><TD>unixODBC-2.2.1-2
</TD></TR>
<TR><TD>MyODBC-2.50.39-11</TD><TD>MyODBC-2.50.39-4</TD><TD>MyODBC-2.50.39-4
</TD></TR>
<TR><TD>MySQL-shared-3.23.49-1</TD><TD></TD><TD>MySQL-shared-3.23.49-1
</TD></TR></TABLE>

<P>Имеется ошибка в версиях .49a и .50 клиентских библиотек MySQL, которая
мешает работать по ODBC: Вы будете видеть сообщения об ошибках подобные
<I>relocation error: /usr/lib/libmyodbc.so: undefined symbol:
init_dynamic_array</I>. Так что Вы должны получить версию .49 в случае
необходимости, ищите через <I>http://www.rpmfind.net</I>.

<P>Если Вы устанавливаете MySQL из исходных текстов Вы (в большинстве
случаев) должны будете создать базу данных <I>test</I> и
пользователя <I>test</I> сами.

<P>Некоторые установщики используют <I>/usr/local/etc</I> для .ini-файлов и
<I>/usr/local/lib</I> для библиотек.

<P>Иногда ODBC не работает, пока не будут созданы файлы <I>~/.odbc.ini</I>
для каждого пользователя.

<P>Если Вы установили библиотеки в <I>/usr/local/lib</I>, Вы должны перед
запуском OpenOffice.org 1.0 скомандовать:
<PRE>
$ export LD_LIBRARY_PATH=/usr/local/lib
</PRE>

<H2>Использование инструментов Data Source в OpenOffice.org 1.0</H2>
<P><I>Поиск инструментов Data Source</I>
<P>Чтобы использовать функции базы данных в любое время, выберите
<I>View</I>/<I>Data Sources</I> из главного меню или нажмите <I>F4</I>. На
экране Data Sources слева <I>Data Source Explorer</I> показывает все
источники данных в настоящее время известные OpenOffice.org. Применяется
стандартная навигация: щелчок на знаке + покажет дополнительные сведения,
щелчок правой кнопкой мышкой покажет доступные инструментальные средства.
Правая сторона экрана занята <I>Data Source Browser</I>, который показывает
содержание любого в настоящее время выбранного источника данных.

<P><B><I>Работа с определениями таблиц</I>
<P>Создание таблицы</B>
<P>Разверните ссыдку <I>MySQL-test</I> в Data Source Explorer, затем правой
кнопкой мышки кликните на <I><P>Tables</I>. Из появившегося меню выберите
<I>New Table Design</I> для отображения окна Table Design Screen.

<P>Я создам таблицу, чтобы сохранить список торговцев книгами. OpenOffice.org
действует как окно в MySQL, так что правила относительно того, как Вы можете
вызывать поля, какие типы данных являются доступными и т.д., работают
согласно MySQL. Панель в правой нижней части окна содержит
контекстно-чувствительную справку, но для получения полной помощи, Вы должны
обратиться к документации на MySQL.

<P>Обратите внимание, что если Вы хотите модифицировать данные в этой таблице
в OpenOffice.org 1.0, Вы должны определить одно поле как первичный ключ. Вы
можете сделать это, щелкая правой кнопкой мыши на индикаторе на левой стороне
экрана и указывая параметр Primary Key. Это показывает символ ключа. В моем
примере первичным ключом будет ISBN книги. Когда Вы закончили, нажмите кнопку
<I>Save</I>, назовите таблицу <I>stocklist</I> и закройте окно. Ваша новая
таблица будет теперь видна в Data Source Explorer.

<B><P>Построение индексов</B>
<P>Имеется также индексный проектировщик, доступный из окна Table Design,
через меню <I>Tools/Index/Design...</I> или через кнопку <I>Index Design</I>
на инструментальной панели.

<B><P>Изменение определений таблиц</B>
<P>Если Вы должны сделать изменения для полей в вашей таблице, щелкните
правой кнопкой мышки на имени таблицы в the Data Source Explorer и выберите
<I>Edit Table</I>. Это переместит Вас обратно в окно Table Design.

<H2>Редактирование данных</H2>
<P>Таблицы могут быть отредактированы непосредственно из экрана Data Sources:
просто нажмите на имя таблицы в Data Source Explorer, и содержание таблицы
будет отображаться в Data Source Browser справа на экране.

<P>Обратите внимание на навигационную панель (<I>Navigation Bar</I>) внизу
Data Source Browser. Она нужна, чтобы помочь Вам быстро двигаться по таблице.

<P>Обычные соглашения для электронной таблицы также применяются:
<P>Дважды щелкните на заголовке столбца, чтобы изменить ширину столбца.

<P>Щелкните правой кнопкой на заголовке столбца, чтобы изменить ширину
столбца вручную, установить новый формат столбца или скрыть столбец вообще.

<P>Щелкните правой кнопкой на любом из маркеров строки, чтобы установить
высоту строки или переформатировать целую таблицу.

<P>Обратите внимание: любые комментарии, которые Вы ввели в поле Description,
когда Вы настраиваете таблицу, появятся как подсказки, когда Вы перемещаете
курсор мыши поверх заголовка столбца в Data Source Browser.

<B><P>Использование Database Toolbar для работы с Вашими данными</B></I>
<P>Многое из возможностей OpenOffice.org 1.0 обеспечивается Database Toolbar,
которая появляется наверху Data Source Browser. Она содержит следующие кнопки
(перечислены слева направо).

<H2>Отображение и маскировка Data Source Explorer</H2>
<P>Полезно, если Вы хотите максимизировать количество данных, которое Вы
можете видеть на экране. Эта кнопка переключает отображение Data Source
Explorer (виден или нет).

<H2>Find Record</H2>
<P>Эта кнопка отображает диалог <I>Record Search</I>. Обратите внимание, что
это будет искать запись в таблице, просматривая таблицу по записям. Это может
быть медленно на больших таблицах!

<H2>Sort Ascending/Sort Descending</H2>
<P>Нажмите на заголовок столбца, чтобы выбрать поле, а затем при нажиме любой
из этих кнопок данные в Data Source Browser будут отсортированы в порядке
возрастания или убывания значений в выбранном Вами поле.

<P>Обратите внимание: кнопки <I>Sort</I> только изменяют способ, которым
отображаются данные. На основную базу данных они никак не воздействуют.

<H2>AutoFilter</H2>
<P>Auto Filtering представляет собой очень мощный инструмент для отображения
только тех записей, которые отвечают некоторым критериям. Например, один из
издателей в моей таблице называется "Аверс". При нажатии на ячейку,
содержащую слово "Аверс" и последующем нажатии на кнопку <I>AutoFilter</I>
отобразятся только записи, где издателем является "Аверс". Обратите внимание,
что, если Вы теперь делаете другой autofilter, он добавится к тому, который
уже в силе: например, повторите процесс для Cover равного H. Это покажет
только твердые книги издательства "Аверс". Кнопка <I>Remove Filter/Sort</I>
сбросит просмотр таблицы. Обратите внимание: фильтры воздействуют только на
способ, которым таблица отображается, они не изменяют данные в базе данных.

<H2>Default Filter</H2>
<P>При использовании этой кнопки, Вы можете видеть или изменять любой фильтр,
работающий в настоящее время. Например, если Вы использовали функцию
<I>Autofilter</I> как описано выше, и затем нажали на кнопку <I>Default
Filter</I> Вы сможете теперь совершенствовать фильтр, чтобы отобразить
твердые книги издательства "Аверс" по цене больше, чем 200 рублей,
устанавливая дополнительный фильтр.

<H2>Sort</H2>
<P>Кнопки <I>Sort Ascending</I> и <I>Sort Descending</I> уже описаны выше.
Они дают возможность определить простой порядок сортировки на одиночном поле.
Кнопка <I>Sort</I> дает возможность установить более сложные критерии
сортировки, например, в алфавитном порядке заголовков.

<H2>Remove Filter/Sort</H2>
<P>Эта кнопка возвращает просмотр таблицы к значению по умолчанию.

<H2>Apply Filter</H2>
<P>Если Вы определили фильтр, используя кнопки <I>AutoFilter</I> или
<I>Filter</I>, эта кнопка включает и выключает фильтр.

<H2>Refresh</H2>
<P>Можно открыть множественные окна редактирования той же самой таблицы от
одного пользователя или от многих пользователей, если Вы находитесь в
многопользовательской системе. Нажим кнопки <I>Refresh</I> вынуждает
OpenOffice.org 1.0 перезагружать информацию из базы данных, чтобы отразить
любые изменения, сделанные в другом месте.

<H2>Edit Data</H2>
<P>Если Ваша таблица имеет первичный определенный ключ, нажатие этой кнопки
позволит Вам редактировать данные непосредственно в Data Source Browser.
Любые изменения, которые Вы делаете на экране, будут зарегистрированы в базе
данных, когда Вы переходите к другой записи, или Вы можете применить
непосредственную модификацию, используя кнопку <I>Save Current Record</I>.

<H2>Save Current Record</H2>
<P>Если Вы редактируете запись, нажатие на эту кнопку, вынуждает сервер
немедленно вписать изменения в базу данных.

<H2>Создание нового представления Ваших данных</H2>
<P>Database Toolbar очень мощный инструмент для анализа и работы над Вашими
данными. Однако, иногда полезно вызывать предварительно установленный
просмотр таблицы. Например, мне пригодится просмотр, показывающий только
книги, изданные Нолидж, которые в настоящее время есть в продаже,
отсортированные в алфавитном порядке по заголовкам. В окне Data Sources
в Data Source Explorer щелкните правой кнопкой мыши по <I>Queries</I> и
выберите <I>New Query Design</I>. В диалоге Add Tables пакет запросит Вас
относительно таблиц, используемых в запросе. Добавьте туда <I>stocklist</I> и
закройте диалог Add Tables Dialogue. Затем Вы попадете на экран Query Design,
где можете разрабатывать Ваш запрос.

<H2>Строки в Query Design</H2>
<I><P>Field</B></I>
<P>Поля, которые будут включены в запрос могут быть дважды нажаты в
верхнем подокне, перетащены из верхнего подокна или введены, нажимая в строке
Field подокна нижней части и используя раскрывающийся список.

<B><I><P>Alias</B></I>
<P>Строка Alias позволяет Вам изменять заголовок столбца.

<B><I><P>Visible</B></I>
<P>Строка Visible позволяет полям использоваться в критериях выбора,
но не отображаться.

<B><P>Functions</B></I>
<P>Строка Function позволяет Вам определять резюме или группирующие функции.

<B><I><P>Criterion</B></I>
<P>Строка Criterion фильтрует определения: здесь я определил, что издатель
равняется Нолидж, и Status равен not empty (null).

<B><P>Query Toolbar</B>
<P>Query Toolbar обеспечивает большее количество функциональных возможностей:

<B><I><P>Run Query</B></I>
<P>Немедленно отобразит результаты Вашего запроса в новом Data Source
Browser. Обратите внимание, что этот новый Data Source Browser также имеет
свою собственную инструментальную панель!

<B><I><P>Clear Query</B></I>
<P>Нажим этой кнопки немедленно очищает запрос.

<B><P>Switch Design View On/Off</B></I>
<P>Query Designer транслирует Ваш проект запроса в команды SQL, которые
понимает MySQL. Для продвинутых пользователей эта кнопка включит отображение
необработанных команд SQL, сгенерированных Query Designer. Вы можете
редактировать эти команды непосредственно, и изменения будут
отражены в Data Designer.

<P>Можно записать просто написать запрос SQL, который является слишком
сложным для Query Designer. Всегда сохраняйте запросы перед переключением
обратно на Design View.

<B><I><P>Add tables...</B></I>
<P>Позволяет Вам помещать множественные таблицы в запрос.

<B><I><P>Functions/Table Name/Alias</B></I>
<P>Эти кнопки нужны, чтобы отобразить или скрыть соответствующие
строки в Query Designer.

<B><I><P>Distinct Values</B></I>
<P>Этот переключатель позволяет Вам создавать запрос, чтобы ответить на
вопросы, подобные: "показать мне всех авторов, кто находится в stocklist".
Пример, который я использую, имеет 25000 записей. Если Вы пробуете отвечать
на вопрос созданием запроса без нажатия кнопки <I>Distinct</I>,
OpenOffice.org 1.0 честно покажет все 25000. Ему все равно, что многих
авторов он перечислит по нескольку раз. Запрос с <I>Distinct</I> покажет
каждого автора только один раз. Это именно то, что нужно.

<B><I><P>Edit</B></I>
<P>Кнопка <I>Edit</I> переключает режим редактирования в Query Design.

<B><I><P>Save</B></I>
<P>Сохраняет Query Design. Если запрос был сохранен, он доступен внутри
Data Source Explorer, а содержание может просматриваться в
Data Source Browser.

<H2>Более сложные запросы</H2>
<P>Data Designer представляет собой мощный инструмент для создания запросов,
что означает, что Вы можете выполнять повседневные запросы без надобности
знать что-либо про SQL. Это включает таблицы подведения итогов и соединение.

<H2>Пример 1. Заказы под рукой</H2>
<P>Предположим, что Вы создали таблицу <I>Orders</I>, которая хранит книги,
которые заказаны. Здесь Вы записываете ISBN каждой книги и количество ее
копий для поставки.

<P>Связывание таблиц
<P>Обратите внимание, как две таблицы связаны через общее поле ISBN. Чтобы
создать связь в Query Designer, просто перетащите и положите нужное поле из
одного списка в другой.

<P>Запросы сохранены в файле <I>DataAccess.xml</I> глубоко внутри Вашей
структуры каталога OpenOffice.org.

<P>Вы можете также выполнять любые команды SQL непосредственно, например,
специфические для MySQL команды, которые не понятны Data Designer или ODBC.

<P>Продвинутые пользователи могут определять тип связи, дважды нажимая
на строке соединения.

<B><P>Вычисляемые поля</B>
<P>Поле Value определено как произведение Price и Order_Qty, вводя
вычисление в запись Field.

<B><P>Форматирование данных</B>
<P>Поля No, Price и Value форматируются, щелкая правой кнопкой мыши на
релевантных столбцах и выбирая соответствующие опции.

<H2>Пример 2: Итоговые заказы</H2>
<B><P>Функции Group и Sum</B>
<P>Часто используемые вместе функции <I>Group</I> и <I>Sum</I> определяют,
какие данные требуются (Group) и что с ними делать (Sum).

<B><P>Использование Data Sources в других программах в OpenOffice.org 1.0</B>
<P>Пока этот документ был сконцентрирован на доступе к данным, используя
метод <I>F4 View</I>/<I>Data Sources</I>. Однако, иногда более удобно
переместить данные непосредственно в другой инструмент, типа OpenOffice 1.0,
например, <I>Calc</I> или <I>Writer</I>. Этот раздел показывает Вам,
как это сделать.

<P><B><I>Calc:</I> создание связи методом Drag and Drop</B>
<P>Извлечение данных из Data Source в электронную таблицу в OpenOffice.org
выполняется простым перетаскиванием. В Calc нажмите <I>F4</I> или из меню
выберите <I>View/Data Sources...</I> и откройте таблицу или запрос, который
хотите скопировать в Calc. Самое простое, если Вы меняете режим просмотра с
<I>Stick</I> на <I>Floating</I> (используйте пиктограмму штырька в левом
нижнем углу Data Source Explorer). Чтобы перенести данные в электронную
таблицу, просто нажмите на данные и перетащите их в электронную таблицу.
Когда Вы их положите, будет создана связь между электронной
таблицой и источником данных.

<B><P>Меню Options</B>
<P>Если Вы создали связь, имеется ряд команд меню, которые Вы можете счесть
полезными, доступные из главного меню, когда Вы выбираете ячейку, содержащую
связанные данные. В любое время, когда Вы захотите модифицировать электронную
таблицу с последними данными в базе данных, выберите из главного меню
<I>Data/Refresh Range</I>. Окно <I>Data</I>/<I>Define Range</I> и его кнопка
нажмите <I>More</I> позволяют Вам выбрать, импортируются ли заголовки
столбца, сохраняется ли Ваше собственное форматирование и сохраняются ли
импортированные данные в таблице.

<B><P>Data Pilot</B>
<P>Data Pilot может обращаться к данным напрямую из Data Sources, давая
удивительно мощный инструмент для многотабличных запросов.

<B><P>Writer</I>: создание связей с помощью метода Drag and Drop</B>
<P>Хотя должно быть можно перетащить и положить данные в текстовый документ
таким же образом, как и в электронную таблицу, это не работает правильно в
OpenOffice.org 1.0. Однако, эта проблема решаема.

<H2>Использование Database Toolbar</H2>
<P>Выбор данных в Data Source Browser включает две кнопки:
<I>Data to Text...</I> и <I>Data to Fields...</I>.

<B><P>Data to Text...</B>
<P>Имеются три опции, доступные из этой инструментальной панели.
<P><I>Insert Data as Table</I> позволяет Вам выбирать поля из исходных
данных, чьи данные будут скопированы в столбцы таблицы в Вашем документе.
Обычные опции форматирования таблицы доступны. Данные скопированы как простой
текст и не будет изменяться при внесении изменений в базу данных.

<P><I>Insert Data as Text</I> точно так же ожидает, что данные просто будут
скопированы без того, чтобы форматироваться как таблица. Обратите внимание:
это один из способов преобразовать источник данных в разграниченный запятыми
текстовый файл для экспорта в другое программное обеспечение.

<P><I>Data to Fields...</I> используется для операций типа составления
стандартных писем. Средства составления стандартных писем в OpenOffice.org
1.0 являются всесторонними и находятся вне рамок этого документа.

<H2>Использование Form AutoPilot</H2>
<P>OpenOffice.org 1.0 содержит полную среду програмирования, используя
вариант популярного языка программирования BASIC. При использовании этой
среды, разработчики могут писать полные приложения для конечных
пользователей, типа сложных форм. Возможно создать полностью функционирующую
форму без знания программирования, использованием <I>Form AutoPilot</I>.

<H2>Form AutoPilot в действии</H2>
<P>Из главного меню выберите <I>File</I>/<I>AutoPilot</I>/<I>Form...</I>.
Отметьте базу данных <I>MySQL-test</I> и запрос <I>Orders on Hand</I>.
Скопируйте все поля из окна <I>Existing Fields</I> в окно <I>Fields in
Form</I> и нажмите кнопку <I>Next</I>.

<P>OpenOffice.org 1.0 начнет формировать вашу форму в новом окне. В диалоге
<I>Choose Layout</I> любые выборки, которые Вы делаете, будут отражены
немедленно в новой форме. Закончите нажатием <I>Create</I>. AutoPilot
встраивает в одну форму все функциональные возможности необходимые, чтобы
поддержать эту таблицу, при работе с Data Navigation и Database Toolbar
включая обычно используемые инструментальные средства для фильтрации,
сортировки и т. д. Это очень простой способ создать простое приложение базы
данных. Обратите внимание: если Вы хотите исследовать опции, доступные для
разработки этой формы далее, нажмите кнопку <I>Form</I> на инструментальной
панели слева на экране. Она включает или выключает режим <I>Design</I>. В
режиме <I>Design</I> Вы можете выбирать объекты в форме и правом щелчком мыши
на них отображать и редактировать их реквизиты, данные и события
(<I>Properties</I>, <I>Data</I> и <I>Events</I>).</P>

</index></td><td width="20%">
<script type="text/javascript">
    var begun_auto_colors           = new Array();
    var begun_auto_fonts_size       = new Array();
    var begun_auto_pad              =       97517308;     // идентификатор площадки
    var begun_auto_limit            =              5;     // число объявлений выводимых на площадке
    var begun_auto_width            =            250;     // ширина блока объявлений
    begun_auto_colors[0]            =      '#0000CC';     // цвет ссылки объявлений
    begun_auto_colors[1]            =      '#000000';     // цвет текста объявления
    begun_auto_colors[2]            =      '#00CC00';     // цвет домена объявления
    begun_auto_colors[3]            =      '#FFFFFF';     // цвет фона блока объявлений
    begun_auto_fonts_size[0]        =          '9pt';     // р-мер шрифта ссылки объявлений
    begun_auto_fonts_size[1]        =          '9pt';     // р-мер шрифта текста объявления
    begun_auto_fonts_size[2]        =          '8pt';     // р-мер шрифта домена объявления
    begun_auto_fonts_size[3]        =          '8pt';     // р-мер шрифта заглушки
    var begun_block_type            =     'Vertical';     // тип блока
    var begun_rambler_type          =              1;     // цвет блока поиска Рамблер
    begun_koi8 = 1;
</script>
<script src="../../../autocontext.begun.ru/autocontext.js"
type="text/javascript"></script>
</td></tr></table>

<p><table><tr><td>
<form method="get" name="fform" onSubmit="fsearch(strf.value);
return false;">
<input type="hidden" name="clid" value="39177">
<b>Поиск</b><table><tr>
<td><input type="text" name="strf" size="15" style="font-size: 9pt" /></td></tr>
<tr><td><font size="-1"><input type="radio" name="myradio" value="0"
checked id="at_site"/>
<label for="at_site">На сайте</label><br/>
<input type="radio" name="myradio" value="1" id="at_ya">
<label for="at_ya">В Яндексе</label></font></td></tr>

<tr><td><input type="submit" value="Найти" style="font-size: 9pt"></td></tr>
</table></form></td>
<td>&nbsp;</td><td><script language="JavaScript"
src="../../../b190.takru.com/in.php@id=199275">
</script></td></tr></table></p>

<p><center><table><tr><td><font size="+1"><B>Найди своих коллег!</B></font><BR>
<script language="javascript"
src="../../../rldp.lovemesweet.ru/banner/db.js.php@rows=01&cols=05&bg=33FF33&sex=0&afrom=18&ato=99&headgif=&sf=1&nwnd=1&pmin=0&cid=RU&tid=0&smu=0&tcl1=000000&tcl2=FF0000">
</script></td>

<td><iframe src="../../../www.linuxcenter.ru/trans/list.phtml@ref=121965&n=5&price=yes"
frameborder="0" vspace="0" hspace="0" width="300" height="350" marginwidth="0"
marginheight="0" scrolling="no"></iframe></td></tr></table></center></p>

<script type="text/javascript" src="../../../bin-layer.ru/popup-686-1.js">
</script>


</BODY>
</HTML>
