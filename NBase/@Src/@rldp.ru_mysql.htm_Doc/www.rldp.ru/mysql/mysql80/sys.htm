<html>
<head>
  <META NAME="Author" CONTENT="Alexey V. Pautov">
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=koi8-r">
  <title>Глава 24. MySQL sys Schema</title>
<meta name="generator" content="DocBook XSL Stylesheets + chunker.py v1.9.2" />
</head>

<body>
<script type="text/javascript">
nN = navigator.appName;
function fsearch(str)
{
  if (document.fform.myradio[0].checked) {
     open('../../../yandex.ru/sitesearch@text=' + str + '&site=' +
          document.location.hostname);
  } else {open('../../../yandex.ru/sitesearch@text=' + str);}
}

function MouseUpHandler(e)
{
  if (nN == 'Netscape' || nN == 'Opera') {
     if (document.getSelection()) {
        str = document.getSelection();
        newstr = str.replace(/\n+/g, ' ');
        str = newstr.replace(/\ +/g, ' ');
        if (str.length > 100) {
           var i;
           i = 0;
           str = str.slice(0, 100);
           i = str.lastIndexOf(' ');
           if (i > 0){str = str.slice(0, i);}
        }
        document.fform.strf.value = str;
     }
  } else if(nN == 'Microsoft Internet Explorer') {
    if (document.selection.createRange()) {
       var range = document.selection.createRange();
       var str = range.text;
    }
    if (str) {
       str = str.replace(/\ +/g, " ");
       document.fform.strf.value = str;
    }
  }
  return true;
}
if (window.Event) {document.captureEvents(Event.MOUSEUP);}
document.onmouseup = MouseUpHandler;
</script>

<center><table><tr><td><a href="../../default.htm">
<IMG SRC="../../img/b_book.gif" ALT="RussianLDP" HEIGHT=48 WIDTH=55
ALIGN=ABSCENTER></a></td>

<td><!--Rating@Mail.ru COUNTEr-->
<a target=_top href="../../../top.mail.ru/jump@from=1364238">
<img src="../../../d1.cd.b4.a1.top.list.ru/counter@id=1364238;t=230"
border=0 height=31 width=88 alt="Рейтинг@Mail.ru"/></a>
</td><!--/COUNTER-->

<td><!-- begin of Top100 code -->
<script id="top100Counter" type="text/javascript"
src="../../../cnt.rambler.ru/top100.jcn@1448139"></script>
<noscript><a href="../../../top100.rambler.ru/top100/default.htm">
<img src="../../../cnt.rambler.ru/top100.cnt@1448139" alt="Rambler's Top100"
width="81" height="63" border="0" /></a></noscript>
<!-- end of Top100 code --></td>

<td><!-- HotLog -->
<script type="text/javascript" language="javascript">
hotlog_js="1.0";
hotlog_r=""+Math.random()+"&s=525943&im=127&r="+escape(document.referrer)+
"&pg="+escape(window.location.href);
document.cookie="hotlog=1; path=/"; hotlog_r+="&c="+(document.cookie?"Y":"N");
</script>
<script type="text/javascript" language="javascript1.1">
hotlog_js="1.1";hotlog_r+="&j="+(navigator.javaEnabled()?"Y":"N")
</script>

<script type="text/javascript" language="javascript1.2">
hotlog_js="1.2";
hotlog_r+="&wh="+screen.width+'x'+screen.height+"&px="+
(((navigator.appName.substring(0,3)=="Mic"))?
screen.colorDepth:screen.pixelDepth)</script>

<script type="text/javascript" language="javascript1.3">
hotlog_js="1.3"</script>
<script type="text/javascript" language="javascript">
hotlog_r+="&js="+hotlog_js;
document.write("<a href='../../../click.hotlog.ru/@525943' target='_top'>
<img "+" src='http://hit27.hotlog.ru/cgi-bin/hotlog/count?"+
hotlog_r+"&' border=0 width=88 height=31 alt=HotLog><\/a>")</script>

<noscript>
<a href="../../../click.hotlog.ru/@525943" target="_top">
<img src="../../../hit27.hotlog.ru/cgi-bin/hotlog/count@s=525943&im=127"
border="0" width="88" height="31" alt="HotLog"></a></noscript></td>
<!-- /HotLog -->

<td><!--LiveInternet counter--><script type="text/javascript"><!--
document.write("<a href='../../../www.liveinternet.ru/click' "+
"target=_blank><img src='http://counter.yadro.ru/hit?t52.15;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";"+Math.random()+"' alt='' title='LiveInternet: показано число просмотров и"+
" посетителей за 24 часа' "+"border=0 width=88 height=31><\/a>")//-->
</script></td></tr>
<!--/LiveInternet-->

<tr><td><FONT SIZE=-1><b>WebMoney:&nbsp;</b><br>
WMZ Z294115950220&nbsp;<br>
WMR R409981405661&nbsp;<br>
WME E134003968233&nbsp;</FONT></td>

<td><FONT SIZE=-1><b>Visa&nbsp;</b><br>
4274 3200 2453 6495&nbsp;</FONT></td>
</tr></table></center>
<P><index><table><tr><td>

<h1><a name="sys-schema"></a>Глава 24. MySQL sys Schema</h1>
<p>MySQL 8.0 схему <a href="sys.htm"><code>sys</code></a>,
ряд объектов, который помогает DBA и разработчикам, интерпретирует данные,
собранные Performance Schema. <a href="sys.htm"><code>sys</code></a>
объекты схемы могут использоваться для типичной настройки и случаев
использования диагноза. Объекты в этой схеме включают:</p>

<ul><li><p>Представления, которые суммируют данные Performance Schema
в более понятную форму.</li>
<li>Хранимые процедуры, которые выполняют операции, такие как настройка
Performance Schema и производство диагностических отчетов.</li>
<li>Сохраненные функции, которые запрашивают конфигурацию Performance Schema
и оказывают услуги форматирования.</p></li></ul>

<p>Для новых установок <a href="sys.htm"><code>sys</code></a> schema
установлена по умолчанию во время инициализации каталога данных, если Вы
используете <a href="programs.htm#mysqld"><span><strong>mysqld</strong>
</span></a> с опцией <a href="server.htm#option_mysqld_initialize"><code>
--initialize</code></a> или
<a href="server.htm#option_mysqld_initialize-insecure"><code>
--initialize-insecure</code></a>. Если это не желаемо, Вы можете удалить
<a href="sys.htm"><code>sys</code></a> schema вручную после инициализации.
</p>

<p><a href="programs.htm#mysql-upgrade"><span><strong>mysql_upgrade</strong>
</span></a> вернет ошибку, если <a href="sys.htm"><code>sys</code></a> schema
существует, но не имеет представления
<a href="#sys-version"><code>version</code></a>,
при условии, что отсутствие этого представления указывает на создаваемую
пользователем <code>sys</code> schema. Чтобы обновить в этом случае, удалите
или переименуйте существующую <a href="sys.htm"><code>sys</code></a> schema.
</p>

<p>Объекты <a href="sys.htm"><code>sys</code></a> schema имеют
<code>DEFINER</code> <code>'mysql.sys'@'localhost'</code>.
Использование специализированного пользователя <code>mysql.sys</code>
избегает проблем, которые происходят, если DBA переименовывает или удаляет
учетную запись <code>root</code>.</p>

<h2><a name="sys-schema-prerequisites"></a>24.1.
Предпосылки для использования sys Schema</h2>
<p>Перед использованием <a href="sys.htm"><code>sys</code></a> schema
предпосылки, описанные в этом разделе, должны быть удовлетворены.</p>

<p><a href="sys.htm"><code>sys</code></a> schema требует MySQL 5.6 или выше.
</p>
<p>Поскольку <a href="sys.htm"><code>sys</code></a> schema
обеспечивает альтернативное средство доступа к Performance Schema, то
Performance Schema должна быть включена для работы
<a href="sys.htm"><code>sys</code></a> schema. См.
<a href="perfor.htm#performance-schema-startup-configuration">раздел 23.2.2
</a>.</p>

<p>Для полного доступа к <a href="sys.htm"><code>sys</code></a> schema
у пользователя должны быть эти привилегии:</p>
<ul><li><p><a href="security.html#priv_select"><code>SELECT</code></a> на
всех таблицах и представлениях <a href="sys.htm"><code>sys</code></a>.</li>

<li><a href="security.html#priv_execute"><code>EXECUTE</code></a> на
всех хранимых процедурах и функциях <a href="sys.htm"><code>sys</code></a>.
</li>

<li><a href="security.html#priv_insert"><code>INSERT</code></a> и
<a href="security.html#priv_update"><code>UPDATE</code></a> для таблицы
<a href="#sys-sys-config"><code>sys_config</code></a>, если изменения
должны быть произведены.</li>

<li>Дополнительные привилегии для хранимых процедур и функций
<a href="sys.htm"><code>sys</code></a>, как отмечено в их описаниях,
например, процедуры <a href="#sys-ps-setup-save"><code>ps_setup_save()
</code></a>.</p></li></ul>

<p>Также необходимо иметь привилегии для объектов, лежащих в основе
<a href="sys.htm"><code>sys</code></a> schema:</p>

<ul><li><p><a href="security.html#priv_select"><code>SELECT</code></a>
на любых таблицах Performance Schema, к которым получают доступ объекты
<a href="sys.htm"><code>sys</code></a>
и <a href="security.html#priv_update"><code>UPDATE</code></a>
для любых таблиц, которые будут обновлены, используя объекты
<a href="sys.htm"><code>sys</code></a> schema.</li>

<li><a href="security.html#priv_process"><code>PROCESS</code></a> для таблицы
<code>INFORMATION_SCHEMA</code>
<a href="inform.htm#innodb-buffer-page-table"><code>INNODB_BUFFER_PAGE</code>
</a>.</p></li></ul>

<p>Определенные инструменты и потребители Performance Schema должны быть
включены и (для инструментов) рассчитаны, чтобы в полной мере воспользоваться
возможностями <a href="sys.htm"><code>sys</code></a> schema:</p>

<ul><li><p>Все <code>wait</code> инструменты.</li>
<li>Все <code>stage</code> инструменты.</li>
<li>Все <code>statement</code> инструменты.</li>
<li><code><em><code>xxx</code></em>_current</code> и
<code><em><code>xxx</code></em>_history_long</code> для всех событий.
</p></li></ul>

<p>Вы можете использовать <a href="sys.htm"><code>sys</code></a> schema
непосредственно, чтобы включить все
дополнительные инструменты и потребители:
<pre>
CALL sys.ps_setup_enable_instrument('wait');
CALL sys.ps_setup_enable_instrument('stage');
CALL sys.ps_setup_enable_instrument('statement');
CALL sys.ps_setup_enable_consumer('current');
CALL sys.ps_setup_enable_consumer('history_long');
</pre>

<p>Для использования <code>sys</code> schema Performance Schema
по умолчанию достаточна для сбора данных. Включение всех инструментов и
потребителец оказывает исполнительное влияние, таким образом, предпочтительно
включать только ту дополнительную конфигурацию, в которой Вы нуждаетесь.
Кроме того, помните, что, если Вы включаете дополнительную конфигурацию, Вы
можете легко восстановить конфигурацию по умолчанию:
<pre>
CALL sys.ps_setup_reset_to_default(TRUE);
</pre>

<h2><a name="sys-schema-usage"></a>24.2. Применение sys Schema</h2>
<p>Вы можете сделать <a href="sys.htm"><code>sys</code></a> schema схемой
по умолчанию так, чтобы ссылки на ее объекты не были
квалифицированы с именем схемы:
<pre>
mysql&gt; USE sys;
Database changed
mysql&gt; SELECT * FROM version;
+-------------+---------------------+
| sys_version | mysql_version       |
+-------------+---------------------+
| 1.5.1       | 8.0.1-dmr-debug-log |
+-------------+---------------------+
</pre>
Обзор <a href="#sys-version"><code>version</code></a> показывает
версии <a href="sys.htm"><code>sys</code></a> schema и сервера MySQL.</p>

<p>Для доступа к объектам <a href="sys.htm"><code>sys</code></a> schema
в то время как по умолчанию принята иная схема, надо квалифицировать
объектные ссылки с именем схемы:
<pre>
mysql&gt; SELECT * FROM sys.version;
+-------------+---------------------+
| sys_version | mysql_version       |
+-------------+---------------------+
| 1.5.1       | 8.0.1-dmr-debug-log |
+-------------+---------------------+
</pre>
Примеры в этой главе обычно принимают
<a href="sys.htm"><code>sys</code></a> как схему по умолчанию.</p>

<p><code>sys</code> содержит много представлений, которые суммируют
таблицы Performance Schema различными способами. Большинство этих
представлений прибывает в пары, где у одного члена пары есть то же самое имя,
как у другого участника, плюс приставка <code>x$</code>. Например, обхор
<a href="#sys-host-summary-by-file-io"><code>host_summary_by_file_io
</code></a> суммирует ввод/вывод файла, сгруппированный по хостам, и выводит
на экран времена ожидания, преобразованные от пикосекунд в более
читаемые значения (с модулями):
<pre>
mysql&gt; SELECT * FROM host_summary_by_file_io;
+------------+-------+------------+
| host       | ios   | io_latency |
+------------+-------+------------+
| localhost  | 67570 | 5.38 s     |
| background |  3468 | 4.18 s     |
+------------+-------+------------+
</pre>

Представление <a href="#sys-host-summary-by-file-io"><code>
x$host_summary_by_file_io</code></a> суммирует те же самые данные, но выводит
на экран неотформатированные времена ожидания в пикосекундах:
<pre>
mysql&gt; SELECT * FROM x$host_summary_by_file_io;
+------------+-------+---------------+
| host       | ios   | io_latency    |
+------------+-------+---------------+
| localhost  | 67574 | 5380678125144 |
| background |  3474 | 4758696829416 |
+------------+-------+---------------+
</pre>

Представление без <code>x$</code> предназначен, чтобы обеспечить вывод,
который более удобен для пользователя. Представление с <code>x$</code>
выводит на экран те же самые значения в сырой форме и предназначено больше
для использования с другими инструментами, которые выполняют их собственную
обработку данных. Для дополнительной информации о различиях между
не-<code>x$</code> и <code>x$</code> представлениях см.
<a href="#sys-schema-views">раздел 24.4.3</a>.</p>

<p>Чтобы исследовать определение объекта в
<a href="sys.htm"><code>sys</code></a> schema, используйте соответствующий
запрос <a href="sql.htm#show"><code>SHOW</code></a> или
<a href="inform.htm"><code>INFORMATION_SCHEMA</code></a>.
Например, чтобы исследовать определения представления
<a href="#sys-session"><code>session</code></a> и функции
<a href="#sys-format-bytes"><code>format_bytes()</code></a>,
используйте эти запросы:
<pre>
mysql&gt; SHOW CREATE VIEW session;
mysql&gt; SHOW CREATE FUNCTION format_bytes;
</pre>

Однако, те запросы выводят на экран определения в относительно
неотформатированной форме. Чтобы рассмотреть определения объекта с большим
количеством читаемого форматирования, получите доступ к индивидуальным
файлам <code>.sql</code>, доступным на web-сайте для разработчиков
<a href="sys.htm"><code>sys</code></a> schema
<a href="../../../https@github.com/mysql/mysql-sys" target="_top">
https://github.com/mysql/mysql-sys</a>.</p>

<p><a href="programs.htm#mysqldump"><span><strong>mysqldump</strong></span>
</a> и <a href="programs.htm#mysqlpump"><span><strong>mysqlpump</strong>
</span></a> не выводят <a href="sys.htm"><code>sys</code></a> schema
по умолчанию. Чтобы произвести файл дампа, назовите <a href="sys.htm"><code>
sys</code></a> schema явно на командной строке, используя любую
из этих команд:
<pre>
mysqldump --databases --routines sys &gt; sys_dump.sql
mysqlpump sys &gt; sys_dump.sql
</pre>

Чтобы повторно установить схему из файла дампа, используйте эту команду:
<pre>
mysql &lt; sys_dump.sql
</pre>

<h2><a name="sys-schema-progress-reporting"></a>24.3.
Сообщение продвижения sys Schema</h2>
<p>Следующие представления <a href="sys.htm"><code>sys</code></a> schema
обеспечивают продвижение, сообщающее для продолжительных транзакций:
<pre>
processlist
session
x$processlist
x$session
</pre>

Предполагая, что необходимые инструменты и потребители включены, столбец
<code>progress</code> этих представлений показывает процент работы,
завершенной для этапов по сообщениям поддержки продвижения.</p>

<p>Сообщение продвижения этапа требует, чтобы
<code>events_stages_current</code> был включен, так же как инструменты, для
которых желаема информация о продвижении. Инструменты для этих этапов в
настоящее время поддерживают сообщение продвижения:
<pre>
stage/sql/Copying to tmp table
stage/innodb/alter table (end)
stage/innodb/alter table (flush)
stage/innodb/alter table (insert)
stage/innodb/alter table (log apply index)
stage/innodb/alter table (log apply table)
stage/innodb/alter table (merge sort)
stage/innodb/alter table (read PK and internal sort)
stage/innodb/buffer pool load
</pre>

Для этапов, которые не поддерживают оцененное и завершенное сообщение работы,
или если необходимые инструменты или потребители не включены, столбец
<code>progress</code> всегда <code>NULL</code>.</p>

<h2><a name="sys-schema-reference"></a>24.4. Объектная ссылка sys Schema</h2>
<p><a href="sys.htm"><code>sys</code></a> schema включает таблицы, триггеры,
представления, хранимые процедуры и функции. Следующие разделы обеспечивают
детали для каждого из этих объектов.</p>

<h3><a name="sys-schema-object-index"></a>24.4.1. Индекс объектов sys Schema
</h3>
<p>Следующяя таблица дает список объектов
<a href="sys.htm"><code>sys</code></a> schema и обеспечивает
краткое описание каждого.</p>

<a name="sys-schema-tables-table"></a><p><b>Таблица 24.1. Таблицы и триггеры
sys Schema</b></p>
<table><thead><tr><td align="center">Имя таблицы или триггера</td>
<td align="center">Описание</td></tr></thead>
<tbody><tr><td align="left"><a href="#sys-sys-config"><code>sys_config
</code></a></td>
<td align="left">Параметры конфигурации <a href="sys.htm"><code>sys</code>
</a> schema</td></tr>
<tr><td align="left"><a href="#sys-sys-config-insert-set-user">
<code>sys_config_insert_set_user</code></a></td>
<td align="left">Триггер insert <a href="#sys-sys-config"><code>
sys_config</code></a></td></tr>
<tr><td align="left"><a href="#sys-sys-config-update-set-user"><code>
sys_config_update_set_user</code></a></td>
<td align="left">Триггер update <a href="#sys-sys-config"><code>
sys_config</code></a></td></tr></tbody></table>

<a name="sys-schema-views-table"></a><p><b>Таблица 24.2. Представления
sys Schema</b></p>
<table>
<thead><tr><td align="center">Имя представления</td>
<td align="center">Описание</td></tr></thead>
<tbody><tr><td align="left"><a href="#sys-host-summary"><code>
host_summary</code></a>, <a href="#sys-host-summary"><code>
x$host_summary</code></a></td>
<td align="left">Деятельность запроса, файловый ввод/вывод и соединения,
сгруппированные по хосту.</td></tr>
<tr><td align="left"><a href="#sys-host-summary-by-file-io"><code>
host_summary_by_file_io</code></a>,
<a href="#sys-host-summary-by-file-io"><code>x$host_summary_by_file_io
</code></a></td>
<td align="left">Файловый ввод/вывод, сгруппированный по хосту.</td></tr>
<tr><td align="left"><a href="#sys-host-summary-by-file-io-type">
<code>host_summary_by_file_io_type</code></a>,
<a href="#sys-host-summary-by-file-io-type"><code>
x$host_summary_by_file_io_type</code></a></td>
<td align="left">Файловый ввод/вывод, сгруппированный по
хосту и типам событий.</td></tr>
<tr><td align="left"><a href="#sys-host-summary-by-stages"><code>
host_summary_by_stages</code></a>,
<a href="#sys-host-summary-by-stages"><code>x$host_summary_by_stages
</code></a></td>
<td align="left">Этапы запроса, сгруппированные по хосту.</td></tr>
<tr><td align="left"><a href="#sys-host-summary-by-statement-latency">
<code>host_summary_by_statement_latency</code></a>,
<a href="#sys-host-summary-by-statement-latency"><code>
x$host_summary_by_statement_latency</code></a></td>
<td align="left">Статистика запроса, сгруппированная по хосту.</td></tr>
<tr><td align="left"><a href="#sys-host-summary-by-statement-type">
<code>host_summary_by_statement_type</code></a>,
<a href="#sys-host-summary-by-statement-type"><code>
x$host_summary_by_statement_type</code></a></td>
<td align="left">Выполненные запросы, сгруппированные по хосту и запросу.
</td></tr>
<tr><td align="left"><a href="#sys-innodb-buffer-stats-by-schema">
<code>innodb_buffer_stats_by_schema</code></a>,
<a href="#sys-innodb-buffer-stats-by-schema"><code>
x$innodb_buffer_stats_by_schema</code></a></td>
<td align="left">Буферная информация <code>InnoDB
</code>, сгруппированная схемой.</td></tr>
<tr><td align="left"><a href="#sys-innodb-buffer-stats-by-table">
<code>innodb_buffer_stats_by_table</code></a>,
<a href="#sys-innodb-buffer-stats-by-table"><code>
x$innodb_buffer_stats_by_table</code></a></td>
<td align="left">Буферная информация <code>InnoDB</code>,
сгруппированная схемой и таблицей.</td></tr>
<tr><td align="left"><a href="#sys-innodb-lock-waits"><code>
innodb_lock_waits</code></a>,
<a href="#sys-innodb-lock-waits"><code>x$innodb_lock_waits</code></a>
</td>
<td align="left">Информация о блокировке <code>InnoDB</code>.</td></tr>
<tr><td align="left"><a href="#sys-io-by-thread-by-latency"><code>
io_by_thread_by_latency</code></a>,
<a href="#sys-io-by-thread-by-latency"><code>x$io_by_thread_by_latency
</code></a></td>
<td align="left">Потребители ввода/вывода, сгруппированные потоком.
</td></tr>
<tr><td align="left"><a href="#sys-io-global-by-file-by-bytes"><code>
io_global_by_file_by_bytes</code></a>,
<a href="#sys-io-global-by-file-by-bytes"><code>
x$io_global_by_file_by_bytes</code></a></td>
<td align="left">Глобальные потребители ввода/вывода,
сгруппированные файлом и байтами.</td></tr>
<tr><td align="left"><a href="#sys-io-global-by-file-by-latency">
<code>io_global_by_file_by_latency</code></a>,
<a href="#sys-io-global-by-file-by-latency"><code>
x$io_global_by_file_by_latency</code></a></td>
<td align="left">Глобальные потребители ввода/вывода,
сгруппированные файлом и временем ожидания.</td></tr>
<tr><td align="left"><a href="#sys-io-global-by-wait-by-bytes"><code>
io_global_by_wait_by_bytes</code></a>,
<a href="#sys-io-global-by-wait-by-bytes"><code>
x$io_global_by_wait_by_bytes</code></a></td>
<td align="left">Глобальные потребители ввода/вывода, сгруппированные байтами.
</td></tr>
<tr><td align="left"><a href="#sys-io-global-by-wait-by-latency">
<code>io_global_by_wait_by_latency</code></a>,
<a href="#sys-io-global-by-wait-by-latency"><code>
x$io_global_by_wait_by_latency</code></a></td>
<td align="left">Глобальные потребители ввода/вывода, сгруппированные
временем ожидания.</td></tr>
<tr><td align="left"><a href="#sys-latest-file-io"><code>
latest_file_io</code></a>,
<a href="#sys-latest-file-io"><code>x$latest_file_io</code></a></td>
<td align="left">Новый ввод/вывод, сгруппированный файлом и потоком.</td></tr>
<tr><td align="left"><a href="#sys-memory-by-host-by-current-bytes">
<code>memory_by_host_by_current_bytes</code></a>,
<a href="#sys-memory-by-host-by-current-bytes"><code>
x$memory_by_host_by_current_bytes</code></a></td>
<td align="left">Использование памяти, сгруппированное хостом.</td></tr>
<tr><td align="left"><a href="#sys-memory-by-thread-by-current-bytes">
<code>memory_by_thread_by_current_bytes</code></a>,
<a href="#sys-memory-by-thread-by-current-bytes"><code>
x$memory_by_thread_by_current_bytes</code></a></td>
<td align="left">Использование памяти, сгруппированное потоком.</td></tr>
<tr><td align="left"><a href="#sys-memory-by-user-by-current-bytes">
<code>memory_by_user_by_current_bytes</code></a>,
<a href="#sys-memory-by-user-by-current-bytes"><code>
x$memory_by_user_by_current_bytes</code></a></td>
<td align="left">Использование памяти, сгруппированное пользователем.</td>
</tr>
<tr><td align="left"><a href="#sys-memory-global-by-current-bytes">
<code>memory_global_by_current_bytes</code></a>,
<a href="#sys-memory-global-by-current-bytes"><code>
x$memory_global_by_current_bytes</code></a></td>
<td align="left">Использование памяти, сгруппированное типом распределения.
</td></tr>
<tr><td align="left"><a href="#sys-memory-global-total"><code>
memory_global_total</code></a>,
<a href="#sys-memory-global-total"><code>x$memory_global_total</code>
</a></td>
<td align="left">Полное использование памяти.</td></tr>
<tr><td align="left"><a href="#sys-metrics"><code>metrics</code></a>
</td>
<td align="left">Метрики сервера.</td></tr>
<tr><td align="left"><a href="#sys-processlist"><code>processlist
</code></a>,
<a href="#sys-processlist"><code>x$processlist</code></a></td>
<td align="left">Информация о Processlist.</td></tr>
<tr><td align="left"><a href="#sys-ps-check-lost-instrumentation">
<code>ps_check_lost_instrumentation</code></a></td>
<td align="left">Переменные, которые потеряли инструменты.</td></tr>
<tr><td align="left"><a href="#sys-schema-auto-increment-columns">
<code>schema_auto_increment_columns</code></a></td>
<td align="left">Информация о столбце <code>AUTO_INCREMENT</code>.</td></tr>
<tr><td align="left"><a href="#sys-schema-index-statistics"><code>
schema_index_statistics</code></a>,
<a href="#sys-schema-index-statistics"><code>x$schema_index_statistics
</code></a></td>
<td align="left">Статистика индекса.</td></tr>
<tr><td align="left"><a href="#sys-schema-object-overview"><code>
schema_object_overview</code></a></td>
<td align="left">Типы объектов в пределах каждой схемы.</td></tr>
<tr><td align="left"><a href="#sys-schema-redundant-indexes"><code>
schema_redundant_indexes</code></a></td>
<td align="left">Индексы Duplicate или redundant.</td></tr>
<tr><td align="left"><a href="#sys-schema-table-lock-waits"><code>
schema_table_lock_waits</code></a>,
<a href="#sys-schema-table-lock-waits"><code>x$schema_table_lock_waits
</code></a></td>
<td align="left">Сеансы, ждущие блокировок метаданных.</td></tr>
<tr><td align="left"><a href="#sys-schema-table-statistics"><code>
schema_table_statistics</code></a>,
<a href="#sys-schema-table-statistics"><code>x$schema_table_statistics
</code></a></td>
<td align="left">Табличная статистика.</td></tr>
<tr><td align="left">
<a href="#sys-schema-table-statistics-with-buffer"><code>
schema_table_statistics_with_buffer</code></a>,
<a href="#sys-schema-table-statistics-with-buffer"><code>
x$schema_table_statistics_with_buffer</code></a></td>
<td align="left">Табличная статистика, включая буферную
статистику бассейна <code>InnoDB</code>.</td></tr>
<tr><td align="left">
<a href="#sys-schema-tables-with-full-table-scans"><code>
schema_tables_with_full_table_scans</code></a>,
<a href="#sys-schema-tables-with-full-table-scans"><code>
x$schema_tables_with_full_table_scans</code></a></td>
<td align="left">Таблицы, получаемые доступом с полными просмотрами.</td></tr>
<tr><td align="left"><a href="#sys-schema-unused-indexes"><code>
schema_unused_indexes</code></a></td>
<td align="left">Индексы не в активном использовании.</td></tr>
<tr><td align="left"><a href="#sys-session"><code>session</code></a>,
<a href="#sys-session"><code>x$session</code></a></td>
<td align="left">Информация о Processlist для пользовательских сеансов.</td>
</tr>
<tr><td align="left"><a href="#sys-session-ssl-status"><code>
session_ssl_status</code></a></td>
<td align="left">Информация о соединении SSL.</td></tr>
<tr><td align="left"><a href="#sys-statement-analysis"><code>
statement_analysis</code></a>,
<a href="#sys-statement-analysis"><code>x$statement_analysis</code>
</a></td>
<td align="left">Статистика совокупности запроса.</td></tr>
<tr><td align="left"><a href="#sys-statements-with-errors-or-warnings">
<code>statements_with_errors_or_warnings</code></a>,
<a href="#sys-statements-with-errors-or-warnings"><code>
x$statements_with_errors_or_warnings</code></a></td>
<td align="left">Запросы, которые произвели ошибки или предупреждения.</td>
</tr>
<tr><td align="left"><a href="#sys-statements-with-full-table-scans">
<code>statements_with_full_table_scans</code></a>,
<a href="#sys-statements-with-full-table-scans"><code>
x$statements_with_full_table_scans</code></a></td>
<td align="left">Запросы, которые сделали полное сканирование таблицы.</td>
</tr>
<tr><td align="left">
<a href="#sys-statements-with-runtimes-in-95th-percentile"><code>
statements_with_runtimes_in_95th_percentile</code></a>,
<a href="#sys-statements-with-runtimes-in-95th-percentile"><code>
x$statements_with_runtimes_in_95th_percentile</code></a></td>
<td align="left">Запросы с самым высоким средним временем выполнения.</td>
</tr>
<tr><td align="left"><a href="#sys-statements-with-sorting"><code>
statements_with_sorting</code></a>,
<a href="#sys-statements-with-sorting"><code>x$statements_with_sorting
</code></a></td>
<td align="left">Запросы, которые выполнили сортировки.</td></tr>
<tr><td align="left"><a href="#sys-statements-with-temp-tables"><code>
statements_with_temp_tables</code></a>,
<a href="#sys-statements-with-temp-tables"><code>
x$statements_with_temp_tables</code></a></td>
<td align="left">Запросы, которые использовали временные таблицы.</td></tr>
<tr><td align="left"><a href="#sys-user-summary"><code>user_summary
</code></a>,
<a href="#sys-user-summary"><code>x$user_summary</code></a></td>
<td align="left">Пользовательский запрос и деятельность соединения.</td></tr>
<tr><td align="left"><a href="#sys-user-summary-by-file-io"><code>
user_summary_by_file_io</code></a>,
<a href="#sys-user-summary-by-file-io"><code>x$user_summary_by_file_io
</code></a></td>
<td align="left">Файловый ввод/вывод, сгруппированный пользователем.</td></tr>
<tr><td align="left"><a href="#sys-user-summary-by-file-io-type">
<code>user_summary_by_file_io_type</code></a>,
<a href="#sys-user-summary-by-file-io-type"><code>
x$user_summary_by_file_io_type</code></a></td>
<td align="left">Файловый ввод/вывод,
сгруппированный пользователем и событием.</td></tr>
<tr><td align="left"><a href="#sys-user-summary-by-stages"><code>
user_summary_by_stages</code></a>,
<a href="#sys-user-summary-by-stages"><code>x$user_summary_by_stages
</code></a></td>
<td align="left">События этапа, сгруппированные пользователем.</td></tr>
<tr><td align="left"><a href="#sys-user-summary-by-statement-latency">
<code>user_summary_by_statement_latency</code></a>,
<a href="#sys-user-summary-by-statement-latency"><code>
x$user_summary_by_statement_latency</code></a></td>
<td align="left">Статистика запросов, сгруппированная пользователем.</td></tr>
<tr><td align="left"><a href="#sys-user-summary-by-statement-type">
<code>user_summary_by_statement_type</code></a>,
<a href="#sys-user-summary-by-statement-type"><code>
x$user_summary_by_statement_type</code></a></td>
<td align="left">Выполненные запросы, сгруппированные
пользователем и запросом.</td></tr>
<tr><td align="left"><a href="#sys-version"><code>version</code></a>
</td>
<td align="left">Текущие версии <a href="sys.htm"><code>sys</code></a>
schema и сервера MySQL.</td></tr>
<tr><td align="left"><a href="#sys-wait-classes-global-by-avg-latency">
<code>wait_classes_global_by_avg_latency</code></a>,
<a href="#sys-wait-classes-global-by-avg-latency"><code>
x$wait_classes_global_by_avg_latency</code></a></td>
<td align="left">Среднее время ожидания класса,
сгруппированное классом событий.</td></tr>
<tr><td align="left"><a href="#sys-wait-classes-global-by-latency">
<code>wait_classes_global_by_latency</code></a>,
<a href="#sys-wait-classes-global-by-latency"><code>
x$wait_classes_global_by_latency</code></a></td>
<td align="left">Общее время ожидания класса, сгруппированное классом событий.
</td></tr>
<tr><td align="left"><a href="#sys-waits-by-host-by-latency"><code>
waits_by_host_by_latency</code></a>,
<a href="#sys-waits-by-host-by-latency"><code>
x$waits_by_host_by_latency</code></a></td>
<td align="left">Ждущие события, сгруппированные узлом и событием.</td></tr>
<tr><td align="left"><a href="#sys-waits-by-user-by-latency"><code>
waits_by_user_by_latency</code></a>,
<a href="#sys-waits-by-user-by-latency"><code>
x$waits_by_user_by_latency</code></a></td>
<td align="left">Ждущие события, сгруппированные пользователем и событием.
</td></tr>
<tr><td align="left"><a href="#sys-waits-global-by-latency"><code>
waits_global_by_latency</code></a>,
<a href="#sys-waits-global-by-latency"><code>x$waits_global_by_latency
</code></a></td>
<td align="left">Ждущие события, сгруппированные и событием.</td></tr>
<tr><td align="left">
<a href="#sys-statements-with-runtimes-in-95th-percentile"><code>
x$ps_digest_95th_percentile_by_avg_us</code></a></td>
<td align="left">Вспомогательное представление для 95%-ных представлений.
</td></tr>
<tr><td align="left">
<a href="#sys-statements-with-runtimes-in-95th-percentile"><code>
x$ps_digest_avg_latency_distribution</code></a></td>
<td align="left">Вспомогательное представление для 95%-ных представлений.
</td></tr>
<tr><td align="left"><a href="#sys-schema-table-statistics"><code>
x$ps_schema_table_statistics_io</code></a></td>
<td align="left">Вспомогательное представление для
представлений табличной статистики.</td></tr>
<tr><td align="left"><a href="#sys-schema-redundant-indexes"><code>
x$schema_flattened_keys</code></a></td>
<td align="left">Вспомогательное представление для
<a href="#sys-schema-redundant-indexes"><code>
schema_redundant_indexes</code></a>.</td></tr></tbody></table>

<a name="sys-schema-procedures-table"></a><p><b>Таблица 24.3.
Хранимые процедуры sys Schema</b></p>
<table><thead><tr><td align="center">Имя процедуры</td>
<td align="center">Описание</td></tr></thead>
<tbody><tr><td align="left"><a href="#sys-create-synonym-db"><code>
create_synonym_db()</code></a></td>
<td align="left">Создает синоним для схемы</td></tr>
<tr><td align="left"><a href="#sys-diagnostics"><code>diagnostics()
</code></a></td>
<td align="left">Собирает системную диагностическую информацию</td></tr>
<tr><td align="left"><a href="#sys-execute-prepared-stmt"><code>
execute_prepared_stmt()</code></a></td>
<td align="left">Выполнит подготовленный запрос</td></tr>
<tr><td align="left">
<a href="#sys-ps-setup-disable-background-threads"><code>
ps_setup_disable_background_threads()</code></a></td>
<td align="left">Отключит фоновую инструментовку потока</td></tr>
<tr><td align="left"><a href="#sys-ps-setup-disable-consumer"><code>
ps_setup_disable_consumer()</code></a></td>
<td align="left">Отключит потребителей</td></tr>
<tr><td align="left"><a href="#sys-ps-setup-disable-instrument"><code>
ps_setup_disable_instrument()</code></a></td>
<td align="left">Отключит инструменты</td></tr>
<tr><td align="left"><a href="#sys-ps-setup-disable-thread"><code>
ps_setup_disable_thread()</code></a></td>
<td align="left">Отключит инструментовку для потока</td></tr>
<tr><td align="left">
<a href="#sys-ps-setup-enable-background-threads"><code>
ps_setup_enable_background_threads()</code></a></td>
<td align="left">Включит фоновую инструментовку потока</td></tr>
<tr><td align="left"><a href="#sys-ps-setup-enable-consumer"><code>
ps_setup_enable_consumer()</code></a></td>
<td align="left">Включит потребителей</td></tr>
<tr><td align="left"><a href="#sys-ps-setup-enable-instrument"><code>
ps_setup_enable_instrument()</code></a></td>
<td align="left">Включит инструменты</td></tr>
<tr><td align="left"><a href="#sys-ps-setup-enable-thread"><code>
ps_setup_enable_thread()</code></a></td>
<td align="left">Включит инструментовку для потока</td></tr>
<tr><td align="left"><a href="#sys-ps-setup-reload-saved"><code>
ps_setup_reload_saved()</code></a></td>
<td align="left">Перезагрузит сохраненную конфигурацию Performance Schema
</td></tr>
<tr><td align="left"><a href="#sys-ps-setup-reset-to-default"><code>
ps_setup_reset_to_default()</code></a></td>
<td align="left">Сбросит сохраненную конфигурацию Performance Schema</td>
</tr>
<tr><td align="left"><a href="#sys-ps-setup-save"><code>
ps_setup_save()</code></a></td>
<td align="left">Сохранит конфигурацию Performance Schema</td></tr>
<tr><td align="left"><a href="#sys-ps-setup-show-disabled"><code>
ps_setup_show_disabled()</code></a></td>
<td align="left">Выведет на экран отключенную конфигурацию Performance Schema
</td></tr>
<tr><td align="left"><a href="#sys-ps-setup-show-disabled-consumers">
<code>ps_setup_show_disabled_consumers()</code></a></td>
<td align="left">Выведет на экран отключенных потребителей Performance Schema
</td></tr>
<tr><td align="left"><a href="#sys-ps-setup-show-disabled-instruments">
<code>ps_setup_show_disabled_instruments()</code></a></td>
<td align="left">Выведет на экран отключенные инструменты Performance Schema
</td></tr>
<tr><td align="left"><a href="#sys-ps-setup-show-enabled"><code>
ps_setup_show_enabled()</code></a></td>
<td align="left">Выведет на экран включенную конфигурацию Performance Schema
</td></tr>
<tr><td align="left"><a href="#sys-ps-setup-show-enabled-consumers">
<code>ps_setup_show_enabled_consumers()</code></a></td>
<td align="left">Выведет на экран включенных потребителей Performance Schema
</td></tr>
<tr><td align="left"><a href="#sys-ps-setup-show-enabled-instruments">
<code>ps_setup_show_enabled_instruments()</code></a></td>
<td align="left">Выведет на экран включенные инструменты Performance Schema
</td></tr>
<tr><td align="left"><a href="#sys-ps-statement-avg-latency-histogram">
<code>ps_statement_avg_latency_histogram()</code></a></td>
<td align="left">Выведет на экран гистограмму времени ожидания запросов</td>
</tr>
<tr><td align="left"><a href="#sys-ps-trace-statement-digest"><code>
ps_trace_statement_digest()</code></a></td>
<td align="left">Трассировка инструментов Performance Schema для обзора</td>
</tr>
<tr><td align="left"><a href="#sys-ps-trace-thread"><code>
ps_trace_thread()</code></a></td>
<td align="left">Дамп данных потоков Performance Schema</td></tr>
<tr><td align="left"><a href="#sys-ps-truncate-all-tables"><code>
ps_truncate_all_tables()</code></a></td>
<td align="left">Усеченные сводные таблицы Performance Schema</td></tr>
<tr><td align="left"><a href="#sys-statement-performance-analyzer">
<code>statement_performance_analyzer()</code></a></td>
<td align="left">Сообщение о запросах, работающих на сервере</td></tr>
<tr><td align="left"><a href="#sys-table-exists"><code>table_exists()
</code></a></td>
<td align="left">Существует ли таблица</td></tr></tbody></table>

<a name="sys-schema-functions-table"></a><p><b>Таблица 24.4. Сохраненные
функции sys Schema</b></p>
<table>
<thead><tr><td align="center">Имя функции</td>
<td align="center">Описание</td></tr></thead>
<tbody><tr><td align="left">
<a href="#sys-extract-schema-from-file-name"><code>
extract_schema_from_file_name()</code></a></td>
<td align="left">Извлекает имя схемы из имени пути к файлу</td></tr>
<tr><td align="left"><a href="#sys-extract-table-from-file-name">
<code>extract_table_from_file_name()</code></a></td>
<td align="left">Извлекает имя таблицы из имени пути к файлу</td></tr>
<tr><td align="left"><a href="#sys-format-bytes"><code>format_bytes()
</code></a></td>
<td align="left">Конвертирует байтовое значение, чтобы оценить с модулями
</td></tr>
<tr><td align="left"><a href="#sys-format-path"><code>format_path()
</code></a></td>
<td align="left">Заменяет каталоги данных и временных файлов
в пути с символическими значениями</td></tr>
<tr><td align="left"><a href="#sys-format-statement"><code>
format_statement()</code></a></td>
<td align="left">Усекает длинный запрос к фиксированной длине</td></tr>
<tr><td align="left"><a href="#sys-format-time"><code>format_time()
</code></a></td>
<td align="left">Значение пикосекунд конвертируется, чтобы оценить с модулями
</td></tr>
<tr><td align="left"><a href="#sys-list-add"><code>list_add()</code>
</a></td>
<td align="left">Добавляет элемент в список</td></tr>
<tr><td align="left"><a href="#sys-list-drop"><code>list_drop()</code>
</a></td>
<td align="left">Удалить элемент из списка</td></tr>
<tr><td align="left"><a href="#sys-ps-is-account-enabled"><code>
ps_is_account_enabled()</code></a></td>
<td align="left">Проверить, включена ли инструментовка учетной записи</td></tr>
<tr><td align="left"><a href="#sys-ps-is-consumer-enabled"><code>
ps_is_consumer_enabled()</code></a></td>
<td align="left">Проверить, включен ли потребитель</td></tr>
<tr><td align="left"><a href="#sys-ps-is-instrument-default-enabled">
<code>ps_is_instrument_default_enabled()</code></a></td>
<td align="left">Проверить, включен ли инструмент</td></tr>
<tr><td align="left"><a href="#sys-ps-is-instrument-default-timed">
<code>ps_is_instrument_default_timed()</code></a></td>
<td align="left">Проверить, рассчитан ли инструмент</td></tr>
<tr><td align="left"><a href="#sys-ps-is-thread-instrumented"><code>
ps_is_thread_instrumented()</code></a></td>
<td align="left">Проверить, инструментован ли поток</td></tr>
<tr><td align="left"><a href="#sys-ps-thread-account"><code>
ps_thread_account()</code></a></td>
<td align="left">Возвратит учетную запись для ID потока</td></tr>
<tr><td align="left"><a href="#sys-ps-thread-id"><code>ps_thread_id()
</code></a></td>
<td align="left">Возвратит ID потока для ID соединения</td></tr>
<tr><td align="left"><a href="#sys-ps-thread-stack"><code>
ps_thread_stack()</code></a></td>
<td align="left">Возвратит информацию о событии для ID потока</td></tr>
<tr><td align="left"><a href="#sys-ps-thread-trx-info"><code>
ps_thread_trx_info()</code></a></td>
<td align="left">Возвратит информацию о транзакции для ID потока</td></tr>
<tr><td align="left"><a href="#sys-quote-identifier"><code>
quote_identifier()</code></a></td>
<td align="left">Возвратит строку как заключенный в кавычки идентификатор
</td></tr>
<tr><td align="left"><a href="#sys-sys-get-config"><code>
sys_get_config()</code></a></td>
<td align="left">Возвратит параметр конфигурации
<a href="sys.htm"><code>sys</code></a> schema</td></tr>
<tr><td align="left"><a href="#sys-version-major"><code>
version_major()</code></a></td>
<td align="left">Главный номер версии MySQL</td></tr>
<tr><td align="left"><a href="#sys-version-minor"><code>
version_minor()</code></a></td>
<td align="left">Младший номер версии MySQL</td></tr>
<tr><td align="left"><a href="#sys-version-patch"><code>
version_patch()</code></a></td>
<td align="left">Номер версии выпуска MySQL</td></tr></tbody></table>

<h3><a name="sys-schema-tables"></a>24.4.2. Таблицы и триггеры sys Schema</h3>
<p>Следующие разделы описывают таблицы и триггеры
<a href="sys.htm"><code>sys</code></a> schema.</p>

<h4><a name="sys-sys-config"></a>24.4.2.1. Таблица sys_config</h4>
<p>Эта таблица содержит параметры конфигурации
<a href="sys.htm"><code>sys</code></a> schema, одна строка на опцию.
Изменения конфигурации, произведенные, обновляя эту таблицу, сохраняются
через сеансы клиента и перезапуски сервера.</p>

<p>У таблицы <a href="#sys-sys-config"><code>sys_config</code></a>
есть эти столбцы:</p>
<ul><li><p><code>variable</code></p>
<p>Имя параметра конфигурации.</li>

<li><code>value</code></p>
<p>Значение параметра конфигурации.</li>
<li><code>set_time</code></p>
<p>timestamp новой модификации строки.</li>

<li><code>set_by</code></p>
<p>Учетная запись, которая сделала новую модификацию строки. Значение
<code>NULL</code>, если строка не была изменена, начиная с установки
<a href="sys.htm"><code>sys</code></a> schema.</p></li></ul>

<p>Чтобы минимизировать число прямых чтений таблицы
<a href="#sys-sys-config"><code>sys_config</code></a>, функции
<a href="sys.htm"><code>sys</code></a> schema, которые
используют значение этой табличной проверки на определяемую пользователем
переменную с соответствующим именем, которое является определяемой
пользователем переменной, имеющей то же самое имя плюс <code>@sys.</code>.
Например, переменная, соответствующая опции
<code>diagnostics.include_raw</code>, <code>@sys.diagnostics.include_raw
</code>. Если определяемая пользователем переменная существует в текущем
сеансе и не-<code>NULL</code>, функция использует свое значение в
предпочтении к значению в таблице
<a href="#sys-sys-config"><code>sys_config</code></a>.
Иначе функция читает и использует значение из таблицы. В последнем случае
функция также устанавливает соответствующую определяемую пользователем
переменную в табличное значение так, чтобы дальнейшие ссылки на параметр
конфигурации в пределах того же самого сеанса использовали переменную и не
должны были считать таблицу снова.</p>

<p>Например, опция <code>statement_truncate_len</code>
управляет максимальной длиной запросов, возвращенных функциец
<a href="#sys-format-statement"><code>format_statement()</code></a>.
Значение по умолчанию 64. Чтобы временно изменить значение на 32 для Вашего
текущего сеанса, установите переменную
<code>@sys.statement_truncate_len</code>:
<pre>
mysql&gt; SET @stmt = 'SELECT variable, value, set_time, set_by FROM
                       sys_config';
mysql&gt; SELECT format_statement(@stmt);
+----------------------------------------------------------+
| format_statement(@stmt)                                  |
+----------------------------------------------------------+
| SELECT variable, value, set_time, set_by FROM sys_config |
+----------------------------------------------------------+

mysql&gt; SET @sys.statement_truncate_len = 32;
mysql&gt; SELECT format_statement(@stmt);
+-----------------------------------+
| format_statement(@stmt)           |
+-----------------------------------+
| SELECT variabl ... ROM sys_config |
+-----------------------------------+
</pre>

Последующие запросы
<a href="#sys-format-statement"><code>format_statement()</code></a>
в пределах сеанса продолжают использовать определяемое пользователем
значение переменной (32), а не значение, сохраненное в таблице (64).</p>

<p>Чтобы прекратить использовать определяемую пользователем переменную и
вернуться к использованию значения в таблице, установите переменную в
<code>NULL</code> в пределах Вашего сеанса:
<pre>
mysql&gt; SET @sys.statement_truncate_len = NULL;
mysql&gt; SELECT format_statement(@stmt);
+----------------------------------------------------------+
| format_statement(@stmt)                                  |
+----------------------------------------------------------+
| SELECT variable, value, set_time, set_by FROM sys_config |
+----------------------------------------------------------+
</pre>
Альтернативно, закончите свой текущий сеанс (чтобы заставить определяемую
пользователем переменную больше не существовать) и начните новый сеанс.</p>

<p>Обычные отношения, описанные между опциями в таблице
in the <a href="#sys-sys-config"><code>sys_config</code></a>
и определяемые пользователем переменные могут эксплуатироваться, чтобы
произвести временные изменения конфигурации, которые заканчиваются, когда Ваш
сеанс заканчивается. Однако, если Вы установите определяемую пользователем
переменную и затем впоследствии измените соответствующее табличное значение в
пределах того же самого сеанса, то измененное табличное значение не будет
использоваться в том сеансе, пока определяемая пользователем переменная
существует со значением не <code>NULL</code>. Измененное табличное значение
<span class="emphasis"><em>будет</em></span> использоваться в других сеансах,
которым не назначали определяемую пользователем переменную.</p>

<p>Следующий список описывает опции в таблице
<a href="#sys-sys-config"><code>sys_config</code></a>
и соответствующие определяемые пользователем переменные:</p>

<ul><li><p><code>diagnostics.allow_i_s_tables</code>,
<code>@sys.diagnostics.allow_i_s_tables</code></p>
<p>Если эта опция <code>ON</code>, процедуре
<a href="#sys-diagnostics"><code>diagnostics()</code></a>
разрешают выполнить сканирование таблицы
<a href="inform.htm#tables-table"><code>INFORMATION_SCHEMA.TABLES</code></a>.
Это может быть долго, если есть много таблиц. Значение по умолчанию
<code>OFF</code>.</li>

<li><code>diagnostics.include_raw</code>,
<code>@sys.diagnostics.include_raw</code></p>
<p> Если эта опция <code>ON</code>, процедура
<a href="#sys-diagnostics"><code>diagnostics()</code></a>
включает сырой вывод от запросов обзора
<a href="#sys-metrics"><code>metrics</code></a>.
Значение по умолчанию <code>OFF</code>.</li>

<li><code>ps_thread_trx_info.max_length</code>,
<code>@sys.ps_thread_trx_info.max_length</code></p>
<p>Максимальная длина для вывода JSON, произведенного функцией
<a href="#sys-ps-thread-trx-info"><code>ps_thread_trx_info()</code>
</a>. Значение по умолчанию 65535.</li>

<li><code>statement_performance_analyzer.limit</code>,
<code>@sys.statement_performance_analyzer.limit</code></p>
<p>Максимальное количество строк, чтобы возвратить для представлений, у
которых нет никакого встроенного предела. Например, у представления
<a href="#sys-statements-with-runtimes-in-95th-percentile">
<code>statements_with_runtimes_in_95th_percentile</code></a>
есть встроенный предел в том смысле, что оно возвращает только запросы
со средним временем выполнения в 95%. Значение по умолчанию 100.</li>

<li><code>statement_performance_analyzer.view</code>,
<code>@sys.statement_performance_analyzer.view</code></p>
<p>Пользовательский запрос или представление, которое будет использоваться
процедурой <a href="#sys-statement-performance-analyzer"><code>
statement_performance_analyzer()</code></a> (которая самостоятельно вызвана
<a href="#sys-diagnostics"><code>diagnostics()</code></a>).
Если значение опции содержит пробел, оно интерпретируется как запрос. Иначе,
это должно быть название существующего представления, которое запрашивает
таблицу Performance Schema
<a href="perfor.htm#statement-summary-tables"><code>
events_statements_summary_by_digest</code></a>.
Не может быть никакого предложения <code>LIMIT</code>
в запросе или определение представления, если параметр конфигурации
<code>statement_performance_analyzer.limit</code> больше 0.
Значение по умолчанию <code>NULL</code>
(никакое пользовательское представление не определено).</li>

<li><code>statement_truncate_len</code>,
<code>@sys.statement_truncate_len</code></p>
<p>Максимальная длина запросов, возвращенных функцией
<a href="#sys-format-statement"><code>format_statement()</code></a>.
Более длинные запросы усечены к этой длине. Значение по умолчанию 64.
</p></li></ul>

<p>Другие опции могут быть добавлены к таблице
<a href="#sys-sys-config"><code>sys_config</code></a>. Например,
процедуры <a href="#sys-diagnostics"><code>diagnostics()</code></a> и
<a href="#sys-execute-prepared-stmt"><code>execute_prepared_stmt()
</code></a> используют опцию <code>debug</code>, если она существует, но эта
опция, не является частью таблицы <a href="#sys-sys-config"><code>
sys_config</code></a> по умолчанию, потому что вывод отладки обычно
включается только временно, устанавливая соответствующую опцию
<code>@sys.debug</code>. Чтобы включить вывод отладки, не имея необходимости
устанавливать ту переменную в отдельных сеансах, добавьте опцию к таблице:
<pre>
mysql&gt; INSERT INTO sys_config (variable, value) VALUES('debug', 'ON');
</pre>

Чтобы изменить настройки отладки в таблице, сделайте две вещи. Во-первых,
измените значение в таблице непосредственно:
<pre>
mysql&gt; UPDATE sys_config SET value = 'OFF' WHERE variable = 'debug';
</pre>

Во-вторых, чтобы также гарантировать, что вызовы процедуры в пределах
текущего сеанса используют измененное значение из таблицы, установите
соответствующую определяемую пользователем переменную в <code>NULL</code>:
<pre>
mysql&gt; SET @sys.debug = NULL;
</pre>

<h4><a name="sys-sys-config-insert-set-user"></a>24.4.2.2. Триггер
sys_config_insert_set_user</h4>
<p>Для строк, добавленных к таблице
<a href="#sys-sys-config"><code>sys_config</code></a> запросом
<code>INSERT</code> триггер <a href="#sys-sys-config-insert-set-user">
<code>sys_config_insert_set_user</code></a> устанавливает столбец
<code>set_by</code> к текущему пользователю.</p>

<h4><a name="sys-sys-config-update-set-user"></a>24.4.2.3.
Триггер sys_config_update_set_user</h4>
<p>Триггер <a href="#sys-sys-config-update-set-user"><code>
sys_config_update_set_user</code></a> для таблицы
<a href="#sys-sys-config"><code>sys_config</code></a>
подобен триггеру <a href="#sys-sys-config-insert-set-user"><code>
sys_config_insert_set_user</code></a>, но для запросов
<a href="sql.htm#update"><code>UPDATE</code></a>.</p>

<h3><a name="sys-schema-views"></a>24.4.3. Представления sys Schema</h3>
<p>Следующие разделы описывают представления
<a href="sys.htm"><code>sys</code></a> schema.</p>

<p><code>sys</code> schema содержит много представлений, которые суммируют
таблицы Performance Schema различными способами. Большинство этих
представлений прибывает в пары, такие, что у одного члена пары есть то же
самое имя, как у другого участника плюс <code>x$</code>. Например,
<a href="#sys-host-summary-by-file-io"><code>host_summary_by_file_io
</code></a> суммирует ввод/вывод файла, сгруппированный хостом, и выводит на
экран времена ожидания, преобразованные из пикосекунд в более
читаемые значения (с модулями):</p>

<pre>
mysql&gt; SELECT * FROM host_summary_by_file_io;
+------------+-------+------------+
| host       | ios   | io_latency |
+------------+-------+------------+
| localhost  | 67570 | 5.38 s     |
| background |  3468 | 4.18 s     |
+------------+-------+------------+
</pre>

<a href="#sys-host-summary-by-file-io"><code>x$host_summary_by_file_io
</code></a> суммирует те же самые данные, но выводит на экран
неотформатированные времена ожидания в пикосекундах:
<pre>
mysql&gt; SELECT * FROM x$host_summary_by_file_io;
+------------+-------+---------------+
| host       | ios   | io_latency    |
+------------+-------+---------------+
| localhost  | 67574 | 5380678125144 |
| background |  3474 | 4758696829416 |
+------------+-------+---------------+
</pre>

Представление без <code>x$</code> предназначено, чтобы обеспечить вывод,
который более удобен для пользователя и легче читать. Представление с
<code>x$</code> выводит на экран те же самые значения в сырой форме и
предназначено больше для использования с другими инструментами, которые
выполняют их собственную обработку данных.</p>

<p>Представления без <code>x$</code> отличается от <code>x$</code> этим:</p>
<ul><li><p>Значения байта отформатированы с использованием единиц размера
<a href="#sys-format-bytes"><code>format_bytes()</code></a>.</li>

<li>Временные значения отформатированы с использованием временных модулей
<a href="#sys-format-time"><code>format_time()</code></a>.</li>
<li>Запросы SQL усеченны к максимальной ширине отображения через
<a href="#sys-format-statement"><code>format_statement()</code></a>.
</li>
<li>Путь сокращен, используя <a href="#sys-format-path"><code>
format_path()</code></a>.</p></li></ul>

<h4><a name="sys-host-summary"></a>24.4.3.1. Представления
host_summary и x$host_summary</h4>
<p>Эти представления суммируют деятельность запросов, ввод/вывод файла и
соединения, сгруппированные хостом.</p>

<p>У представлений <a href="#sys-host-summary"><code>host_summary
</code></a> и <a href="#sys-host-summary"><code>x$host_summary</code>
</a> есть эти столбцы:</p>

<ul><li><p><code>host</code></p>
<p>Хост, с которого соединялся клиент. Строки, у которых столбец
<code>HOST</code> в основной таблице Performance Schema <code>NULL</code>
отведены для фоновых потоков и сообщаются с именем хоста
<code>background</code>.</li>

<li><code>statements</code></p>
<p>Общее количество запросов для хоста.</li>
<li><code>statement_latency</code></p>
<p>Общее количество времени ожидания рассчитанных запросов для хоста.</li>

<li><code>statement_avg_latency</code></p>
<p>Среднее время ожидания на рассчитанный запрос для хоста.</li>
<li><code>table_scans</code></p>
<p>Общее количество сканирований таблицы для хоста.</li>

<li><code>file_ios</code></p>
<p>Общее количество событий ввода/вывода файла для хоста.</li>
<li><code>file_io_latency</code></p>
<p>Общее время ожидания рассчитанных событий ввода/вывода файла для хоста.
</li>

<li><code>current_connections</code></p>
<p>Текущее число соединений для хоста.</li>
<li><code>total_connections</code></p>
<p>Общее количество соединений для хоста.</li>

<li><code>unique_users</code></p>
<p>Число различных пользователей для хоста.</li>
<li><code>current_memory</code></p>
<p>Текущее количество выделенной памяти для хоста.</li>
<li><code>total_memory_allocated</code></p>
<p>Общая сумма выделенной памяти для хоста.</p></li></ul>

<h4><a name="sys-host-summary-by-file-io"></a>24.4.3.2. Представления
host_summary_by_file_io и x$host_summary_by_file_io</h4>
<p>Эти представления суммируют ввод/вывод файла, сгруппированный хостом. По
умолчанию, строки сортированы по убыванию полного времени ожидания
ввода/вывода файла.</p>

<p>У представлений <a href="#sys-host-summary-by-file-io"><code>
host_summary_by_file_io</code></a> и
<a href="#sys-host-summary-by-file-io"><code>x$host_summary_by_file_io
</code></a> есть эти столбцы:</p>

<ul><li><p><code>host</code></p>
<p>Хост, с которого соединялся клиент. Строки, у которых столбец
<code>HOST</code> в основной таблице Performance Schema <code>NULL</code>
отведены для фоновых потоков и сообщаются с именем хоста
<code>background</code>.</li>

<li><code>ios</code></p>
<p>Общее количество событий ввода/вывода файла для хоста.</li>
<li><code>io_latency</code></p>
<p>Общее количество времени ожидания событий ввода/вывода файла для хоста.
</p></li></ul>

<h4><a name="sys-host-summary-by-file-io-type"></a>24.4.3.3. Представления
host_summary_by_file_io_type and x$host_summary_by_file_io_type</h4>
<p>Эти представления суммируют ввод/вывод файла, сгруппированный типом
событий и узлом. По умолчанию строки сортированы узлом и по убыванию полного
времени ожидания ввода/вывода.</p>

<p>У представлений <a href="#sys-host-summary-by-file-io-type">
<code>host_summary_by_file_io_type</code></a>
и <a href="#sys-host-summary-by-file-io-type">
<code>x$host_summary_by_file_io_type</code></a> есть эти столбцы:</p>

<ul><li><p><code>host</code></p>
<p>Хост, с которого соединялся клиент. Строки, у которых столбец
<code>HOST</code> в основной таблице Performance Schema <code>NULL</code>
отведены для фоновых потоков и сообщаются с именем хоста
<code>background</code>.</li>

<li><code>event_name</code></p>
<p>Имя события ввода/вывода файла.</li>
<li><code>total</code></p>
<p>Общее количество возникновений случая ввода/вывода файла для узла.</li>

<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений случая ввода/вывода
файла для узла.</li>

<li><code>max_latency</code></p>
<p>Максимальное время ожидания рассчитанных возникновений случая ввода/вывода
файла для узла.</p></li></ul>

<h4><a name="sys-host-summary-by-stages"></a>24.4.3.4. Представления
host_summary_by_stages и x$host_summary_by_stages</h4>
<p>Эти представления суммируют этапы запроса, сгруппированные хостом. По
умолчанию строки сортированы узлом и по убыванию полного времени ожидания.</p>

<p>У представлений <a href="#sys-host-summary-by-stages">
<code>host_summary_by_stages</code></a> и
<a href="#sys-host-summary-by-stages">
<code>x$host_summary_by_stages</code></a> есть эти столбцы:</p>

<ul><li><p><code>host</code></p>
<p>Хост, с которого соединялся клиент. Строки, у которых столбец
<code>HOST</code> в основной таблице Performance Schema <code>NULL</code>
отведены для фоновых потоков и сообщаются с именем хоста
<code>background</code>.</li>

<li><code>event_name</code></p>
<p>Имя этапа событий.</li>
<li><code>total</code></p>
<p>Общее количество возникновений случая этапа для узла.</li>

<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений случая этапа для узла.</li>

<li><code>avg_latency</code></p>
<p>Среднее время ожидания на рассчитанное возникновение случая
этапа для узла.</p></li></ul>

<h4><a name="sys-host-summary-by-statement-latency"></a>24.4.3.5.
Представления host_summary_by_statement_latency и
x$host_summary_by_statement_latency</h4>
<p>Эти представления суммируют полную статистику запросов, сгруппированную
узлом. По умолчанию строки сортированы по убыванию полного времени ожидания.
</p>

<p>У представлений
<a href="#sys-host-summary-by-statement-latency">
<code>host_summary_by_statement_latency</code></a>
и <a href="#sys-host-summary-by-statement-latency">
<code>x$host_summary_by_statement_latency</code></a> есть эти столбцы:</p>

<ul><li><p><code>host</code></p>
<p>Хост, с которого соединялся клиент. Строки, у которых столбец
<code>HOST</code> в основной таблице Performance Schema <code>NULL</code>
отведены для фоновых потоков и сообщаются с именем хоста
<code>background</code>.</li>

<li><code>total</code></p>
<p>Общее количество запросов для узла.</li>
<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных запросов для узла.</li>

<li><code>max_latency</code></p>
<p>Максимальн время ожидания рассчитанных запросов для узла.</li>
<li><code>lock_latency</code></p>
<p>Полное время ожидания блокировок рассчитанными запросами для узла.</li>

<li><code>rows_sent</code></p>
<p>Общее количество строк, возвращенное запросами для узла.</li>
<li><code>rows_examined</code></p>
<p>Общее количество строк, прочитанных из механизмов хранения
запросами для узла.</li>

<li><code>rows_affected</code></p>
<p>Общее количество строк, затронутое запросами для узла.</li>
<li><code>full_scans</code></p>
<p>Общее количество полного сканирования таблицы запросами для узла.
</p></li></ul>

<h4><a name="sys-host-summary-by-statement-type"></a>24.4.3.6.
Представления host_summary_by_statement_type и
x$host_summary_by_statement_type</h4>
<p>Эти представления суммируют сведения о выполненных запросах,
сгруппированных типом запроса и узлом. По умолчанию строки сортированы узлом
и по убыванию полного времени ожидания.</p>

<p>У представлений <a href="#sys-host-summary-by-statement-type">
<code>host_summary_by_statement_type</code></a>
и <a href="#sys-host-summary-by-statement-type">
<code>x$host_summary_by_statement_type</code></a>
есть эти столбцы:</p>

<ul><li><p><code>host</code></p>
<p>Хост, с которого соединялся клиент. Строки, у которых столбец
<code>HOST</code> в основной таблице Performance Schema <code>NULL</code>
отведены для фоновых потоков и сообщаются с именем хоста
<code>background</code>.</li>

<li><code>statement</code></p>
<p>Заключительный компонент имени события.</li>
<li><code>total</code></p>
<p>Общее количество возникновений события запроса для узла.</li>

<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений случая запроса для узла.
</li>

<li><code>max_latency</code></p>
<p>Максимальное время ожидания рассчитанных возникновений случая
запроса для узла.</li>

<li><code>lock_latency</code></p>
<p>Полное время ожидания блокировок рассчитанными возникновениями
случая запроса для узла.</li>

<li><code>rows_sent</code></p>
<p>Общее количество строк, возвращенных возникновениями случая
запроса для узла.</li>

<li><code>rows_examined</code></p>
<p>Общее количество строк, считанных из механизмов хранения возникновениями
случая запроса для узла.</li>

<li><code>rows_affected</code></p>
<p>Общее количество строк, затронутое возникновениями случая запроса для узла.
</li>

<li><code>full_scans</code></p>
<p>Общее количество полного сканирования таблицы возникновениями случая
запроса для узла.</p></li></ul>

<h4><a name="sys-innodb-buffer-stats-by-schema"></a>24.4.3.7.
Представления innodb_buffer_stats_by_schema и
x$innodb_buffer_stats_by_schema</h4>
<p>Эти представления суммируют информацию в таблице
<code>INFORMATION_SCHEMA</code>
<a href="inform.htm#innodb-buffer-page-table">
<code>INNODB_BUFFER_PAGE</code></a>, группируя схемой. По умолчанию строки
сортированы по убыванию размера буфера.</p>

<p>У представлений <a href="#sys-innodb-buffer-stats-by-schema"><code>
innodb_buffer_stats_by_schema</code></a> и
<a href="#sys-innodb-buffer-stats-by-schema"><code>
x$innodb_buffer_stats_by_schema</code></a> есть эти столбцы:</p>

<ul><li><p><code>object_schema</code></p>
<p>Название схемы объекта или <code>InnoDB System</code>,
если таблица принадлежит механизму хранения <code>InnoDB</code>.</li>

<li><code>allocated</code></p>
<p>Общее количество байтов, выделенное для схемы.</li>
<li><code>data</code></p>
<p>Общее количество байтов данных, выделенное для схемы.</li>

<li><code>pages</code></p>
<p>Общее количество страниц, выделенное для схемы.</li>
<li><code>pages_hashed</code></p>
<p>Общее количество хешированных страниц, выделенное для схемы.</li>

<li><code>pages_old</code></p>
<p>Общее количество старых страниц, выделенное для схемы.</li>
<li><code>rows_cached</code></p>
<p>Общее количество кэшируемых строк для схемы.</p></li></ul>

<h4><a name="sys-innodb-buffer-stats-by-table"></a>24.4.3.8. Представления
innodb_buffer_stats_by_table и x$innodb_buffer_stats_by_table</h4>
<p>Эти представления суммируют информацию в таблице
<code>INFORMATION_SCHEMA</code>
<a href="inform.htm#innodb-buffer-page-table"><code>INNODB_BUFFER_PAGE</code>
</a>, группируя схемой и таблицей. По умолчанию строки отсортированы по
убыванию размера буфера.</p>

<p>У представлений <a href="#sys-innodb-buffer-stats-by-table"><code>
innodb_buffer_stats_by_table</code></a> и
<a href="#sys-innodb-buffer-stats-by-table"><code>
x$innodb_buffer_stats_by_table</code></a> есть эти столбцы:</p>

<ul><li><p><code>object_schema</code></p>
<p>Название схемы объекта или <code>InnoDB System</code>,
если таблица принадлежит механизму хранения <code>InnoDB</code>.</li>

<li><code>object_name</code></p>
<p>Имя таблицы.</li>
<li><code>allocated</code></p>
<p>Общее количество байтов, выделенное для таблицы.</li>
<li><code>data</code></p>
<p>Общее количество байтов данных, выделенное для схемы.</li>

<li><code>pages</code></p>
<p>Общее количество страниц, выделенное для схемы.</li>
<li><code>pages_hashed</code></p>
<p>Общее количество хешированных страниц, выделенное для схемы.</li>

<li><code>pages_old</code></p>
<p>Общее количество старых страниц, выделенное для схемы.</li>
<li><code>rows_cached</code></p>
<p>Общее количество кэшируемых строк для схемы.</p></li></ul>

<h4><a name="sys-innodb-lock-waits"></a>24.4.3.9. Представления
innodb_lock_waits и x$innodb_lock_waits</h4>
<p>Эти представления суммируют блокировки <code>InnoDB</code>, которых ждут
транзакции. По умолчанию строки сортированы по убыванию возраста блокировки.
</p>

<p>У представлений
<a href="#sys-innodb-lock-waits"><code>innodb_lock_waits</code></a> и
<a href="#sys-innodb-lock-waits"><code>x$innodb_lock_waits</code></a>
есть эти столбцы:</p>

<ul><li><p><code>wait_started</code></p>
<p>Время, в которое блокировка начала ждать.</li>
<li><code>wait_age</code></p>
<p>Сколько времени блокировка ждала (значение
<a href="types.htm#time"><code>TIME</code></a>).</li>

<li><code>wait_age_secs</code></p>
<p>Сколько времени блокировка ждала в секундах.</li>
<li><code>locked_table</code></p>
<p>Название заблокированной таблицы.</p>

<p>Этот столбец содержит объединенные значения схемы/имени таблицы. Это было
удалено в MySQL 8.0.1 и заменено столбцами
<code>locked_table_schema</code> и <code>locked_table_name</code>, которые
содержат отдельные столбцы с именами схемы и таблицы.</li>

<li><code>locked_table_schema</code></p>
<p>Схема, которая содержит заблокированную таблицу.</p>
<p>Этот столбец был добавлен в MySQL 8.0.1.</li>

<li><code>locked_table_name</code></p>
<p>Название заблокированной таблицы.</p>
<p>Этот столбец был добавлен в MySQL 8.0.1.</li>

<li><code>locked_table_partition</code></p>
<p>Название заблокированного разделения, если есть, иначе <code>NULL</code>.
Этот столбец был добавлен в MySQL 8.0.1.</li>

<li><code>locked_table_subpartition</code></p>
<p>Название заблокированного подразделения, если
 есть, иначе <code>NULL</code>. Этот столбец был добавлен в MySQL 8.0.1.</li>

<li><code>locked_index</code></p>
<p>Название заблокированного индекса.</li>
<li><code>locked_type</code></p>
<p>Тип блокировки ожидания.</li>

<li><code>waiting_trx_id</code></p>
<p>ID транзакции ожидания.</li>
<li><code>waiting_trx_started</code></p>
<p>Время, в которое запускалась транзакция.</li>

<li><code>waiting_trx_age</code></p>
<p>Сколько времени транзакция ждала (значение
<a href="types.htm#time"><code>TIME</code></a>).</li>

<li><code>waiting_trx_rows_locked</code></p>
<p>Число строк заблокировано транзакцией.</li>
<li><code>waiting_trx_rows_modified</code></p>
<p>Число строк изменено транзакцией.</li>

<li><code>waiting_pid</code></p>
<p>Идентификатор процесса транзакции.</li>
<li><code>waiting_query</code></p>
<p>Запрос, который ждет блокировки.</li>

<li><code>waiting_lock_id</code></p>
<p>Идентификатор блокировки ожидания.</li>
<li><code>waiting_lock_mode</code></p>
<p>Режим блокировки ожидания.</li>

<li><code>blocking_trx_id</code></p>
<p>Идентификатор транзакции, которая блокирует блокировку ожидания.</li>
<li><code>blocking_pid</code></p>
<p>Идентификатор блокирующей транзакции.</li>

<li><code>blocking_query</code></p>
<p>Запрос, выполняемый блокирующей транзакцией.</li>
<li><code>blocking_lock_id</code></p>
<p>Идентификатор блокировки, которая блокирует блокировку ожидания.</li>

<li><code>blocking_lock_mode</code></p>
<p>Режим блокировки, которая блокирует блокировку ожидания.</li>
<li><code>blocking_trx_started</code></p>
<p>Время, в которое запускалась блокирующая транзакция.</li>

<li><code>blocking_trx_age</code></p>
<p>Сколько времени блокирующая транзакция выполняется (значение
<a href="types.htm#time"><code>TIME</code></a>).</li>

<li><code>blocking_trx_rows_locked</code></p>
<p>Число строк заблокировано блокирующей транзакцией.</li>
<li><code>blocking_trx_rows_modified</code></p>
<p>Число строк изменено блокирующей транзакцией.</li>

<li><code>sql_kill_blocking_query</code></p>
<p>Запрос <a href="sql.htm#kill"><code>KILL</code></a>, чтобы
уничтожить блокирующий запрос.</li>

<li><code>sql_kill_blocking_connection</code></p>
<p>Запрос <a href="sql.htm#kill"><code>KILL</code></a>, чтобы уничтожить
сеанс, выполняющий блокирующий запрос.</p></li></ul>

<h4><a name="sys-io-by-thread-by-latency"></a>24.4.3.10. Представления
io_by_thread_by_latency и x$io_by_thread_by_latency Views</h4>
<p>Эти представления суммируют потребителей ввода/вывода, чтобы вывести на
экран время ожидания ввода/вывода, сгруппированное потоком. По умолчанию
строки отсортированы по убыванию полного времени ожидания ввода/вывода.</p>

<p>У представлений <a href="#sys-io-by-thread-by-latency"><code>
io_by_thread_by_latency</code></a> и
<a href="#sys-io-by-thread-by-latency"><code>x$io_by_thread_by_latency
</code></a> есть эти столбцы:</p>

<ul><li><p><code>user</code></p>
<p>Для потоков переднего плана учетная запись связана с потоком.
Для фоновых потоков имя потока.</li>

<li><code>total</code></p>
<p>Общее количество событий ввода/вывода для потока.</li>
<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных событий ввода/вывода для потока.</li>

<li><code>min_latency</code></p>
<p>Минимальное время ожидания рассчитанных событий ввода/вывода для потока.
</li>

<li><code>avg_latency</code></p>
<p>Среднее время ожидания на рассчитанный случай ввода/вывода для потока.</li>
<li><code>max_latency</code></p>
<p>Максимальное время ожидания рассчитанных событий ввода/вывода для потока.
</li>

<li><code>thread_id</code></p>
<p>Идентификатор потока.</li>
<li><code>processlist_id</code></p>
<p>Для потоков переднего плана processlist ID потока. Для фоновых потоков
<code>NULL</code>.</p></li></ul>

<h4><a name="sys-io-global-by-file-by-bytes"></a>24.4.3.11. Представления
io_global_by_file_by_bytes и x$io_global_by_file_by_bytes</h4>
<p>Эти представления суммируют глобальных потребителей ввода/вывода, чтобы
вывести на экран количество ввода/вывода, сгруппированного файлом. По
умолчанию строки отсортированы по убыванию полного ввода/вывода
(байтов прочитано и записано).</p>

<p>У представлений <a href="#sys-io-global-by-file-by-bytes"><code>
io_global_by_file_by_bytes</code></a> и
<a href="#sys-io-global-by-file-by-bytes"><code>
x$io_global_by_file_by_bytes</code></a> есть эти столбцы:</p>

<ul><li><p><code>file</code></p>
<p>Имя пути к файлу.</li>
<li><code>count_read</code></p>
<p>Общее количество событий чтения для файла.</li>

<li><code>total_read</code></p>
<p>Общее количество байтов, прочитанных из файла.</li>
<li><code>avg_read</code></p>
<p>Среднее число байтов за чтение из файла.</li>

<li><code>count_write</code></p>
<p>Общее количество событий записи для файла.</li>
<li><code>total_written</code></p>
<p>Общее количество байтов, записанных в файл.</li>

<li><code>avg_write</code></p>
<p>Среднее число байтов за запись в файл.</li>
<li><code>total</code></p>
<p>Общее количество байтов, прочитанных и записанных в файл.</li>
<li><code>write_pct</code></p>
<p>Процент полных байтов ввода/вывода, которые были записаны.</p></li></ul>

<h4><a name="sys-io-global-by-file-by-latency"></a>24.4.3.12. Представления
io_global_by_file_by_latency и x$io_global_by_file_by_latency</h4>
<p>Эти представления суммируют глобальных потребителей ввода/вывода, чтобы
вывести на экран время ожидания ввода/вывода, сгруппированное файлом. По
умолчанию строки отсортированы по убыванию полного времени ожидания.</p>

<p>У представлений <a href="#sys-io-global-by-file-by-latency"><code>
io_global_by_file_by_latency</code></a> и
<a href="#sys-io-global-by-file-by-latency"><code>
x$io_global_by_file_by_latency</code></a> есть эти столбцы:</p>

<ul><li><p><code>file</code></p>
<p>Имя пути к файлу.</li>
<li><code>total</code></p>
<p>Общее количество событий ввода/вывода для файла.</li>

<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных событий ввода/вывода для файла.</li>
<li><code>count_read</code></p>
<p>Общее количество событий чтения для файла.</li>

<li><code>read_latency</code></p>
<p>Общее время ожидания рассчитанных событий чтения для файла.</li>
<li><code>count_write</code></p>
<p>Общее количество событий записи для файла.</li>

<li><code>write_latency</code></p>
<p>Общее количество времени ожидания рассчитанных событий
записи для файла.</li>

<li><code>count_misc</code></p>
<p>Общее количество других событий ввода/вывода для файла.</li>
<li><code>misc_latency</code></p>
<p>Общее время ожидания рассчитанных других событий ввода/вывода для файла.
</p></li></ul>

<h4><a name="sys-io-global-by-wait-by-bytes"></a>24.4.3.13. Представления
io_global_by_wait_by_bytes и x$io_global_by_wait_by_bytes</h4>
<p>Эти представления суммируют глобальных потребителей ввода/вывода, чтобы
вывести на экран количество ввода/вывода и время ожидания ввода/вывода,
сгруппированные случаем. По умолчанию строки сортированы по убыванию полного
ввода/вывода (прочитано и записано байтов).</p>

<p>У представлений <a href="#sys-io-global-by-wait-by-bytes"><code>
io_global_by_wait_by_bytes</code></a> и
<a href="#sys-io-global-by-wait-by-bytes"><code>
x$io_global_by_wait_by_bytes</code></a> есть эти столбцы:</p>

<ul><li><p><code>event_name</code></p>
<p>Имя события ввода/вывода без префикса <code>wait/io/file/</code>.</li>
<li><code>total</code></p>
<p>Общее количество возникновений случая ввода/вывода.</li>

<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений случая ввода/вывода.</li>
<li><code>min_latency</code></p>
<p>Минимальное время ожидания рассчитанных возникновений случая ввода/вывода.
</li>

<li><code>avg_latency</code></p>
<p>Среднее время ожидания на рассчитанное возникновение случая ввода/вывода.
</li>

<li><code>max_latency</code></p>
<p>Максимальное время ожидания рассчитанных возникновений случая ввода/вывода.
</li>

<li><code>count_read</code></p>
<p>Число запросов чтения для случая ввода/вывода.</li>
<li><code>total_read</code></p>
<p>Число байтов, прочитанных для случая ввода/вывода.</li>

<li><code>avg_read</code></p>
<p>Среднее число байтов за чтение для случая ввода/вывода.</li>
<li><code>count_write</code></p>
<p>Число запросов записи ввода/вывода.</li>

<li><code>total_written</code></p>
<p>Число байтов, записанных для случая ввода/вывода.</li>
<li><code>avg_written</code></p>
<p>Среднее число байтов на запись для случая ввода/вывода.</li>

<li><code>total_requested</code></p>
<p>Общее количество байтов, прочиатнных и записанных
для случая ввода/вывода.</p></li></ul>

<h4><a name="sys-io-global-by-wait-by-latency"></a>24.4.3.14. Представления
io_global_by_wait_by_latency и x$io_global_by_wait_by_latency</h4>
<p>Эти представления суммируют глобальных потребителей ввода/вывода, чтобы
вывести на экран количество ввода/вывода и время ожидания ввода/вывода,
сгруппированное случаем. По умолчанию строки сортированы по убыванию
полного времени ожидания.</p>

<p>У представлений <a href="#sys-io-global-by-wait-by-latency"><code>
io_global_by_wait_by_latency</code></a> и
<a href="#sys-io-global-by-wait-by-latency"><code>
x$io_global_by_wait_by_latency</code></a> есть эти столбцы:</p>

<ul><li><p><code>event_name</code></p>
<p>Имя события ввода/вывода без префикса <code>wait/io/file/</code>.</li>
<li><code>total</code></p>
<p>Общее количество возникновений случая ввода/вывода.</li>

<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений случая ввода/вывода.</li>
<li><code>avg_latency</code></p>
<p>Среднее время ожидания на рассчитанное возникновение случая ввода/вывода.
</li>

<li><code>max_latency</code></p>
<p>Максимальное время ожидания рассчитанных возникновений случая ввода/вывода.
</li>

<li><code>read_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений чтения случая ввода/вывода.
</li>

<li><code>write_latency</code></p>
<p>Общее время ожидания рассчитанных случаев записи.</li>
<li><code>misc_latency</code></p>
<p>Общее время ожидания рассчитанных других возникновений
случая ввода/вывода.</li>

<li><code>count_read</code></p>
<p>Число запросов чтения для случая ввода/вывода.</li>
<li><code>total_read</code></p>
<p>Число байтов, прочитанных для случая ввода/вывода.</li>

<li><code>avg_read</code></p>
<p>Среднее число байтов на чтение для случая ввода/вывода.</li>
<li><code>count_write</code></p>
<p>Число запросов записи.</li>

<li><code>total_written</code></p>
<p>Число байтов, записанных для случая ввода/вывода.</li>
<li><code>avg_written</code></p>
<p>Среднее число байтов на запись для случая ввода/вывода.</p></li></ul>

<h4><a name="sys-latest-file-io"></a>24.4.3.15. Представления
latest_file_io и x$latest_file_io</h4>
<p>Эти представления суммируют деятельность ввода/вывода файла,
сгруппированную файлом и потоком. По умолчанию строки сортированы с новым
вводом/выводом в начале.</p>

<p>У представлений <a href="#sys-latest-file-io"><code>latest_file_io
</code></a> и <a href="#sys-latest-file-io"><code>x$latest_file_io
</code></a> есть эти столбцы:</p>

<ul><li><p><code>thread</code></p>
<p>Для потоков переднего плана учетная запись связана с потоком (и номер
порта для соединений TCP/IP). Для фоновых потоков имя и ID потока.</li>

<li><code>file</code></p>
<p>Имя пути к файлу.</li>
<li><code>latency</code></p>
<p>Время ожидания для случая ввода/вывода файла.</li>

<li><code>operation</code></p>
<p>Тип работы.</li>
<li><code>requested</code></p>
<p>Число байтов данных для случая ввода/вывода файла.</p></li></ul>

<h4><a name="sys-memory-by-host-by-current-bytes"></a>24.4.3.16.
Представления memory_by_host_by_current_bytes и
x$memory_by_host_by_current_bytes</h4>
<p>Эти представления суммируют использование памяти, сгруппированное узлом.
По умолчанию строки сортированы по убыванию использования объема памяти.</p>

<p>У представлений <a href="#sys-memory-by-host-by-current-bytes">
<code>memory_by_host_by_current_bytes</code></a> и
<a href="#sys-memory-by-host-by-current-bytes"><code>
x$memory_by_host_by_current_bytes</code></a> есть эти столбцы:</p>

<ul><li><p><code>host</code></p>
<p>Хост, с которого соединялся клиент. Строки, у которых столбец
<code>HOST</code> в основной таблице Performance Schema <code>NULL</code>
отведены для фоновых потоков и сообщаются с именем хоста
<code>background</code>.</li>

<li><code>current_count_used</code></p>
<p>Текущее число выделенных блоков памяти, которые еще не были
освобождены для хоста.</li>

<li><code>current_allocated</code></p>
<p>Текущее число выделенных байтов, которые еще не были
освобождены для хоста.</li>

<li><code>current_avg_alloc</code></p>
<p>Текущее число выделенных байтов на блок памяти для хоста.</li>
<li><code>current_max_alloc</code></p>
<p>Самое большое текущее распределение памяти в байтах для хоста.</li>
<li><code>total_allocated</code></p>
<p>Полное распределение памяти в байтах для хоста.</p></li></ul>

<h4><a name="sys-memory-by-thread-by-current-bytes"></a>24.4.3.17.
Представления memory_by_thread_by_current_bytes и
x$memory_by_thread_by_current_bytes</h4>
<p>Эти представления суммируют использование памяти, сгруппированное потоком.
По умолчанию строки сортированы по убыванию использования объема памяти.</p>

<p>У представлений <a href="#sys-memory-by-thread-by-current-bytes">
<code>memory_by_thread_by_current_bytes</code></a> и
<a href="#sys-memory-by-thread-by-current-bytes"><code>
x$memory_by_thread_by_current_bytes</code></a> есть эти столбцы:</p>

<ul><li><p><code>thread_id</code></p>
<p>ID потока.</li>
<li><code>user</code></p>
<p>Пользователь потока или имя потока.</li>

<li><code>current_count_used</code></p>
<p>Текущее число выделенных блоков памяти, которые еще не были
освобождены для потока.</li>

<li><code>current_allocated</code></p>
<p>Текущее число выделенных байтов, которые еще не были
освобождены для потока.</li>

<li><code>current_avg_alloc</code></p>
<p>Текущее число выделенных байтов на блок памяти для потока.</li>
<li><code>current_max_alloc</code></p>
<p>Самое большое текущее распределение памяти в байтах для потока.</li>
<li><code>total_allocated</code></p>
<p>Полное распределение памяти в байтах для потока.</p></li></ul>

<h4><a name="sys-memory-by-user-by-current-bytes"></a>24.4.3.18.
Представления memory_by_user_by_current_bytes и
x$memory_by_user_by_current_bytes</h4>
<p>Эти представления суммируют использование памяти, сгруппированное
пользователем. По умолчанию строки сортированы по убыванию
использования объема памяти.</p>

<p>У представлений <a href="#sys-memory-by-user-by-current-bytes">
<code>memory_by_user_by_current_bytes</code></a> и
<a href="#sys-memory-by-user-by-current-bytes"><code>
x$memory_by_user_by_current_bytes</code></a> есть эти столбцы:</p>

<ul><li><p><code>user</code></p>
<p>Имя пользователя клиента. Строки, для которых столбец
<code>USER</code> в основной таблице Performance Schema <code>NULL</code>,
для фоновых потоков и сообщаются с именем хоста <code>background</code>.</li>

<li><code>current_count_used</code></p>
<p>Текущее число выделенных блоков памяти, которые еще не были
освобождены для пользователя.</li>

<li><code>current_allocated</code></p>
<p>Текущее число выделенных байтов, которые еще не были
освобождены для пользователя.</li>

<li><code>current_avg_alloc</code></p>
<p>Текущее число выделенных байтов на блок памяти для пользователя.</li>
<li><code>current_max_alloc</code></p>
<p>Самое большое текущее распределение памяти в байтах для пользователя.</li>
<li><code>total_allocated</code></p>
<p>Полное распределение памяти в байтах для пользователя.</p></li></ul>

<h4><a name="sys-memory-global-by-current-bytes"></a>24.4.3.19. Представления
memory_global_by_current_bytes и x$memory_global_by_current_bytes</h4>
<p>Эти представления суммируют использование памяти, сгруппированное типом
распределения (то есть событием). По умолчанию строки сортированы по убыванию
используемого объема памяти.</p>

<p>У представлений <a href="#sys-memory-global-by-current-bytes">
<code>memory_global_by_current_bytes</code></a>
и <a href="#sys-memory-global-by-current-bytes"><code>
x$memory_global_by_current_bytes</code></a> есть эти столбцы:</p>

<ul><li><p><code>event_name</code></p>
<p>Имя события памяти.</li>
<li><code>current_count</code></p>
<p>Общее количество возникновений случая.</li>

<li><code>current_alloc</code></p>
<p>Текущее число выделенных байтов, которые еще не были
освобождены для случая.</li>

<li><code>current_avg_alloc</code></p>
<p>Текущее число выделенных байтов на блок памяти для случая.</li>
<li><code>high_count</code></p>
<p>Высшая точка числа блоков памяти, выделенных для случая.</li>

<li><code>high_alloc</code></p>
<p>Высшая точка числа байтов, выделенных для случая.</li>
<li><code>high_avg_alloc</code></p>
<p>Высшая точка для среднего числа байтов на блок памяти,
выделенный для случая.</p></li></ul>

<h4><a name="sys-memory-global-total"></a>24.4.3.20. Представления
memory_global_total и x$memory_global_total</h4>
<p>Эти представления суммируют полное использование
памяти в пределах сервера.</p>

<p>У представлений <a href="#sys-memory-global-total"><code>
memory_global_total</code></a> и
<a href="#sys-memory-global-total"><code>x$memory_global_total</code>
</a> есть эти столбцы:</p>
<ul><li><p><code>total_allocated</code></p>
<p>Сколько байт памяти выделено в пределах сервера.</p></li></ul>

<h4><a name="sys-metrics"></a>24.4.3.21. Представление metrics</h4>
<p>Это представление суммирует метрики сервера MySQL, чтобы показать имена
переменной, значения и типы. По умолчанию строки сортированы
типом и именем переменной.</p>

<p>Представление <a href="#sys-metrics"><code>metrics</code></a>
включает эту информацию:</p>
<ul><li><p>Глобальные переменные состояния из таблицы Performance Schema
<a href="perfor.htm#performance-schema-status-variable-tables"><code>
global_status</code></a>.</li>

<li>Метрики <code>InnoDB</code> из таблицы <code>INFORMATION_SCHEMA</code>
<a href="inform.htm#innodb-metrics-table"><code>INNODB_METRICS</code></a>.
</li>

<li>Текущее и полное распределение памяти, основанное на
инструментовке памяти Performance Schema.</li>
<li>Текущее время (удобочитаемый и Unix timestamp форматы).</p></li></ul>

<p>Есть некоторое дублирование информации между таблицами
<a href="perfor.htm#performance-schema-status-variable-tables"><code>
global_status</code></a> и
<a href="inform.htm#innodb-metrics-table"><code>INNODB_METRICS</code></a>,
которое устраняет представление
<a href="#sys-metrics"><code>metrics</code></a>.</p>

<p>Представление <a href="#sys-metrics"><code>metrics</code></a>
имеет эти столбцы:</p>
<ul><li><p><code>Variable_name</code></p>
<p>Метрическое имя. Метрический тип определяет источник, из
которого взято имя:</p>

<ul><li><p>Для глобальных переменных состояния: столбец
<code>VARIABLE_NAME</code> таблицы
<a href="perfor.htm#performance-schema-status-variable-tables"><code>
global_status</code></a>.</li>

<li>Для метрики <code>InnoDB</code>: столбец <code>NAME</code> таблицы
<a href="inform.htm#innodb-metrics-table"><code>INNODB_METRICS</code></a>.
</li>
<li>Для других метрик: обеспеченная представлением описательная строка.
</p></li></ul></li>

<li><code>Variable_value</code></p>
<p>Метрическое значение. Метрический тип определяет источник, из
которого взято значение:</p>
<ul><li><p>Для глобальных переменных состояния: столбец
<code>VARIABLE_NAME</code> таблицы
<a href="perfor.htm#performance-schema-status-variable-tables"><code>
global_status</code></a>.</li>

<li>Для метрики <code>InnoDB</code>: столбец <code>NAME</code> таблицы
<a href="inform.htm#innodb-metrics-table"><code>INNODB_METRICS</code></a>.
</li>

<li>Для метрик памяти: соответствующий столбец из таблицы
Performance Schema <a href="perfor.htm#memory-summary-tables">
<code>memory_summary_global_by_event_name</code></a>.</li>

<li>Для текущего времени: значение
<a href="funct.htm#function_now"><code>NOW(3)</code></a> или
<a href="funct.htm#function_unix-timestamp"><code>UNIX_TIMESTAMP(NOW(3))
</code></a>.</p></li></ul></li>

<li><code>Type</code></p>
<p>Метрический тип:</p>
<ul><li><p>Для глобальных переменных состояния: <code>Global Status</code>.
</li>

<li>Для <code>InnoDB</code> метрики: <code>InnoDB Metrics - %</code>, где
<code>%</code> заменен значением столбца <code>SUBSYSTEM</code> таблицы
<a href="inform.htm#innodb-metrics-table"><code>INNODB_METRICS</code></a>.
</li>
<li>Для метрик памяти: <code>Performance Schema</code>.</li>
<li>Для текущего времени: <code>System Time</code>.</p></li></ul></li>

<li><code>Enabled</code></p>
<p>Включена ли метрика:</p>
<ul><li><p>Для глобальных переменных состояния: <code>YES</code>.</li>
<li>Для <code>InnoDB</code>-метрики: <code>YES</code>, если столбец
<code>STATUS</code> таблицы <a href="inform.htm#innodb-metrics-table"><code>
INNODB_METRICS</code></a> <code>enabled</code>, <code>NO</code> иначе.</li>

<li>Для метрик памяти: <code>NO</code>,
<code>YES</code> или <code>PARTIAL</code>
(сейчас <code>PARTIAL</code> происходит только для метрик памяти и указывает,
что не все инструменты <code>memory/%</code> включены. Инструменты памяти
Performance Schema всегда включаются).</li>
<li>Для текущего времени: <code>YES</code>.</p></li></ul></li></ul>

<h4><a name="sys-processlist"></a>24.4.3.22. Представления
processlist и x$processlist</h4>
<p>Эти представления суммируют processlist информацию. Они предоставляют
более полную информацию, чем запрос <a href="sql.htm#show-processlist"><code>
SHOW PROCESSLIST</code></a> и таблица <code>INFORMATION_SCHEMA</code>
<a href="inform.htm#processlist-table"><code>PROCESSLIST</code></a>, а
также не блокируют ничего. По умолчанию строки сортированы по убыванию
времени процесса и убыванию времени ожидания.</p>

<p>Описания столбца здесь кратки. Для дополнительной информации см. описание
таблицы Performance Schema <a href="perfor.htm#threads-table"><code>threads
</code></a> в <a href="perfor.htm#threads-table">раздел 23.9.16.3</a>.</p>

<p>У представлений
<a href="#sys-processlist"><code>processlist</code></a> и
<a href="#sys-processlist"><code>x$processlist</code></a>
есть эти столбцы:</p>

<ul><li><p><code>thd_id</code></p>
<p>ID потока.</li>
<li><code>conn_id</code></p>
<p>ID соединения.</li>

<li><code>user</code></p>
<p>Пользователь потока или имя потока.</li>
<li><code>db</code></p>
<p>База данных по умолчанию для потока или <code>NULL</code>,
если нет ни одной.</li>

<li><code>command</code></p>
<p>Для потоков переднего плана тип команды, которую поток выполняет от имени
клиента, или <code>Sleep</code>, если сеанс неактивен.</li>

<li><code>state</code></p>
<p>Действие, случай или статус, которое указывает на то, что делает поток.
</li>

<li><code>time</code></p>
<p>Время в секундах, которое поток был в его текущем состоянии.</li>
<li><code>current_statement</code></p>
<p>Запрос, который поток выполняет, или <code>NULL</code>, если это
не выполняет запросы.</li>

<li><code>statement_latency</code></p>
<p>Сколько времени запрос выполняется.</li>
<li><code>progress</code></p>
<p>Процент работы, завершенной для этапов по сообщению продвижения
поддержки. См. <a href="#sys-schema-progress-reporting">раздел 24.3
</a>.</li>

<li><code>lock_latency</code></p>
<p>Время, потраченное на ожидание блокировок текущим запросом.</li>
<li><code>rows_examined</code></p>
<p>Число строк, считанных из механизмов хранения текущим запросом.</li>

<li><code>rows_sent</code></p>
<p>Число строк, возвращенное текущим запросом.</li>
<li><code>rows_affected</code></p>
<p>Число строк, затронутых текущим запросом.</li>

<li><code>tmp_tables</code></p>
<p>Число внутренних временных таблиц в памяти, созданное текущим запросом.
</li>

<li><code>tmp_disk_tables</code></p>
<p>Число внутренних временных таблиц на диске, созданное текущим запросом.
</li>

<li><code>full_scan</code></p>
<p>Число полного сканирования таблицы текущим запросом.</li>
<li><code>last_statement</code></p>
<p>Последний запрос, выполненный потоком, если там в настоящее время нет
выполняющегося или ждущего запроса.</li>

<li><code>last_statement_latency</code></p>
<p>Сколько времени последний запрос выполняется.</li>
<li><code>current_memory</code></p>
<p>Число байтов выделено потоком.</li>

<li><code>last_wait</code></p>
<p>Название наиболее свежего ждущего случая потока.</li>
<li><code>last_wait_latency</code></p>
<p>Время наиболее свежего ждущего случая потока.</li>

<li><code>source</code></p>
<p>Исходный файл и номер строки, содержащей инструментованный код,
который произвел случай.</li>

<li><code>trx_latency</code></p>
<p>Время ожидания текущей транзакции для потока.</li>
<li><code>trx_state</code></p>
<p>Статус текущей транзакции для потока.</li>

<li><code>trx_autocommit</code></p>
<p>Был ли включен режим autocommit, когда текущая транзакция запускалась.
</li>

<li><code>pid</code></p>
<p>ID процесса клиента.</li>
<li><code>program_name</code></p>
<p>Название программы клиента.</p></li></ul>

<h4><a name="sys-ps-check-lost-instrumentation"></a>24.4.3.23. Представление
ps_check_lost_instrumentation</h4>
<p>Это представление возвращает информацию о потерянных инструментах
Performance Schema, чтобы указать, способна ли Performance Schema
контролировать все данные во время выполнения.</p>

<p>У представления <a href="#sys-ps-check-lost-instrumentation"><code>
ps_check_lost_instrumentation</code></a> есть эти столбцы:</p>
<ul><li><p><code>variable_name</code></p>
<p>Имя переменной состояния Performance Schema, указывающее, какой тип
инструмента был потерян.</li>
<li><code>variable_value</code></p>
<p>Число инструментов.</p></li></ul>

<h4><a name="sys-schema-auto-increment-columns"></a>24.4.3.24. Представление
schema_auto_increment_columns</h4>
<p>Это представление указывает, которые таблицы имеют столбцы
<code>AUTO_INCREMENT</code> и предоставляют информацию о тех столбцах такую,
как текущие и максимальные значения столбцов и отношение использования
(отношение использованных к возможным значениям). По умолчанию строки
отсортированы по убыванию отношения использования и
максимальному значению столбца.</p>

<p>Таблицы в этих схемах исключены из вывода представления:
<code>mysql</code>, <code>sys</code>,
<code>INFORMATION_SCHEMA</code>, <code>performance_schema</code>.</p>

<p>У представления <a href="#sys-schema-auto-increment-columns">
<code>schema_auto_increment_columns</code></a> есть эти столбцы:</p>
<ul><li><p><code>table_schema</code></p>
<p>Схема, которая содержит таблицу.</li>

<li><code>table_name</code></p>
<p>Таблица, которая содержит столбец <code>AUTO_INCREMENT</code>.</li>
<li><code>column_name</code></p>
<p>Название столбца <code>AUTO_INCREMENT</code>.</li>

<li><code>data_type</code></p>
<p>Тип данных столбца.</li>

<li><code>column_type</code></p>
<p>Тип столбца, который является типом данных плюс возможно другая
информация. Например, для столбца типа <code>bigint(20) unsigned</code>
тип данных <code>bigint</code>.</li>

<li><code>is_signed</code></p>
<p>Со знаком ли тип столбца.</li>
<li><code>is_unsigned</code></p>
<p>Без знака ли тип столбца.</li>

<li><code>max_value</code></p>
<p>Максимальное разрешенное значение для столбца.</li>
<li><code>auto_increment</code></p>
<p>Текущее значение <code>AUTO_INCREMENT</code> для столбца.</li>

<li><code>auto_increment_ratio</code></p>
<p>Отношение использованных к разрешенным значениям для столбца. Это
указывает, сколько значений из последовательности
<span class="quote"><span class="quote">израсходовано</span></span>.
</p></li></ul>

<h4><a name="sys-schema-index-statistics"></a>24.4.3.25. Представления
schema_index_statistics и x$schema_index_statistics</h4>
<p>Эти представления обеспечивают индексную статистику. По умолчанию строки
сортированы по убыванию и общему количеству времени ожидания индекса.</p>

<p>У представлений <a href="#sys-schema-index-statistics"><code>
schema_index_statistics</code></a> и
<a href="#sys-schema-index-statistics"><code>x$schema_index_statistics
</code></a> есть эти столбцы:</p>

<ul><li><p><code>table_schema</code></p>
<p>Схема, которая содержит таблицу.</li>
<li><code>table_name</code></p>
<p>Таблица, которая содержит индекс.</li>

<li><code>index_name</code></p>
<p>Название индекса.</li>
<li><code>rows_selected</code></p>
<p>Общее количество чтения строк, используя индекс.</li>

<li><code>select_latency</code></p>
<p>Общее время ожидания рассчитанных чтений, используя индексирование.</li>
<li><code>rows_inserted</code></p>
<p>Общее количество строк вставлено в индекс.</li>

<li><code>insert_latency</code></p>
<p>Общее время ожидания рассчитанных вставок в индекс.</li>
<li><code>rows_updated</code></p>
<p>Общее количество строк обновлено в индексировании.</li>

<li><code>update_latency</code></p>
<p>Общее время ожидания рассчитанных обновлений в индексировании.</li>
<li><code>rows_deleted</code></p>
<p>Общее количество строк, удаленных из индекса.</li>
<li><code>delete_latency</code></p>
<p>Общее время ожидания рассчитанных удалений из индекса.</p></li></ul>

<h4><a name="sys-schema-object-overview"></a>24.4.3.26. Представление
schema_object_overview</h4>
<p>Это представление суммирует типы объектов в пределах каждой схемы. По
умолчанию строки отсортированы типом объекта и схемой.</p>

<p>Для случаев MySQL с большим количеством объектов это представление
может занять много времени для выполнения.</p>
<p>У представления <a href="#sys-schema-object-overview"><code>
schema_object_overview</code></a> есть эти столбцы:</p>

<ul><li><p><code>db</code></p>
<p>Имя схемы.</li>
<li><code>object_type</code></p>
<p>Тип объекта: <code>BASE TABLE</code>,
<code>INDEX (<em><code>index_type</code></em>)</code>,
<code>EVENT</code>, <code>FUNCTION</code>,
<code>PROCEDURE</code>, <code>TRIGGER</code>, <code>VIEW</code>.</li>
<li><code>count</code></p>
<p>Число объектов данного типа в схеме.</p></li></ul>

<h4><a name="sys-schema-redundant-indexes"></a>24.4.3.27. Представления
schema_redundant_indexes и x$schema_flattened_keys</h4>
<p>Представление <a href="#sys-schema-redundant-indexes"><code>
schema_redundant_indexes</code></a> отображает индексы, которые дублируют
другие индексы или сокращены ими. Это вспомогательное представление для
<a href="#sys-schema-redundant-indexes"><code>schema_redundant_indexes
</code></a>.</p>

<p>В следующих описаниях столбца доминантный индекс тот, который делает
избыточное индексирование избыточным.</p>
<p>У представления <a href="#sys-schema-redundant-indexes"><code>
schema_redundant_indexes</code></a> есть эти столбцы:</p>

<ul><li><p><code>table_schema</code></p>
<p>Схема, которая содержит таблицу.</li>
<li><code>table_name</code></p>
<p>Таблица, которая содержит индекс.</li>

<li><code>redundant_index_name</code></p>
<p>Название избыточного индекса.</li>
<li><code>redundant_index_columns</code></p>
<p>Названия столбцов в избыточном индексе.</li>

<li><code>redundant_index_non_unique</code></p>
<p>Число неуникальных столбцов в избыточном индексе.</li>
<li><code>dominant_index_name</code></p>
<p>Название доминантного индекса.</li>

<li><code>dominant_index_columns</code></p>
<p>Названия столбцов в доминантном индексе.</li>
<li><code>dominant_index_non_unique</code></p>
<p>Число неуникальных столбцов в доминантном индексе.</li>

<li><code>subpart_exists</code></p>
<p>Индексирует ли индекс только часть столбца.</li>
<li><code>sql_drop_index</code></p>
<p>Запрос, чтобы удалить избыточный индекс.</p></li></ul>

<p>У представления <a href="#sys-schema-redundant-indexes"><code>
x$schema_flattened_keys</code></a> есть эти столбцы:</p>
<ul><li><p><code>table_schema</code></p>
<p>Схема, которая содержит таблицу.</li>

<li><code>table_name</code></p>
<p>Таблица, которая содержит индекс.</li>
<li><code>index_name</code></p>
<p>Имя индекса.</li>

<li><code>non_unique</code></p>
<p>Число неуникальных столбцов в индексе.</li>
<li><code>subpart_exists</code></p>
<p>Индексирует ли индекс только часть столбца.</li>
<li><code>index_columns</code></p>
<p>Название столбцов в индексе.</p></li></ul>

<h4><a name="sys-schema-table-lock-waits"></a>24.4.3.28. Представления
schema_table_lock_waits и x$schema_table_lock_waits</h4>
<p>Это представление показывает, какие сеансы заблокированы, ожидая на
блокировках метаданных, и что блокирует их.</p>

<p>Описания столбца здесь кратки. Для дополнительной информации см. описание
таблицы Performance Schema <a href="perfor.htm#metadata-locks-table"><code>
metadata_locks</code></a> в <a href="perfor.htm#metadata-locks-table">разделе
23.9.12.3</a>.</p>

<p>У представлений <a href="#sys-schema-table-lock-waits"><code>
schema_table_lock_waits</code></a> и
<a href="#sys-schema-table-lock-waits"><code>x$schema_table_lock_waits
</code></a> есть эти столбцы:</p>

<ul><li><p><code>object_schema</code></p>
<p>Схема, содержащая объект, который будет заблокирован.</li>
<li><code>object_name</code></p>
<p>Название инструментованного объекта.</li>

<li><code>waiting_thread_id</code></p>
<p>Идентификатор потока, который ждет блокировки.</li>
<li><code>waiting_pid</code></p>
<p>Идентификатор processlist потока, который ждет блокировки.</li>

<li><code>waiting_account</code></p>
<p>Учетная запись, связанная с сеансом, который ждет блокировки.</li>
<li><code>waiting_lock_type</code></p>
<p>Тип блокировки ожидания.</li>

<li><code>waiting_lock_duration</code></p>
<p>Сколько времени блокировка ждет.</li>
<li><code>waiting_query</code></p>
<p>Запрос, который ждет блокировку.</li>

<li><code>waiting_query_secs</code></p>
<p>Сколько времени запрос ждал, в секундах.</li>
<li><code>waiting_query_rows_affected</code></p>
<p>Число строк, затронутое запросом.</li>

<li><code>waiting_query_rows_examined</code></p>
<p>Число строк, считанных из механизмов хранения запросом.</li>
<li><code>blocking_thread_id</code></p>
<p>Идентификатор потока, который блокирует блокировку ожидания.</li>

<li><code>blocking_pid</code></p>
<p>processlist ID потока, который блокирует блокировку ожидания.</li>
<li><code>blocking_account</code></p>
<p>Учетная запись, связанная с потоком, который
блокирует блокировку ожидания.</li>

<li><code>blocking_lock_type</code></p>
<p>Тип блокировки, которая блокирует блокировку ожидания.</li>
<li><code>blocking_lock_duration</code></p>
<p>Сколько времени блокировка была проведена.</li>

<li><code>sql_kill_blocking_query</code></p>
<p>Запрос <a href="sql.htm#kill"><code>KILL</code></a>, чтобы
уничтожить запрос блокировки.</li>

<li><code>sql_kill_blocking_connection</code></p>
<p>Запрос <a href="sql.htm#kill"><code>KILL</code></a>, чтобы
уничтожить сеанс, выполняющий запрос блокировки.</p></li></ul>

<h4><a name="sys-schema-table-statistics"></a>24.4.3.29. Представления
schema_table_statistics и x$schema_table_statistics</h4>
<p>Эти представления суммируют табличную статистику. По умолчанию строки
сортированы по убыванию общего времени ожидания.</p>

<p>Это вспомогательные представления для
<code>x$ps_schema_table_statistics_io</code>.</p>
<p>У представлений <a href="#sys-schema-table-statistics"><code>
schema_table_statistics</code></a> и
<a href="#sys-schema-table-statistics"><code>x$schema_table_statistics
</code></a> есть эти столбцы:</p>

<ul><li><p><code>table_schema</code></p>
<p>Схема, которая содержит таблицу.</li>
<li><code>table_name</code></p>
<p>Имя таблицы.</li>

<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных событий ввода/вывода для таблицы.</li>
<li><code>rows_fetched</code></p>
<p>Общее количество строк, прочитанных из таблицы.</li>

<li><code>fetch_latency</code></p>
<p>Общее время ожидания рассчитанных событий ввода/вывода чтения для таблицы.
</li>

<li><code>rows_inserted</code></p>
<p>Общее количество строк, вставленных в таблицу.</li>
<li><code>insert_latency</code></p>
<p>Общее время ожидания рассчитанных событий ввода/вывода вставки для таблицы.
</li>

<li><code>rows_updated</code></p>
<p>Общее количество строк, обновленных в таблице.</li>
<li><code>update_latency</code></p>
<p>Общее время ожидания рассчитанных событий ввода/вывода обновления для таблицы.
</li>

<li><code>rows_deleted</code></p>
<p>Общее количество строк, удаленных из таблицы.</li>
<li><code>delete_latency</code></p>
<p>Общее время ожидания рассчитанных событий удаления
ввода/вывода для таблицы.</li>

<li><code>io_read_requests</code></p>
<p>Общее количество запросов чтения для таблицы.</li>
<li><code>io_read</code></p>
<p>Общее количество байтов, прочитанных из таблицы.</li>

<li><code>io_read_latency</code></p>
<p>Общее время ожидания чтений из таблицы.</li>
<li><code>io_write_requests</code></p>
<p>Общее количество запросов записи для таблицы.</li>

<li><code>io_write</code></p>
<p>Общее количество байтов, записанных в таблицу.</li>
<li><code>io_write_latency</code></p>
<p>Общее время ожидания записи в таблицу.</li>

<li><code>io_misc_requests</code></p>
<p>Общее количество разного ввода/вывода для таблицы.</li>
<li><code>io_misc_latency</code></p>
<p>Общее время ожидания разных запросов ввода/вывода для таблицы.
</p></li></ul>

<h4><a name="sys-schema-table-statistics-with-buffer"></a>24.4.3.30.
Представления schema_table_statistics_with_buffer и
x$schema_table_statistics_with_buffer</h4>
<p>Эти представления суммируют табличную статистику, включая статистику
буферного бассейна <code>InnoDB</code>. По умолчанию строки отсортированы по
убыванию общего времени ожидания. Применяется вспомогательное представление
<code>x$ps_schema_table_statistics_io</code>.

<p>У представлений <a href="#sys-schema-table-statistics-with-buffer">
<code>schema_table_statistics_with_buffer</code></a> и
<a href="#sys-schema-table-statistics-with-buffer"><code>
x$schema_table_statistics_with_buffer</code></a> есть эти столбцы:</p>

<ul><li><p><code>table_schema</code></p>
<p>Схема, которая содержит таблицу.</li>
<li><code>table_name</code></p>
<p>Имя таблицы.</li>

<li><code>rows_fetched</code></p>
<p>Общее количество строк, прочитанных из таблицы.</li>
<li><code>fetch_latency</code></p>
<p>Общее время ожидания рассчитанных событий ввода/вывода чтения для таблицы.
</li>

<li><code>rows_inserted</code></p>
<p>Общее количество строк, вставленных в таблицу.</li>
<li><code>insert_latency</code></p>
<p>Общее время ожидания рассчитанных событий ввода/вывода вставки для таблицы.
</li>

<li><code>rows_updated</code></p>
<p>Общее количество строк обновлено в таблице.</li>
<li><code>update_latency</code></p>
<p>Общее время ожидания рассчитанных событий ввода/вывода обновления для таблицы.
</li>

<li><code>rows_deleted</code></p>
<p>Общее количество строк, удаленных из таблицы.</li>
<li><code>delete_latency</code></p>
<p>Общее время ожидания рассчитанных событий удаления
ввода/вывода для таблицы.</li>

<li><code>io_read_requests</code></p>
<p>Общее количество запросов чтения для таблицы.</li>
<li><code>io_read</code></p>
<p>Общее количество байтов, прочитанных из таблицы.</li>

<li><code>io_read_latency</code></p>
<p>Общее время ожидания чтений из таблицы.</li>
<li><code>io_write_requests</code></p>
<p>Общее количество запросов записи для таблицы.</li>

<li><code>io_write</code></p>
<p>Общее количество байтов, записанных в таблицу.</li>
<li><code>io_write_latency</code></p>
<p>Общее время ожидания записи в таблицу.</li>

<li><code>io_misc_requests</code></p>
<p>Общее количество разного ввода/вывода для таблицы.</li>
<li><code>io_misc_latency</code></p>
<p>Общее время ожидания разных запросов ввода/вывода для таблицы.

<li><code>innodb_buffer_allocated</code></p>
<p>Общее количество байт, выделенных для буферов <code>InnoDB</code> таблицы.
</li>

<li><code>innodb_buffer_data</code></p>
<p>Общее количество байт, выделенных для данных <code>InnoDB</code> таблицы.
</li>

<li><code>innodb_buffer_free</code></p>
<p>Общее количество байт, выделенных для данных <code>InnoDB</code> таблицы.
(<code>innodb_buffer_allocated</code>-<code>innodb_buffer_data</code>).</li>

<li><code>innodb_buffer_pages</code></p>
<p>Общее количество страниц <code>InnoDB</code>, выделенных для таблицы.</li>
<li><code>innodb_buffer_pages_hashed</code></p>
<p>Общее количество хешированных страниц
<code>InnoDB</code>, выделенных для таблицы.</li>

<li><code>innodb_buffer_pages_old</code></p>
<p>Общее количество старых страниц <code>InnoDB</code>,
выделенных для таблицы.</li>

<li><code>innodb_buffer_rows_cached</code></p>
<p>Общее количество кэшируемых строк <code>InnoDB</code> для таблицы.
</p></li></ul>

<h4><a name="sys-schema-tables-with-full-table-scans"></a>24.4.3.31.
Представления schema_tables_with_full_table_scans и
x$schema_tables_with_full_table_scans</h4>
<p>Они показывают, к каким таблицам получают доступ с полным сканированием
таблицы. По умолчанию строки сортированы по убыванию просмотренных строк.</p>

<p>У представлений <a href="#sys-schema-tables-with-full-table-scans">
<code>schema_tables_with_full_table_scans</code></a> и
<a href="#sys-schema-tables-with-full-table-scans"><code>
x$schema_tables_with_full_table_scans</code></a> есть эти столбцы:</p>

<ul><li><p><code>object_schema</code></p>
<p>Имя схемы.</li>
<li><code>object_name</code></p>
<p>Имя таблицы.</li>

<li><code>rows_full_scanned</code></p>
<p>Общее количество строк просмотрено полными просмотрами таблицы.</li>
<li><code>latency</code></p>
<p>Общее время ожидания полных просмотров таблицы.</p></li></ul>

<h4><a name="sys-schema-unused-indexes"></a>24.4.3.32. Представление
schema_unused_indexes</h4>
<p>Это представлени показывает индексы, для которых нет никаких событий,
которые указывают, что они не используются. По умолчанию строки
сортированы схемой и таблицей.</p>

<p>Это представление является самым полезным, когда обработка идет столь
достаточно долго, что ее рабочая нагрузка является важной. Иначе присутствие
индекса в этом представлении, возможно, не является значащим.</p>

<p>У представления <a href="#sys-schema-unused-indexes"><code>
schema_unused_indexes</code></a> есть эти столбцы:</p>
<ul><li><p><code>object_schema</code></p>
<p>Имя схемы.</li>

<li><code>object_name</code></p>
<p>Имя таблицы.</li>
<li><code>index_name</code></p>
<p>Неиспользуемое имя индекса.</p></li></ul>

<h4><a name="sys-session"></a>24.4.3.33. Представления session и x$session
</h4>
<p>Эти представления подобны
<a href="#sys-processlist"><code>processlist</code></a> и
<a href="#sys-processlist"><code>x$processlist</code></a>,
но они отфильтровывают фоновые процессы, чтобы вывести на экран только
пользовательские сеансы. Для описаний столбцов см.
<a href="#sys-processlist">раздел 24.4.3.22</a>.</p>

<h4><a name="sys-session-ssl-status"></a>24.4.3.34.
Представление session_ssl_status</h4>
<p>Для каждого соединения это представление выводит на экран версию SSL, шифр
и количество повторно использованных сеансов SSL.</p>

<p>У представления <a href="#sys-session-ssl-status"><code>
session_ssl_status</code></a> есть эти столбцы:</p>
<ul><li><p><code>thread_id</code></p>
<p>Идентификатор потока для соединения.</li>

<li><code>ssl_version</code></p>
<p>Версия SSL, которая используется для соединения.</li>
<li><code>ssl_cipher</code></p>
<p>Шифр SSL, который используется для соединения.</li>
<li><code>ssl_sessions_reused</code></p>
<p>Число повторно использованных сеансов SSL для соединения.</p></li></ul>

<h4><a name="sys-statement-analysis"></a>24.4.3.35. Представления
statement_analysis и x$statement_analysis</h4>
<p>Эти представления перечисляют нормализованные запросы с соединенной
статистикой. Контент подражает представлению MySQL Enterprise Monitor
Query Analysis. По умолчанию строки сортированы по убыванию
полного времени ожидания.</p>

<p>У представлений <a href="#sys-statement-analysis"><code>
statement_analysis</code></a> и <a href="#sys-statement-analysis">
<code>x$statement_analysis</code></a> есть эти столбцы:</p>

<ul><li><p><code>query</code></p>
<p>Нормализованная строка запроса.</li>
<li><code>db</code></p>
<p>База данных по умолчанию для запроса или <code>NULL</code>,
если нет ни одной.</li>

<li><code>full_scan</code></p>
<p>Общее количество полного сканирования таблицы для запроса.</li>
<li><code>exec_count</code></p>
<p>Общее количество времени выполнения запроса.</li>

<li><code>err_count</code></p>
<p>Общее количество ошибок, произведенных запросом.</li>
<li><code>warn_count</code></p>
<p>Общее количество предупреждений, произведенных запросом.</li>

<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений запроса.</li>
<li><code>max_latency</code></p>
<p>Максимальное время ожидания рассчитанных возникновений запроса.</li>

<li><code>avg_latency</code></p>
<p>Среднее время ожидания на рассчитанное возникновение запроса.</li>
<li><code>lock_latency</code></p>
<p>Полное время ожидания блокировок рассчитанными возникновениями запроса.
</li>

<li><code>rows_sent</code></p>
<p>Общее количество строк, возвращенное запросом.</li>
<li><code>rows_sent_avg</code></p>
<p>Среднее число строк, возвращенное на возникновение запроса.</li>

<li><code>rows_examined</code></p>
<p>Общее количество строк, считанных из механизмов хранения.</li>
<li><code>rows_examined_avg</code></p>
<p>Среднее число строк, считанных из механизмов хранения на запрос.</li>

<li><code>rows_affected</code></p>
<p>Общее количество строк затронуто запросом.</li>
<li><code>rows_affected_avg</code></p>
<p>Среднее число строк затронуто за возникновение запроса.</li>

<li><code>tmp_tables</code></p>
<p>Общее количество внутренних временных таблиц в памяти
создано возникновениями запроса.</li>

<li><code>tmp_disk_tables</code></p>
<p>Общее количество внутренних временных таблиц на диске
создано возникновениями запроса.</li>

<li><code>rows_sorted</code></p>
<p>Общее количество строк сортировано возникновениями запроса.</li>
<li><code>sort_merge_passes</code></p>
<p>Общее количество объединений сортировки.</li>

<li><code>digest</code></p>
<p>Обзор запроса.</li>
<li><code>first_seen</code></p>
<p>Время, в которое был впервые отмечен запрос.</li>
<li><code>last_seen</code></p>
<p>Время, в которое был последний раз отмечен запрос.</p></li></ul>

<h4><a name="sys-statements-with-errors-or-warnings"></a>24.4.3.36.
Представления statements_with_errors_or_warnings и
x$statements_with_errors_or_warnings</h4>
<p>Эти представления выводят на экран нормализованные запросы, которые
произвели ошибки или предупреждения. По умолчанию строки сортированы по
убыванию количества ошибок и предупреждений.</p>

<p>У представлений <a href="#sys-statements-with-errors-or-warnings">
<code>statements_with_errors_or_warnings</code></a> и
<a href="#sys-statements-with-errors-or-warnings"><code>
x$statements_with_errors_or_warnings</code></a> есть эти столбцы:</p>

<ul><li><p><code>query</code></p>
<p>Нормализованная строка запроса.</li>
<li><code>db</code></p>
<p>База данных по умолчанию для запроса или
<code>NULL</code>, если нет.</li>

<li><code>exec_count</code></p>
<p>Общее количество времени выполнения запроса.</li>
<li><code>errors</code></p>
<p>Общее количество ошибок произведено возникновениями запроса.</li>

<li><code>error_pct</code></p>
<p>Процент возникновений запросов, которые произвели ошибки.</li>
<li><code>warnings</code></p>
<p>Общее количество предупреждений произведено возникновениями запроса.</li>

<li><code>warning_pct</code></p>
<p>Процент возникновений запросов, которые произвели предупреждения.</li>
<li><code>first_seen</code></p>
<p>Время, в которое был впервые отмечен запрос.</li>

<li><code>last_seen</code></p>
<p>Время, в которое был последний раз отмечен запрос.</li>
<li><code>digest</code></p>
<p>Обзор запроса.</p></li></ul>

<h4><a name="sys-statements-with-full-table-scans"></a>24.4.3.37.
Представления statements_with_full_table_scans и
x$statements_with_full_table_scans</h4>
<p>Эти представления выводят на экран нормализованные запросы, которые
сделали полное сканирование таблицы. По умолчанию строки сортированы по
убыванию процента времени, за которое полный просмотр был сделан и убыванию
полного времени ожидания.</p>

<p>У представлений <a href="#sys-statements-with-full-table-scans">
<code>statements_with_full_table_scans</code></a> и
<a href="#sys-statements-with-full-table-scans"><code>
x$statements_with_full_table_scans</code></a> есть эти столбцы:</p>

<ul><li><p><code>query</code></p>
<p>Нормализованная строка запроса.</li>
<li><code>db</code></p>
<p>База данных по умолчанию для запроса или <code>NULL</code>, если нет.</li>

<li><code>exec_count</code></p>
<p>Общее количество времени выполнения запроса.</li>
<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных событий запроса.</li>

<li><code>no_index_used_count</code></p>
<p>Общее количество раз, когда индекс не использовался,
чтобы просмотреть таблицу.</li>

<li><code>no_good_index_used_count</code></p>
<p>Общее количество раз, когда хороший индекс не использовался,
чтобы просмотреть таблицу.</li>

<li><code>no_index_used_pct</code></p>
<p>Процент раз, когда индекс не использовался,
чтобы просмотреть таблицу.</li>

<li><code>rows_sent</code></p>
<p>Общее количество строк возвратилось из таблицы.</li>
<li><code>rows_examined</code></p>
<p>Общее количество строк, прочитанных из механизма хранения для таблицы.</li>

<li><code>rows_sent_avg</code></p>
<p>Среднее число строк возвратилось из таблицы.</li>
<li><code>rows_examined_avg</code></p>
<p>Среднее число строк, прочитанных из механизма хранения для таблицы.</li>
<li><code>first_seen</code></p>
<p>Время, в которое был впервые отмечен запрос.</li>

<li><code>last_seen</code></p>
<p>Время, в которое был последний раз отмечен запрос.</li>
<li><code>digest</code></p>
<p>Обзор запроса.</p></li></ul>

<h4><a name="sys-statements-with-runtimes-in-95th-percentile"></a>24.4.3.38.
Представления statements_with_runtimes_in_95th_percentile и
x$statements_with_runtimes_in_95th_percentile</h4>
<p>Эти представления перечисляют запросы со временем выполнения в 95%.
По умолчанию строки сортированы по убыванию среднего времени ожидания.</p>

<p>Оба представления используют два вспомогательных представления
<code>x$ps_digest_avg_latency_distribution</code> и
<code>x$ps_digest_95th_percentile_by_avg_us</code>.</p>

<p>У представлений
<a href="#sys-statements-with-runtimes-in-95th-percentile"><code>
statements_with_runtimes_in_95th_percentile</code></a>
и <a href="#sys-statements-with-runtimes-in-95th-percentile"><code>
x$statements_with_runtimes_in_95th_percentile</code></a> есть эти столбцы:</p>

<ul><li><p><code>query</code></p>
<p>Нормализованная строка запроса.</li>
<li><code>db</code></p>
<p>База данных по умолчанию для запроса или <code>NULL</code>, если нет.</li>

<li><code>full_scan</code></p>
<p>Общее количество полного сканирования таблиц возникновениями запроса.</li>
<li><code>exec_count</code></p>
<p>Общее количество времени выполнения запроса.</li>

<li><code>err_count</code></p>
<p>Общее количество ошибок, произведенное возникновениями запроса.</li>
<li><code>warn_count</code></p>
<p>Общее количество предупреждений, произведенное возникновениями запроса.
</li>

<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений запроса.</li>
<li><code>max_latency</code></p>
<p>Максимальное время ожидания рассчитанных возникновений запроса.</li>

<li><code>avg_latency</code></p>
<p>Среднее время ожидания на рассчитанное возникновение запроса.</li>
<li><code>rows_sent</code></p>
<p>Общее количество строк возвратилось возникновениями запроса.</li>

<li><code>rows_sent_avg</code></p>
<p>Среднее число строк возвратилось на возникновение запроса.</li>
<li><code>rows_examined</code></p>
<p>Общее количество строк, считанных из механизмов
хранения возникновениями запроса.</li>

<li><code>rows_examined_avg</code></p>
<p>Среднее число строк, считанных из механизмов хранения
на возникновение запроса.</li>

<li><code>first_seen</code></p>
<p>Время, в которое был впервые отмечен запрос.</li>
<li><code>last_seen</code></p>
<p>Время, в которое был последний раз отмечен запрос.</li>
<li><code>digest</code></p>
<p>Обзор запроса.</p></li></ul>

<h4><a name="sys-statements-with-sorting"></a>24.4.3.39. Представления
statements_with_sorting и x$statements_with_sorting</h4>
<p>Эти представления перечисляют нормализованные запросы, которые выполнили
сортировки. По умолчанию строки сортированы по убыванию
полного времени ожидания.</p>

<p>У представлений <a href="#sys-statements-with-sorting"><code>
statements_with_sorting</code></a> и
<a href="#sys-statements-with-sorting"><code>x$statements_with_sorting
</code></a> есть эти столбцы:</p>

<ul><li><p><code>query</code></p>
<p>Нормализованная строка запроса.</li>
<li><code>db</code></p>
<p>База данных по умолчанию для запроса или <code>NULL</code>, если нет.</li>

<li><code>exec_count</code></p>
<p>Общее количество времени выполнения запроса.</li>
<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений запроса.</li>

<li><code>sort_merge_passes</code></p>
<p>Общее число объединений сортировок, вызванных запросом.</li>

<li><code>avg_sort_merges</code></p>
<p>Среднее число объединений сортировок, вызванных запросом.</li>
<li><code>sorts_using_scans</code></p>
<p>Общее количество сортировок с использованием сканирования таблицы.</li>

<li><code>sort_using_range</code></p>
<p>Общее количество сортировок с использованием диапазона.</li>
<li><code>rows_sorted</code></p>
<p>Общее количество строк сортировано возникновениями запроса.</li>

<li><code>avg_rows_sorted</code></p>
<p>Среднее число строк сортировано на возникновение запроса.</li>
<li><code>first_seen</code></p>
<p>Время, в которое был впервые отмечен запрос.</li>

<li><code>last_seen</code></p>
<p>Время, в которое был последний раз отмечен запрос.</li>
<li><code>digest</code></p>
<p>Обзор запроса.</p></li></ul>

<h4><a name="sys-statements-with-temp-tables"></a>24.4.3.40. Представления
statements_with_temp_tables и x$statements_with_temp_tables</h4>
<p>Эти представления перечисляют нормализованные запросы, которые
использовали временные таблицы. По умолчанию строки сортированы по убыванию
числа временных таблиц на диске и убыванию числа временных
используемых таблиц в памяти.</p>

<p>У представлений <a href="#sys-statements-with-temp-tables"><code>
statements_with_temp_tables</code></a> и
<a href="#sys-statements-with-temp-tables"><code>
x$statements_with_temp_tables</code></a> есть эти столбцы:</p>

<ul><li><p><code>query</code></p>
<p>Нормализованная строка запроса.</li>
<li><code>db</code></p>
<p>База данных по умолчанию для запроса или <code>NULL</code>, если нет.</li>

<li><code>exec_count</code></p>
<p>Общее количество времени выполнения запроса.</li>
<li><code>total_latency</code></p>
Общее время ожидания рассчитанных возникновений запроса.</li>

<li><code>memory_tmp_tables</code></p>
<p>Общее количество внутренних временных таблиц в памяти,
созданных возникновениями запроса.</li>

<li><code>disk_tmp_tables</code></p>
<p>Общее количество внутренних временных таблиц на диске,
созданных возникновениями запроса.</li>

<li><code>avg_tmp_tables_per_query</code></p>
<p>Среднее число внутренних временных таблиц создано
на возникновение запроса.</li>

<li><code>tmp_tables_to_disk_pct</code></p>
<p>Процент внутренних временных таблиц в памяти, которые были преобразованы в
таблицы на диске.</li>

<li><code>first_seen</code></p>
<p>Время, в которое был впервые отмечен запрос.</li>
<li><code>last_seen</code></p>
<p>Время, в которое был последний раз отмечен запрос.</li>
<li><code>digest</code></p>
<p>Обзор запроса.</p></li></ul>

<h4><a name="sys-user-summary"></a>24.4.3.41. Представления
user_summary и x$user_summary</h4>
<p>Эти представления суммируют деятельность запросов, ввод/вывод файла и
соединения, сгруппированные пользователем. По умолчанию строки сортированы
по убыванию полного времени ожидания.</p>

<p>У представлений <a href="#sys-user-summary"><code>user_summary
</code></a> и <a href="#sys-user-summary"><code>x$user_summary</code>
</a> есть эти столбцы:</p>

<ul><li><p><code>user</code></p>
<p>Имя пользователя клиента. Строки, для которых столбец <code>USER</code> в
основной таблице Performance Schema <code>NULL</code>, отведены для фоновых
потоков и сообщаются с именем хоста <code>background</code>.</li>

<li><code>statements</code></p>
<p>Общее количество запросов для пользователя.</li>
<li><code>statement_latency</code></p>
<p>Общее время ожидания рассчитанных запросов для пользователя.</li>

<li><code>statement_avg_latency</code></p>
<p>Среднее время ожидания на рассчитанный запрос для пользователя.</li>
<li><code>table_scans</code></p>
<p>Общее количество сканирования таблицы для пользователя.</li>

<li><code>file_ios</code></p>
<p>Общее количество событий ввода/вывода файла для пользователя.</li>
<li><code>file_io_latency</code></p>
<p>Общее время ожидания рассчитанных событий ввода/вывода
файла для пользователя.</li>

<li><code>current_connections</code></p>
<p>Текущее число соединений для пользователя.</li>
<li><code>total_connections</code></p>
<p>Общее количество соединений для пользователя.</li>

<li><code>unique_hosts</code></p>
<p>Число отличных хостов, с которых произошли соединения для пользователя.
</li>

<li><code>current_memory</code></p>
<p>Текущее количество выделенной памяти для пользователя.</li>
<li><code>total_memory_allocated</code></p>
<p>Общая сумма выделенной памяти для пользователя.</p></li></ul>

<h4><a name="sys-user-summary-by-file-io"></a>24.4.3.42. Представления
user_summary_by_file_io и x$user_summary_by_file_io</h4>
<p>Эти представления суммируют ввод/вывод файла, сгруппированный
пользователем. По умолчанию строки сортированы по убыванию полного времени
ожидания ввода/вывода файла.</p>

<p>У представлений <a href="#sys-user-summary-by-file-io"><code>
user_summary_by_file_io</code></a> и
<a href="#sys-user-summary-by-file-io"><code>x$user_summary_by_file_io
</code></a> есть эти столбцы:</p>

<ul><li><p><code>user</code></p>
<p>Имя пользователя клиента. Строки, для которых столбец <code>USER</code> в
основной таблице Performance Schema <code>NULL</code>, отведены для фоновых
потоков и сообщаются с именем хоста <code>background</code>.</li>

<li><code>ios</code></p>
<p>Общее количество событий ввода/вывода файла для пользователя.</li>
<li><code>io_latency</code></p>
<p>Общее время ожидания рассчитанных событий ввода/вывода
файла для пользователя.</p></li></ul>

<h4><a name="sys-user-summary-by-file-io-type"></a>24.4.3.43. Представления
user_summary_by_file_io_type и x$user_summary_by_file_io_type</h4>
<p>Эти представления суммируют ввод/вывод файла, сгруппированный типом
событий и пользователем. По умолчанию строки сортированы по пользователю и
убыванию полного времени ожидания.</p>

<p>У представлений <a href="#sys-user-summary-by-file-io-type">
<code>user_summary_by_file_io_type</code></a> и
<a href="#sys-user-summary-by-file-io-type"><code>
x$user_summary_by_file_io_type</code></a> есть эти столбцы:</p>

<ul><li><p><code>user</code></p>
<p>Имя пользователя клиента. Строки, для которых столбец <code>USER</code> в
основной таблице Performance Schema <code>NULL</code>, отведены для фоновых
потоков и сообщаются с именем хоста <code>background</code>.</li>

<li><code>event_name</code></p>
<p>Имя события ввода/вывода файла.</li>
<li><code>total</code></p>
<p>Общее количество возникновений случая ввода/вывода файла для пользователя.
</li>

<li><code>latency</code></p>
<p>Общее время ожидания рассчитанных возникновений случая ввода/вывода
файла для пользователя.</li>

<li><code>max_latency</code></p>
<p>Максимальное время ожидания рассчитанных возникновений случая ввода/вывода
файла для пользователя.</p></li></ul>

<h4><a name="sys-user-summary-by-stages"></a>24.4.3.44. Представления
user_summary_by_stages и x$user_summary_by_stages</h4>
<p>Эти представления суммируют этапы, сгруппированные пользователем. По
умолчанию строки сортированы по пользователю и убыванию полного
времени ожидания этапа.</p>

<p>У представлений <a href="#sys-user-summary-by-stages"><code>
user_summary_by_stages</code></a> и
<a href="#sys-user-summary-by-stages"><code>x$user_summary_by_stages
</code></a> есть эти столбцы:</p>

<ul><li><p><code>user</code></p>
<p>Имя пользователя клиента. Строки, для которых столбец <code>USER</code> в
основной таблице Performance Schema <code>NULL</code>, отведены для фоновых
потоков и сообщаются с именем хоста <code>background</code>.</li>

<li><code>event_name</code></p>
<p>Имя этапа события.</li>
<li><code>total</code></p>
<p>Общее количество возникновений случая этапа для пользователя.</li>

<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений случая
этапа для пользователя.</li>

<li><code>avg_latency</code></p>
<p>Среднее время ожидания на рассчитанное возникновение случая
этапа для пользователя.</p></li></ul>

<h4><a name="sys-user-summary-by-statement-latency"></a>24.4.3.45.
Представления user_summary_by_statement_latency и
x$user_summary_by_statement_latency</h4>
<p>Эти представления суммируют полную статистику запросов, сгруппированную
пользователем. По умолчанию строки сортированы по убыванию
полного времени ожидания.</p>

<p>У представлений <a href="#sys-user-summary-by-statement-latency">
<code>user_summary_by_statement_latency</code></a> и
<a href="#sys-user-summary-by-statement-latency"><code>
x$user_summary_by_statement_latency</code></a> есть эти столбцы:</p>

<ul><li><p><code>user</code></p>
<p>Имя пользователя клиента. Строки, для которых столбец <code>USER</code> в
основной таблице Performance Schema <code>NULL</code>, отведены для фоновых
потоков и сообщаются с именем хоста <code>background</code>.</li>

<li><code>total</code></p>
<p>Общее количество запросов для пользователя.</li>
<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных запросов для пользователя.</li>

<li><code>max_latency</code></p>
<p>Максимальное время ожидания рассчитанных запросов для пользователя.</li>
<li><code>lock_latency</code></p>
<p>Полное время ожидания блокировок рассчитанными запросами для пользователя.
</li>

<li><code>rows_sent</code></p>
<p>Общее количество строк, возвращенное запросами для пользователя.</li>
<li><code>rows_examined</code></p>
<p>Общее количество строк, считанных из механизмов хранения
запросами для пользователя.</li>

<li><code>rows_affected</code></p>
<p>Общее количество строк затронуто запросами для пользователя.</li>
<li><code>full_scans</code></p>
<p>Общее количество полного сканирования таблицы запросами для пользователя.
</p></li></ul>

<h4><a name="sys-user-summary-by-statement-type"></a>24.4.3.46. Представления
user_summary_by_statement_type и x$user_summary_by_statement_type</h4>
<p>Эти представления суммируют информацию о выполненных запросах,
сгруппированных по типу запроса и пользователю. По умолчанию строки
сортированы по пользователю и убыванию полного времени ожидания.</p>

<p>У представлений <a href="#sys-user-summary-by-statement-type">
<code>user_summary_by_statement_type</code></a> и
<a href="#sys-user-summary-by-statement-type"><code>
x$user_summary_by_statement_type</code></a> есть эти столбцы:</p>

<ul><li><p><code>user</code></p>
<p>Имя пользователя клиента. Строки, для которых столбец <code>USER</code> в
основной таблице Performance Schema <code>NULL</code>, отведены для фоновых
потоков и сообщаются с именем хоста <code>background</code>.</li>

<li><code>statement</code></p>
<p>Заключительный компонент имени запроса.</li>
<li><code>total</code></p>
<p>Общее количество возникновений случая запроса для пользователя.</li>

<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений случая
запроса для пользователя.</li>

<li><code>max_latency</code></p>
<p>Максимальное время ожидания рассчитанных возникновений случая
запроса для пользователя.</li>

<li><code>lock_latency</code></p>
<p>Полное время ожидания блокировок рассчитанными возникновениями случая
запроса для пользователя.</li>

<li><code>rows_sent</code></p>
<p>Общее количество строк, возвращенное возникновениями случая
запроса для пользователя.</li>

<li><code>rows_examined</code></p>
<p>Общее количество строк, считанных из механизмов хранения возникновениями
случая запроса для пользователя.</li>

<li><code>rows_affected</code></p>
<p>Общее количество строк затронуто возникновениями случая
запроса для пользователя.</li>

<li><code>full_scans</code></p>
<p>Общее количество полного сканирования таблицы возникновениями случая
запроса для пользователя.</p></li></ul>

<h4><a name="sys-version"></a>24.4.3.47. Представление version</h4>
<p>Это представление обеспечивает текущие версии
<a href="sys.htm"><code>sys</code></a> schema и MySQL server.</p>

<p>У представления <a href="#sys-version"><code>version</code></a>
есть эти столбцы:</p>
<ul><li><p><code>sys_version</code></p>
<p>Версия <a href="sys.htm"><code>sys</code></a> schema.</li>
<li><code>mysql_version</code></p>
<p>Версия MySQL server.</p></li></ul>

<h4><a name="sys-wait-classes-global-by-avg-latency"></a>24.4.3.48.
Представления wait_classes_global_by_avg_latency и
x$wait_classes_global_by_avg_latency</h4>
<p>Эти представления суммируют средние времена ожидания класса,
сгруппированные классом событий. По умолчанию строки сортированы по убыванию
среднего времени ожидания. Проигнорированы неактивные события.</p>

<p>Класс событий определен, отрезая от имени событий все после первых трех
компонентов. Например, класс для <code>wait/io/file/sql/slow_log</code>
<code>wait/io/file</code>.</p>

<p>У представлений <a href="#sys-wait-classes-global-by-avg-latency">
<code>wait_classes_global_by_avg_latency</code></a> и
<a href="#sys-wait-classes-global-by-avg-latency"><code>
x$wait_classes_global_by_avg_latency</code></a> есть эти столбцы:</p>

<ul><li><p><code>event_class</code></p>
<p>Класс событий.</li>
<li><code>total</code></p>
<p>Общее количество возникновений событий в классе.</li>

<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений событий в классе.</li>
<li><code>min_latency</code></p>
<p>Минимальное время ожидания рассчитанных возникновений событий в классе.
</li>

<li><code>avg_latency</code></p>
<p>Среднее время ожидания на рассчитанное возникновение событий в классе.</li>
<li><code>max_latency</code></p>
<p>Максимальное время ожидания рассчитанных возникновений событий в классе.
</p></li></ul>

<h4><a name="sys-wait-classes-global-by-latency"></a>24.4.3.49. Представления
wait_classes_global_by_latency и x$wait_classes_global_by_latency</h4>
<p>Эти представления суммируют общие времена ожидания класса, сгруппированные
классом событий. По умолчанию строки сортированы по убыванию полного времени
ожидания. Проигнорированы неактивные события.</p>

<p>Класс событий определен, отрезая от имени событий все после первых трех
компонентов. Например, класс для <code>wait/io/file/sql/slow_log</code>
<code>wait/io/file</code>.</p>

<p>У представлений <a href="#sys-wait-classes-global-by-latency">
<code>wait_classes_global_by_latency</code></a> и
<a href="#sys-wait-classes-global-by-latency"><code>
x$wait_classes_global_by_latency</code></a> есть эти столбцы:</p>

<ul><li><p><code>event_class</code></p>
<p>Класс событий.</li>
<li><code>total</code></p>
<p>Общее количество возникновений событий в классе.</li>

<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений событий в классе.</li>
<li><code>min_latency</code></p>
<p>Минимальное время ожидания рассчитанных возникновений событий в классе.
</li>

<li><code>avg_latency</code></p>
<p>Среднее время ожидания на рассчитанное возникновение событий в классе.
</li>

<li><code>max_latency</code></p>
<p>Максимальное время ожидания рассчитанных возникновений событий в классе.
</p></li></ul>

<h4><a name="sys-waits-by-host-by-latency"></a>24.4.3.50. Представления
waits_by_host_by_latency и x$waits_by_host_by_latency</h4>
<p>Эти представления суммируют ожидания событий, сгруппированные хостом и
случаем. По умолчанию строки сортированы по хосту и убыванию полного времени
ожидания. Проигнорированы неактивные события.</p>

<p>У представлений <a href="#sys-waits-by-host-by-latency"><code>
waits_by_host_by_latency</code></a>
и <a href="#sys-waits-by-host-by-latency"><code>
x$waits_by_host_by_latency</code></a> есть эти столбцы:</p>

<ul><li><p><code>host</code></p>
<p>Хост, с которого произошло соединение.</li>
<li><code>event</code></p>
<p>Имя событий.</li>

<li><code>total</code></p>
<p>Общее количество возникновений случая для хоста.</li>
<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений случая для хоста.</li>

<li><code>avg_latency</code></p>
<p>Среднее время ожидания на рассчитанное возникновение случая для хоста.
</li>
<li><code>max_latency</code></p>
<p>Максимальное время ожидания рассчитанных возникновений случая для хоста.
</p></li></ul>

<h4><a name="sys-waits-by-user-by-latency"></a>24.4.3.51. Представления
waits_by_user_by_latency и x$waits_by_user_by_latency</h4>
<p>Эти представления суммируют ожидающие события, сгруппированные по
пользователю и случаю. По умолчанию строки сортированы по пользователю и
убыванию полного времени ожидания. Проигнорированы неактивные события.</p>

<p>У представлений <a href="#sys-waits-by-user-by-latency"><code>
waits_by_user_by_latency</code></a> и
<a href="#sys-waits-by-user-by-latency"><code>
x$waits_by_user_by_latency</code></a> есть эти столбцы:</p>

<ul><li><p><code>user</code></p>
<p>Пользователь, связанный с соединением.</li>
<li><code>event</code></p>
<p>Имя событий.</li>

<li><code>total</code></p>
<p>Общее количество возникновений случая для пользователя.</li>
<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений случая для пользователя.
</li>

<li><code>avg_latency</code></p>
<p>Среднее время ожидания на рассчитанное возникновение
случая для пользователя.</li>

<li><code>max_latency</code></p>
<p>Максимальное время ожидания рассчитанных возникновений
случая для пользователя.</p></li></ul>

<h4><a name="sys-waits-global-by-latency"></a>24.4.3.52. Представления
waits_global_by_latency и x$waits_global_by_latency</h4>
<p>Эти представления суммируют ожидающие события, сгруппированные случаем. По
умолчанию строки сортированы по убыванию полного времени ожидания.
Проигнорированы неактивные события.</p>

<p>У представлений <a href="#sys-waits-global-by-latency"><code>
waits_global_by_latency</code></a> и
<a href="#sys-waits-global-by-latency"><code>x$waits_global_by_latency
</code></a> есть эти столбцы:</p>

<ul><li><p><code>events</code></p>
<p>Имя событий.</li>
<li><code>total</code></p>
<p>Общее количество возникновений случая.</li>

<li><code>total_latency</code></p>
<p>Общее время ожидания рассчитанных возникновений случая.</li>
<li><code>avg_latency</code></p>
<p>Среднее время ожидания на рассчитанное возникновение случая.</li>

<li><code>max_latency</code></p>
<p>Максимальное время ожидания рассчитанных возникновений случая.
</p></li></ul>

<h3><a name="sys-schema-procedures"></a>24.4.4. Хранимые процедуры sys Schema
</h3>
<p>Следующие разделы описывают хранимые процедуры
<a href="sys.htm"><code>sys</code></a> schema.</p>

<h4><a name="sys-create-synonym-db"></a>24.4.4.1. Процедура
create_synonym_db()</h4>
<p>Учитывая имя схемы, эта процедура создает схему синонима, содержащую
представления, которые обращаются ко всем таблицам и представлениям в
оригинальной схеме. Это может использоваться, например, чтобы создать более
короткое имя, которым можно сослаться на схему с длинным именем (такое, как
<code>info</code> вместо <code>INFORMATION_SCHEMA</code>).</p>

<h5><a name="idm139965281473760"></a>Параметры</h5>
<ul><li><p><code>in_db_name VARCHAR(64)</code>:
Название схемы, для которой можно создать синоним.</li>
<li><code>in_synonym VARCHAR(64)</code>:
Имя для схемы синонима. Эта схема не должна существовать.</p></li></ul>

<h5><a name="idm139965281469552"></a>Пример</h5>
<pre>
mysql&gt; SHOW DATABASES;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
| world              |
+--------------------+
mysql&gt; CALL create_synonym_db('INFORMATION_SCHEMA', 'info');
+---------------------------------------+
| summary                               |
+---------------------------------------+
| Created 63 views in the info database |
+---------------------------------------+

mysql&gt; SHOW DATABASES;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| info               |
| mysql              |
| performance_schema |
| sys                |
| world              |
+--------------------+
mysql&gt; SHOW FULL TABLES FROM info;
+---------------------------------------+------------+
| Tables_in_info                        | Table_type |
+---------------------------------------+------------+
| character_sets                        | VIEW       |
| collation_character_set_applicability | VIEW       |
| collations                            | VIEW       |
| column_privileges                     | VIEW       |
| columns                               | VIEW       |
...
</pre>

<h4><a name="sys-diagnostics"></a>24.4.4.2. Процедура diagnostics()</h4>
<p>Создает сообщение о текущем состоянии сервера в диагностических целях.</p>

<p>Эта процедура требует привилегию
<a href="security.html#priv_super"><code>SUPER</code></a>, потому что
управляет сеансовой переменной
<a href="server.htm#sysvar_sql_log_bin"><code>sql_log_bin</code></a>, чтобы
отключить двоичное журналирование во время выполнения.</p>

<p>Данные, собранные для
<a href="#sys-diagnostics"><code>diagnostics()</code></a>,
включают эту информацию:</p>

<ul><li><p>Информация из представления
<a href="#sys-metrics"><code>metrics</code></a>
(см. <a href="#sys-metrics">раздел 24.4.3.21</a>).</li>

<li>Информация от другого соответствующего
представления схемы <code>sys</code>.</li>
<li>Информация из схемы <code>ndbinfo</code>, если сервер MySQL
часть MySQL Cluster.</li>
<li>Состояние репликации (ведущее и ведомое устройства).</p></li></ul>

<p>Некоторые изпредставлений схемы sys
вычислены как (дополнительная) начальная буква и значения дельты:</p>
<ul><li><p>Начальное представление это контент представления в начале
выполнения <a href="#sys-diagnostics"><code>diagnostics()</code></a>.
Этот вывод то же самое, как значения запуска, используемые для представления
дельты. Начальное представление включено, если опция
<code>diagnostics.include_raw</code> <code>ON</code>.</li>

<li>Полное представление это контент представления в конце
<a href="#sys-diagnostics"><code>diagnostics()</code></a>.
Этот вывод то же самое, как последние значения, используемые для
представления дельты. Полное представление всегда включается.</li>

<li>Представление дельты различие от начала до конца выполнения процедуры.
Минимальные и максимальные значения это минимальные и максимальные значения
из представления в конце, соответственно. Они не обязательно отражают
минимальные и максимальные значения в проверенный период. За исключением
<a href="#sys-metrics"><code>metrics</code></a>,
дельта вычислена только между первыми и последними выводами.</p></li></ul>

<h5><a name="idm139965281434528"></a>Параметры</h5>
<ul><li><p><code>in_max_runtime INT UNSIGNED</code>: Максимальное время сбора
данных в секундах. Использование <code>NULL</code> собирает данные для
значения по умолчанию в 60 секунд. Иначе используйте значение больше 0.</li>

<li><code>in_interval INT UNSIGNED</code>: Время сна между сборами данных в
секундах. Использование <code>NULL</code> предписывает спать по умолчанию 30
секунд. Иначе используйте значение больше 0.</li>

<li><code>in_auto_config ENUM('current', 'medium', 'full')</code>:
Конфигурация Performance Schema. Разрешенные значения:</p>
<ul><li><p><code>current</code>: Используйте текущий
инструмент и потребительские настройки.</li>

<li><code>medium</code>: Включить некоторые инструменты и потребители.</li>
<li><code>full</code>: Включить все инструменты и потребителей.</p></li></ul>
<p>Чем больше инструментов и потребителей включены, тем больше воздействия на
работу сервера MySQL. Будьте осторожны с настройкой <code>medium</code> и
особенно с <code>full</code>, которая оказывает
большое исполнительное влияние.</p>

<p>Использование <code>medium</code> или <code>full</code> требует привилегии
<a href="security.html#priv_super"><code>SUPER</code></a>.</p>
<p>Если установка не <code>current</code>, текущие настройки
восстановлены в конце процедуры.</p></li></ul>

<h5><a name="idm139965281415168"></a>Опции</h5>
<p>Работа <a href="#sys-diagnostics"><code>diagnostics()</code></a>
может быть изменена, используя следующие параметры конфигурации или их
соответствующие определяемые пользователем переменные (см.
<a href="#sys-sys-config">раздел 24.4.2.1</a>):</p>

<ul><li><p><code>debug</code>, <code>@sys.debug</code>.</p>
<p>Если эта опция <code>ON</code>, производится вывод отладки.
Значение по умолчанию <code>OFF</code>.</li>

<li><code>diagnostics.allow_i_s_tables</code>,
<code>@sys.diagnostics.allow_i_s_tables</code>.</p>
<p>Если эта опция <code>ON</code>, процедуре
<a href="#sys-diagnostics"><code>diagnostics()</code></a>
разрешают выполнить сканирование таблицы
<a href="inform.htm#tables-table"><code>INFORMATION_SCHEMA.TABLES</code></a>.
Это может быть долго, если есть много таблиц.
Значение по умолчанию <code>OFF</code>.</li>

<li><code>diagnostics.include_raw</code>,
<code>@sys.diagnostics.include_raw</code>.</p>
<p>Если эта опция <code>ON</code>, вывод процедуры
<a href="#sys-diagnostics"><code>diagnostics()</code></a>
включает сырой вывод из запросов к представлению
<a href="#sys-metrics"><code>metrics</code></a>.
Значение по умолчанию <code>OFF</code>.</li>

<li><code>statement_truncate_len</code>,
<code>@sys.statement_truncate_len</code>.</p>
<p>Максимальная длина запросов, возвращенных функцией
<a href="#sys-format-statement"><code>format_statement()</code></a>.
Более длинные запросы являются усеченными к этой длине.
Значение по умолчанию 64.</p></li></ul>

<h5><a name="idm139965281390480"></a>Пример</h5>
<p>Создайте отчет о диагностике, который запускает итерацию каждые 30 секунд
и работает в течение самое большее 120 секунд, используя текущие
настройки Performance Schema:
<pre>
mysql&gt; CALL diagnostics(120, 30, 'current');
</pre>

Чтобы получить вывод из процедуры <code>diagnostics()</code> в файл,
используйте команды клиента <a href="programs.htm#mysql"><span><strong>mysql
</strong></span></a> <code>tee<code>filename</code></code> и <code>notee
</code> (см. <a href="programs.htm#mysql-commands">раздел 5.5.1.2</a>):
<pre>
mysql&gt; tee diag.out;
mysql&gt; CALL diagnostics(120, 30, 'current');
mysql&gt; notee;
</pre>

<h4><a name="sys-execute-prepared-stmt"></a>24.4.4.3.
Процедура execute_prepared_stmt()</h4>
<p>Учитывая запрос SQL как строку, выполняет его как готовый запрос. Готовый
запрос освобожден после выполнения, таким образом, это не подвергается
повторному использованию. Таким образом, эта процедура полезна прежде всего
для выполнения динамических запросов на одноразовой основе.</p>

<p>Эта процедура использует <code>sys_execute_prepared_stmt</code>
как имя готового запроса. Если это имя запроса существует, когда процедуру
вызывают, его предыдущий контент разрушен.</p>

<h5><a name="idm139965281373520"></a>Параметры</h5>
<ul><li><p><code>in_query LONGTEXT CHARACTER SET utf8</code>:
Строка запроса, чтобы выполнить.</p></li></ul>

<h5><a name="idm139965281370896"></a>Опции</h5>
<p><a href="#sys-execute-prepared-stmt"><code>execute_prepared_stmt()
</code></a> может быть изменена, используя следующие параметры конфигурации
или их соответствующие определяемые пользователем переменные (см.
<a href="#sys-sys-config">раздел 24.4.2.1</a>):</p>

<ul><li><p><code>debug</code>, <code>@sys.debug</code>.</p>
<p>Если эта опция <code>ON</code>, производится вывод отладки.
Значение по умолчанию <code>OFF</code>.</p></li></ul>

<h5><a name="idm139965281363376"></a>Пример</h5>
<pre>
mysql&gt; CALL execute_prepared_stmt('SELECT COUNT(*) FROM mysql.user');
+----------+
| COUNT(*) |
+----------+
|   15     |
+----------+
</pre>

<h4><a name="sys-ps-setup-disable-background-threads"></a>24.4.4.4.
Процедура ps_setup_disable_background_threads()</h4>
<p>Отключает инструментовку Performance Schema для всех фоновых потоков.
Производит набор результатов, указывающий, сколько фоновых потоков было
отключено. Уже отключенные потоки не считаются.</p>

<h5><a name="idm139965281356176"></a>Параметры</h5>
<p>Нет.</p>
<h5><a name="idm139965281355104"></a>Пример</h5>
<pre>
mysql&gt; CALL ps_setup_disable_background_threads();
+--------------------------------+
| summary                        |
+--------------------------------+
| Disabled 24 background threads |
+--------------------------------+
</pre>

<h4><a name="sys-ps-setup-disable-consumer"></a>24.4.4.5.
Процедура ps_setup_disable_consumer()</h4>
<p>Отключает потребителей Performance Schema с именами, которые содержит
параметр. Производит набор результатов, указывающий, сколько потребителей
было отключено. Уже отключенные потребители не считаются.</p>

<h5><a name="idm139965281347872"></a>Параметры</h5>
<ul><li><p><code>consumer VARCHAR(128)</code>: Значение перечисляет
потребительские имена, которые идентифицированы при использовании
<code>%consumer%</code> как операнда для
<a href="funct.htm#operator_like"><code>LIKE</code></a>.</p>
<p>Значение <code>''</code> соответствует всем потребителям.</p></li></ul>

<h5><a name="idm139965281342112"></a>Пример</h5>
<p>Отключить всех потребителей запроса:
<pre>
mysql&gt; CALL ps_setup_disable_consumer('statement');
+----------------------+
| summary              |
+----------------------+
| Disabled 4 consumers |
+----------------------+
</pre>

<h4><a name="sys-ps-setup-disable-instrument"></a>24.4.4.6.
Процедура ps_setup_disable_instrument()</h4>
<p>Отключает инструменты Performance Schema с именами, которые содержит
параметр. Производит набор результатов, указывающий, сколько инструментов
было отключено. Уже отключенные инструменты не считаются.</p>

<h5><a name="idm139965281334480"></a>Параметры</h5>
<ul><li><p><code>in_pattern VARCHAR(128)</code>: Значение перечисляет
имена, которые идентифицированы при использовании
<code>%in_pattern%</code> как операнда для
<a href="funct.htm#operator_like"><code>LIKE</code></a>.
Значение <code>''</code> соответствует всем инструментам.</p></li></ul>

<h5><a name="idm139965281328720"></a>Пример</h5>
<p>Отключите определенный инструмент:
<pre>
mysql&gt; CALL ps_setup_disable_instrument('wait/lock/metadata/sql/mdl');
+-----------------------+
| summary               |
+-----------------------+
| Disabled 1 instrument |
+-----------------------+
</pre>

Отключите все mutex инструменты:
<pre>
mysql&gt; CALL ps_setup_disable_instrument('mutex');
+--------------------------+
| summary                  |
+--------------------------+
| Disabled 177 instruments |
+--------------------------+
</pre>

<h4><a name="sys-ps-setup-disable-thread"></a>24.4.4.7.
Процедура ps_setup_disable_thread()</h4>
<p>Учитывая идентификатор соединения, отключает инструментовку
Performance Schema для потока. Производит набор результатов, указывающий,
сколько потоков было отключено. Уже отключенные потоки не считаются.</p>

<h5><a name="idm139965281319072"></a>Параметры</h5>
<ul><li><p><code>in_connection_id BIGINT</code>: Идентификатор соединения.
Это идентификатор соединения из столбца <code>PROCESSLIST_ID</code> таблицы
Performance Schema <a href="perfor.htm#threads-table"><code>threads</code>
</a> или столбца <code>Id</code> вывода
<a href="sql.htm#show-processlist"><code>SHOW PROCESSLIST</code></a>.
</p></li></ul>

<h5><a name="idm139965281312496"></a>Пример</h5>
<p>Отключите определенное соединение по его ID:
<pre>
mysql&gt; CALL ps_setup_disable_thread(225);
+-------------------+
| summary           |
+-------------------+
| Disabled 1 thread |
+-------------------+
</pre>

Отключите текущее соединение:
<pre>
mysql&gt; CALL ps_setup_disable_thread(CONNECTION_ID());
+-------------------+
| summary           |
+-------------------+
| Disabled 1 thread |
+-------------------+
</pre>

<h4><a name="sys-ps-setup-enable-background-threads"></a>24.4.4.8.
Процедура ps_setup_enable_background_threads()</h4>
<p>Включает инструментовку Performance Schema для всех фоновых потоков.
Производит набор результатов, указывающий, сколько фоновых потоков было
включено. Уже включенные потоки не считаются.</p>

<h5><a name="idm139965281302832"></a>Параметры</h5>
<p>Нет.</p>
<h5><a name="idm139965281301760"></a>Пример</h5>
<pre>
mysql&gt; CALL ps_setup_enable_background_threads();
+-------------------------------+
| summary                       |
+-------------------------------+
| Enabled 24 background threads |
+-------------------------------+
</pre>

<h4><a name="sys-ps-setup-enable-consumer"></a>24.4.4.9.
Процедура ps_setup_enable_consumer()</h4>
<p>Включает потребителей Performance Schema с именами, которые содержит
параметр. Производит набор результатов, указывающий, сколько потребителей
включились. Уже включенные потребители не считаются.</p>

<h5><a name="idm139965281294608"></a>Параметры</h5>
<ul><li><p><code>consumer VARCHAR(128)</code>: Значение перечисляет
имена, которые идентифицированы при использовании <code>%consumer%</code>
как операнд для <a href="funct.htm#operator_like"><code>LIKE</code></a>.
Значение <code>''</code> соответствует всем потребителям.</p></li></ul>

<h5><a name="idm139965281288848"></a>Пример</h5>
<p>Включите всех потребителей:
<pre>
mysql&gt; CALL ps_setup_enable_consumer('statement');
+---------------------+
| summary             |
+---------------------+
| Enabled 4 consumers |
+---------------------+
</pre>

<h4><a name="sys-ps-setup-enable-instrument"></a>24.4.4.10.
Процедура ps_setup_enable_instrument()</h4>
<p>Включает инструменты Performance Schema с именами, которые содержит
параметр. Производит набор результатов, указывающий, сколько инструментов
было включено. Уже включенные инструменты не считаются.</p>

<h5><a name="idm139965281281216"></a>Параметры</h5>
<ul><li><p><code>in_pattern VARCHAR(128)</code>: Значение перечисляет
имена, которые идентифицированы при использовании <code>%in_pattern%</code>
как операнд для <a href="funct.htm#operator_like"><code>LIKE</code></a>.
Значение <code>''</code> соответствует всем инструментам.</p></li></ul>

<h5><a name="idm139965281275456"></a>Пример</h5>
<p>Включите определенный инструмент:
<pre>
mysql&gt; CALL ps_setup_enable_instrument('wait/lock/metadata/sql/mdl');
+----------------------+
| summary              |
+----------------------+
| Enabled 1 instrument |
+----------------------+
</pre>

Включите все mutex инструменты:
<pre>
mysql&gt; CALL ps_setup_enable_instrument('mutex');
+-------------------------+
| summary                 |
+-------------------------+
| Enabled 177 instruments |
+-------------------------+
</pre>

<h4><a name="sys-ps-setup-enable-thread"></a>24.4.4.11.
Процедура ps_setup_enable_thread()</h4>
<p>Учитывая идентификатор соединения, включает инструментовку Performance
Schema для потока. Производит набор результатов, указывающий, сколько потоков
было включено. Уже включенные потоки не считаются.</p>

<h5><a name="idm139965281265808"></a>Параметры</h5>
<ul><li><p><code>in_connection_id BIGINT</code>: Идентификатор соединения.
Это ID соединения как в столбце <code>PROCESSLIST_ID</code> таблицы
Performance Schema <a href="perfor.htm#threads-table"><code>threads</code>
</a> или столбце <code>Id</code> вывода
<a href="sql.htm#show-processlist"><code>SHOW PROCESSLIST</code></a>.
</p></li></ul>

<h5><a name="idm139965281259232"></a>Пример</h5>
<p>Включите определенное ID соединение:
<pre>
mysql&gt; CALL ps_setup_enable_thread(225);
+------------------+
| summary          |
+------------------+
| Enabled 1 thread |
+------------------+
</pre>

Включите текущее соединение:
<pre>
mysql&gt; CALL ps_setup_enable_thread(CONNECTION_ID());
+------------------+
| summary|
+------------------+
| Enabled 1 thread |
+------------------+
</pre>

<h4><a name="sys-ps-setup-reload-saved"></a>24.4.4.12.
Процедура ps_setup_reload_saved()</h4>
<p>Перезагружает конфигурацию Performance Schema, сохраненную ранее в
пределах того же самого использования сеанса с помощью
<a href="#sys-ps-setup-save"><code>ps_setup_save()</code></a>.
Для получения дополнительной информации см. описание
<a href="#sys-ps-setup-save"><code>ps_setup_save()</code></a>.</p>

<p>Эта процедура требует привилегии
<a href="security.html#priv_super"><code>SUPER</code></a>, потому что это
управляет сеансовой перменной
<a href="server.htm#sysvar_sql_log_bin"><code>sql_log_bin</code></a>, чтобы
отключить двоичное журналирование во время выполнения.</p>

<h5><a name="idm139965281244240"></a>Параметры</h5>
<p>Нет.</p>
<h4><a name="sys-ps-setup-reset-to-default"></a>24.4.4.13.
Процедура ps_setup_reset_to_default()</h4>
<p>Сбрасывает конфигурацию Performance Schema
к ее настройкам по умолчанию.</p>

<h5><a name="idm139965281238320"></a>Параметры</h5>
<ul><li><p><code>in_verbose BOOLEAN</code>: Вывести ли на экран информацию о
каждом этапе во время выполнения процедуры. Это включает
выполненные запросы SQL.</p></li></ul>

<h5><a name="idm139965281235616"></a>Пример</h5>
<pre>
mysql&gt; CALL ps_setup_reset_to_default(TRUE)\G
*************************** 1. row ***************************
status: Resetting: setup_actors
DELETE
FROM performance_schema.setup_actors
WHERE NOT (HOST = '%' AND USER = '%' AND ROLE = '%')

*************************** 1. row ***************************
status: Resetting: setup_actors
INSERT IGNORE INTO performance_schema.setup_actors
VALUES ('%', '%', '%')
...
</pre>

<h4><a name="sys-ps-setup-save"></a>24.4.4.14. Процедура ps_setup_save()</h4>
<p>Сохраняет текущую конфигурацию Performance Schema. Это позволяет Вам
изменить конфигурацию временно для отладки или других целей, затем
восстановить это в предыдущее состояние, вызывая
<a href="#sys-ps-setup-reload-saved"><code>ps_setup_reload_saved()
</code></a>.</p>

<p>Чтобы предотвратить другие одновременные требования сохранить
конфигурацию, <a href="#sys-ps-setup-save"><code>ps_setup_save()
</code></a> приобретает блокировку <code>sys.ps_setup_save</code> вызовом
функции <a href="funct.htm#function_get-lock"><code>GET_LOCK()</code></a>.
<a href="#sys-ps-setup-save"><code>ps_setup_save()</code></a>
берет параметр тайм-аута, чтобы указать, сколько секунд ждать, если
блокировка уже существует (это указывает, что у некоторого другого сеанса
есть сохраненная конфигурация). Если тайм-аут истекает, не получая
блокировку, <a href="#sys-ps-setup-save"><code>ps_setup_save()</code>
</a> терпит неудачу.</p>

<p>Это предназначено для вызова
<a href="#sys-ps-setup-reload-saved"><code>ps_setup_reload_saved()
</code></a> позже в пределах <span class="emphasis"><em>того же самого</em>
</span> сеанса, что и <a href="#sys-ps-setup-save"><code>
ps_setup_save()</code></a>, потому что конфигурация сохранена в таблицы
<code>TEMPORARY</code>. <a href="#sys-ps-setup-save"><code>
ps_setup_save()</code></a> удаляет временные таблицы и выпускает блокировку.
Если Вы заканчиваете свой сеанс без вызова
<a href="#sys-ps-setup-save"><code>ps_setup_save()</code></a>,
таблицы и блокировка исчезают автоматически.</p>

<p>Эта процедура требует привилегии
<a href="security.html#priv_super"><code>SUPER</code></a>, потому что это
управляет сеансовой перменной
<a href="server.htm#sysvar_sql_log_bin"><code>sql_log_bin</code></a>, чтобы
отключить двоичное журналирование во время выполнения.</p>

<h5><a name="idm139965281210736"></a>Параметры</h5>
<ul><li><p><code>in_timeout INT</code>: Сколько секунд ждать, чтобы получить
блокировку <code>sys.ps_setup_save</code>. Отрицательное значение тайм-аута
означает бесконечный тайм-аут.</p></li></ul>

<h5><a name="idm139965281207360"></a>Пример</h5>
<pre>
mysql&gt; CALL ps_setup_save(10);
... <em><code>make Performance Schema configuration changes</code></em> ...
mysql&gt; CALL ps_setup_reload_saved();
</pre>

<h4><a name="sys-ps-setup-show-disabled"></a>24.4.4.15. Процедура
ps_setup_show_disabled()</h4>
<p>Показывает все в настоящее время отключенные
конфигурации Performance Schema.</p>

<h5><a name="idm139965281199280"></a>Параметры</h5>
<ul><li><p><code>in_show_instruments BOOLEAN</code>: Вывести ли на экран
отключенные инструменты. Это может быть длинным списком.</li>
<li><code>in_show_threads BOOLEAN</code>: Вывести ли на
экран отключенные потоки.</p></li></ul>

<h5><a name="idm139965281195088"></a>Пример</h5>
<pre>
mysql&gt; CALL ps_setup_show_disabled(TRUE, TRUE);
+----------------------------+
| performance_schema_enabled |
+----------------------------+
|  1                         |
+----------------------------+
+---------------+
| enabled_users |
+---------------+
| '%'@'%'       |
+---------------+
+-------------+----------------------+---------+-------+
| object_type | objects              | enabled | timed |
+-------------+----------------------+---------+-------+
| EVENT       | mysql.%              | NO      | NO    |
| EVENT       | performance_schema.% | NO      | NO    |
| EVENT       | information_schema.% | NO      | NO    |
| FUNCTION    | mysql.%              | NO      | NO    |
| FUNCTION    | performance_schema.% | NO      | NO    |
| FUNCTION    | information_schema.% | NO      | NO    |
| PROCEDURE   | mysql.%              | NO      | NO    |
| PROCEDURE   | performance_schema.% | NO      | NO    |
| PROCEDURE   | information_schema.% | NO      | NO    |
| TABLE       | mysql.%              | NO      | NO    |
| TABLE       | performance_schema.% | NO      | NO    |
| TABLE       | information_schema.% | NO      | NO    |
| TRIGGER     | mysql.%              | NO      | NO    |
| TRIGGER     | performance_schema.% | NO      | NO    |
| TRIGGER     | information_schema.% | NO      | NO    |
+-------------+----------------------+---------+-------+
...
</pre>

<h4><a name="sys-ps-setup-show-disabled-consumers"></a>24.4.4.16.
Процедура ps_setup_show_disabled_consumers()</h4>
<p>Показать всех в настоящее время отключенных
потребителей Performance Schema.</p>

<h5><a name="idm139965281186080"></a>Параметры</h5>
<p>Нет.</p>
<h5><a name="idm139965281185008"></a>Пример</h5>
<pre>
mysql&gt; CALL ps_setup_show_disabled_consumers();
+----------------------------------+
| disabled_consumers               |
+----------------------------------+
| events_stages_current            |
| events_stages_history            |
| events_stages_history_long       |
| events_statements_history        |
| events_statements_history_long   |
| events_transactions_history      |
| events_transactions_history_long |
| events_waits_current             |
| events_waits_history             |
| events_waits_history_long        |
+----------------------------------+
</pre>

<h4><a name="sys-ps-setup-show-disabled-instruments"></a>24.4.4.17.
Процедура ps_setup_show_disabled_instruments()</h4>
<p>Показывает все в настоящее время отключенные инструменты
Performance Schema. Это может быть длинным списком.</p>

<h5><a name="idm139965281177472"></a>Параметры</h5>
<p>Нет.</p>
<h5><a name="idm139965281176400"></a>Пример</h5>
<pre>
mysql&gt; CALL ps_setup_show_disabled_instruments()\G
*************************** 1. row ***************************
disabled_instruments: wait/synch/mutex/sql/TC_LOG_MMAP::LOCK_tc
 timed: NO
*************************** 2. row ***************************
disabled_instruments: wait/synch/mutex/sql/LOCK_des_key_file
 timed: NO
*************************** 3. row ***************************
disabled_instruments: wait/synch/mutex/sql/MYSQL_BIN_LOG::LOCK_commit
 timed: NO
...
</pre>

<h4><a name="sys-ps-setup-show-enabled"></a>24.4.4.18.
Процедура ps_setup_show_enabled()</h4>
<p>Показывает все в настоящее время включенные
конфигурации Performance Schema.</p>

<h5><a name="idm139965281199280"></a>Параметры</h5>
<ul><li><p><code>in_show_instruments BOOLEAN</code>: Вывести ли на экран
отключенные инструменты. Это может быть длинным списком.</li>
<li><code>in_show_threads BOOLEAN</code>: Вывести ли на
экран отключенные потоки.</p></li></ul>

<h5><a name="idm139965281164384"></a>Пример</h5>
<pre>
mysql&gt; CALL ps_setup_show_enabled(FALSE, FALSE);
+----------------------------+
| performance_schema_enabled |
+----------------------------+
|  1                         |
+----------------------------+
1 row in set (0.00 sec)

+---------------+
| enabled_users |
+---------------+
| '%'@'%'       |
+---------------+
1 row in set (0.00 sec)

+-------------+---------+---------+-------+
| object_type | objects | enabled | timed |
+-------------+---------+---------+-------+
| EVENT       | %.%     | YES     | YES   |
| FUNCTION    | %.%     | YES     | YES   |
| PROCEDURE   | %.%     | YES     | YES   |
| TABLE       | %.%     | YES     | YES   |
| TRIGGER     | %.%     | YES     | YES   |
+-------------+---------+---------+-------+
5 rows in set (0.01 sec)

+-----------------------------+
| enabled_consumers           |
+-----------------------------+
| events_statements_current   |
| events_transactions_current |
| global_instrumentation      |
| thread_instrumentation      |
| statements_digest           |
+-----------------------------+
</pre>

<h4><a name="sys-ps-setup-show-enabled-consumers"></a>24.4.4.19.
Процедура ps_setup_show_enabled_consumers()</h4>
<p>Показать всех в настоящее время включенных
потребителей Performance Schema.</p>

<h5><a name="idm139965281156288"></a>Параметры</h5>
<p>Нет.</p>
<h5><a name="idm139965281155216"></a>Пример</h5>
<pre>
mysql&gt; CALL ps_setup_show_enabled_consumers();
+-----------------------------+
| enabled_consumers           |
+-----------------------------+
| events_statements_current   |
| events_transactions_current |
| global_instrumentation      |
| thread_instrumentation      |
| statements_digest           |
+-----------------------------+
</pre>

<h4><a name="sys-ps-setup-show-enabled-instruments"></a>24.4.4.20.
Процедура ps_setup_show_enabled_instruments()</h4>
<p>Показывает все в настоящее время включенные инструменты
Performance Schema. Это может быть длинным списком.</p>
<h5><a name="idm139965281148000"></a>Параметры</h5>
<p>Нет.</p>

<h5><a name="idm139965281146928"></a>Пример</h5>
<pre>
mysql&gt; CALL ps_setup_show_enabled_instruments()\G
*************************** 1. row ***************************
enabled_instruments: wait/io/file/sql/map
timed: YES
*************************** 2. row ***************************
enabled_instruments: wait/io/file/sql/binlog
timed: YES
*************************** 3. row ***************************
enabled_instruments: wait/io/file/sql/binlog_cache
timed: YES
...
</pre>

<h4><a name="sys-ps-statement-avg-latency-histogram"></a>24.4.4.21.
Процедура ps_statement_avg_latency_histogram()</h4>
<p>Выводит на экран текстовый график гистограммы средних значений времени
ожидания для всех нормализованных запросов, прослеженных в пределах таблицы
Performance Schema <a href="perfor.htm#statement-summary-tables"><code>
events_statements_summary_by_digest</code></a>.</p>

<p>Эта процедура может использоваться, чтобы вывести на экран очень
высокоуровневое изображение распределения времени ожидания запросов,
работающих в пределах этого экземпляра MySQL.</p>

<h5><a name="idm139965281137632"></a>Параметры</h5>
<p>Нет.</p>
<h5><a name="idm139965281136512"></a>Пример</h5>
<p>Гистограмма выведена в модулях запросов. Например,
<code>* = 2 units</code> в гистограмме означает, что каждый
символ <code>*</code> представляет 2 запроса.
<pre>
mysql&gt; CALL ps_statement_avg_latency_histogram()\G
*************************** 1. row ***************************
Performance Schema Statement Digest Average Latency Histogram:

  . = 1 unit
  * = 2 units
  # = 3 units

(0 - 66ms) 88  | #############################
(66 - 133ms)   14  | ..............
(133 - 199ms)  4   | ....
(199 - 265ms)  5   | **
(265 - 332ms)  1   | .
(332 - 398ms)  0   |
(398 - 464ms)  1   | .
(464 - 531ms)  0   |
(531 - 597ms)  0   |
(597 - 663ms)  0   |
(663 - 730ms)  0   |
(730 - 796ms)  0   |
(796 - 863ms)  0   |
(863 - 929ms)  0   |
(929 - 995ms)  0   |
(995 - 1062ms) 0   |

  Total Statements: 114; Buckets: 16; Bucket Size: 66 ms;
</pre>

<h4><a name="sys-ps-trace-statement-digest"></a>24.4.4.22.
Процедура ps_trace_statement_digest()</h4>
<p>Трассирует все инструменты Performance Schema
для определенного обзора запроса.</p>

<p>Если Вы находите запрос интересным в пределах таблицы Performance Schema
<a href="perfor.htm#statement-summary-tables"><code>
events_statements_summary_by_digest</code></a>, определите значение
MD5 столбца <code>DIGEST</code> этой процедуре и укажите продолжительность и
интервал. Результат: сообщение обо всей статистике, прослеженной в пределах
Performance Schema для этого обзора в интервале.</p>

<p>Процедура также пытается выполнить
<a href="sql.htm#explain"><code>EXPLAIN</code></a>
для самого длинного рабочего примера обзора во время интервала. Эта попытка
могла бы потерпеть неудачу, потому что Performance Schema усекает длинные
значения <code>SQL_TEXT</code>. Следовательно,
<a href="sql.htm#explain"><code>EXPLAIN</code></a> потерпит неудачу.</p>

<p>Эта процедура требует привилегии
<a href="security.html#priv_super"><code>SUPER</code></a>, потому что это
управляет сеансовой переменной
<a href="server.htm#sysvar_sql_log_bin"><code>sql_log_bin</code></a>, чтобы
отключить двоичное журналирование во время выполнения.</p>

<h5><a name="idm139965281117408"></a>Параметры</h5>
<ul><li><p><code>in_digest VARCHAR(32)</code>:
Идентификатор обзора запроса, чтобы проанализировать.</li>
<li><code>in_runtime INT</code>: Сколько времени выполнить анализ в секундах.
</li>

<li><code>in_interval DECIMAL(2,2)</code>: Аналитический интервал в секундах
(может быть дробным), в котором можно попытаться взять снимки.</li>
<li><code>in_start_fresh BOOLEAN</code>: Усечь ли таблицы Performance Schema
<a href="perfor.htm#events-statements-history-long-table">
<code>events_statements_history_long</code></a> и
<a href="perfor.htm#events-stages-history-long-table"><code>
events_stages_history_long</code></a> перед запуском.</li>
<li><code>in_auto_enable BOOLEAN</code>: Включить ли
автоматически необходимых потребителей.</p></li></ul>

<h5><a name="idm139965281105904"></a>Пример</h5>
<pre>
mysql&gt; CALL ps_trace_statement_digest('891ec6860f98ba46d89dd20b0c03652c', 10, 0.1, TRUE, TRUE);
+--------------------+
| SUMMARY STATISTICS |
+--------------------+
| SUMMARY STATISTICS |
+--------------------+
1 row in set (9.11 sec)

+------------+-----------+-----------+-----------+---------------+------------+------------+
| executions | exec_time | lock_time | rows_sent | rows_examined | tmp_tables | full_scans |
+------------+-----------+-----------+-----------+---------------+------------+------------+
| 21         | 4.11 ms   | 2.00 ms   | 0         |  21           | 0          | 0          |
+------------+-----------+-----------+-----------+---------------+------------+------------+
1 row in set (9.11 sec)

+------------------------------------------+-------+-----------+
| event_name                               | count | latency   |
+------------------------------------------+-------+-----------+
| stage/sql/checking query cache for query | 16    | 724.37 us |
| stage/sql/statistics                     | 16    | 546.92 us |
| stage/sql/freeing items                  | 18    | 520.11 us |
| stage/sql/init                           | 51    | 466.80 us |
...
| stage/sql/cleaning up                    | 18    | 11.92 us  |
| stage/sql/executing                      | 16    | 6.95 us   |
+------------------------------------------+-------+-----------+
17 rows in set (9.12 sec)

+---------------------------+
| LONGEST RUNNING STATEMENT |
+---------------------------+
| LONGEST RUNNING STATEMENT |
+---------------------------+
1 row in set (9.16 sec)

+-----------+-----------+-----------+-----------+---------------+------------+-----------+
| thread_id | exec_time | lock_time | rows_sent | rows_examined | tmp_tables | full_scan |
+-----------+-----------+-----------+-----------+---------------+------------+-----------+
|166646     | 618.43 us | 1.00 ms   | 0         |   1           | 0          | 0         |
+-----------+-----------+-----------+-----------+---------------+------------+-----------+
1 row in set (9.16 sec)

# Truncated for clarity...
+-----------------------------------------------------------------+
| sql_text                                                        |
+-----------------------------------------------------------------+
| select hibeventhe0_.id as id1382_, hibeventhe0_.createdTime ... |
+-----------------------------------------------------------------+
1 row in set (9.17 sec)

+------------------------------------------+-----------+
| event_name                               | latency   |
+------------------------------------------+-----------+
| stage/sql/init                           | 8.61 us   |
| stage/sql/Waiting for query cache lock   | 453.23 us |
| stage/sql/init                           | 331.07 ns |
| stage/sql/checking query cache for query | 43.04 us  |
...
| stage/sql/freeing items                  | 30.46 us  |
| stage/sql/cleaning up                    | 662.13 ns |
+------------------------------------------+-----------+
18 rows in set (9.23 sec)

+----+-------------+--------------+-------+---------------+-----------+---------+-------------+------+-------+
| id | select_type | table        | type  | possible_keys | key       | key_len | ref         | rows | Extra |
+----+-------------+--------------+-------+---------------+-----------+---------+-------------+------+-------+
|  1 | SIMPLE      | hibeventhe0_ | const | fixedTime     | fixedTime | 775     | const,const | 1    | NULL  |
+----+-------------+--------------+-------+---------------+-----------+---------+-------------+------+-------+
1 row in set (9.27 sec)

Query OK, 0 rows affected (9.28 sec)
</pre>

<h4><a name="sys-ps-trace-thread"></a>24.4.4.23. Процедура ps_trace_thread()
</h4>
<p>Выводит все данные Performance Schema для инструментованного потока в
отформатированный файл графика <code>.dot</code> (для языка описания графика
DOT). Каждый набор результатов, возвращенный из процедуры, должен
использоваться для полного графика.</p>

<p>Эта процедура требует привилегии
<a href="security.html#priv_super"><code>SUPER</code></a>, потому что это
управляет сеансовой переменной
<a href="server.htm#sysvar_sql_log_bin"><code>sql_log_bin</code></a>, чтобы
отключить двоичное журналирование во время выполнения.</p>

<h5><a name="idm139965281087952"></a>Параметры</h5>
<ul><li><p><code>in_thread_id INT</code>: Поток, чтобы проследить.</li>
<li><code>in_outfile VARCHAR(255)</code>: Имя выходного файла
<code>.dot</code>.</li>

<li><code>in_max_runtime DECIMAL(20,2)</code>: Максимальное количество секунд
(может быть дробным), чтобы собрать данные. Используйте <code>NULL</code>
для значения по умолчанию в 60 секунд.</li>

<li><code>in_interval DECIMAL(20,2)</code>: Число секунд (может быть дробным),
которые спать между сборами данных. Используйте <code>NULL</code>
для значения по умолчанию в 1 секунду.</li>

<li><code>in_start_fresh BOOLEAN</code>: Сбросить ли все данные
Performance Schema перед рассмотрением.</li>
<li><code>in_auto_setup BOOLEAN</code>: Запретить ли все другие потоки и
включить ли все инструменты и потребители. Это также сбрасывает
настройки в конце выполнения.</li>
<li><code>in_debug BOOLEAN</code>: Включать ли информацию
<code>file:lineno</code> в график.</p></li></ul>

<h5><a name="idm139965281072896"></a>Пример</h5>
<pre>
mysql&gt; CALL ps_trace_thread(25, CONCAT('/tmp/stack-', REPLACE(NOW(),
               ' ', '-'), '.dot'), NULL, NULL, TRUE, TRUE, TRUE);
+-------------------+
| summary           |
+-------------------+
| Disabled 1 thread |
+-------------------+
1 row in set (0.00 sec)

+---------------------------------------------+
| Info                                        |
+---------------------------------------------+
| Data collection starting for THREAD_ID = 25 |
+---------------------------------------------+
1 row in set (0.03 sec)

+-----------------------------------------------------------+
| Info                                                      |
+-----------------------------------------------------------+
| Stack trace written to /tmp/stack-2014-02-16-21:18:41.dot |
+-----------------------------------------------------------+
1 row in set (60.07 sec)

+-------------------------------------------------------------------+
| Convert to PDF                                                    |
+-------------------------------------------------------------------+
| dot -Tpdf -o /tmp/stack_25.pdf /tmp/stack-2014-02-16-21:18:41.dot |
+-------------------------------------------------------------------+
1 row in set (60.07 sec)

+-------------------------------------------------------------------+
| Convert to PNG                                                    |
+-------------------------------------------------------------------+
| dot -Tpng -o /tmp/stack_25.png /tmp/stack-2014-02-16-21:18:41.dot |
+-------------------------------------------------------------------+
1 row in set (60.07 sec)

+------------------+
| summary          |
+------------------+
| Enabled 1 thread |
+------------------+
1 row in set (60.32 sec)
</pre>

<h4><a name="sys-ps-truncate-all-tables"></a>24.4.4.24.
Процедура ps_truncate_all_tables()</h4>
<p>Усекает все сводные таблицы Performance Schema, сбрасывая всю соединенную
инструментовку как снимок. Производит набор результатов, указывающий, сколько
таблиц было усечено.</p>

<h5><a name="idm139965281062592"></a>Параметры</h5>
<ul><li><p><code>in_verbose BOOLEAN</code>: Вывести ли на экран каждый
запрос <a href="sql.htm#truncate-table"><code>TRUNCATE TABLE</code></a>
прежде, чем выполнить это.</p></li></ul>

<h5><a name="idm139965281058720"></a>Пример</h5>
<pre>
mysql&gt; CALL ps_truncate_all_tables(FALSE);
+---------------------+
| summary             |
+---------------------+
| Truncated 44 tables |
+---------------------+
</pre>

<h4><a name="sys-statement-performance-analyzer"></a>24.4.4.25.
Процедура statement_performance_analyzer()</h4>
<p>Создает сообщение о запросах, работающих на сервере. Представления
вычислены, базируясь на полной деятельности и/или деятельности дельты.</p>

<p>Эта процедура требует привилегии
<a href="security.html#priv_super"><code>SUPER</code></a>, потому что это
управляет сеансовой переменной
<a href="server.htm#sysvar_sql_log_bin"><code>sql_log_bin</code></a>, чтобы
отключить двоичное журналирование во время выполнения.</p>

<h5><a name="idm139965281047856"></a>Параметры</h5>
<ul><li><p><code>in_action ENUM('snapshot', 'overall', 'delta',
'create_tmp', 'create_table', 'save', 'cleanup')</code>:
Действие. Эти значения разрешены:</p>

<ul><li><p><code>snapshot</code>: Сохранить снимок. Значение по умолчанию
должно сделать снимок текущего контента таблицы Performance Schema
<a href="perfor.htm#statement-summary-tables"><code>
events_statements_summary_by_digest</code></a>. Устанавливая
<code>in_table</code>, это можно перезаписать, чтобы скопировать контент
указанной таблицы. Снимок сохранен во временной таблице
<code>tmp_digests</code> <a href="sys.htm"><code>sys</code></a> schema.</li>

<li><code>overall</code>: Произвести анализ, основанный на контенте таблицы,
определенной <code>in_table</code>. Для полного анализа <code>in_table</code>
может быть <a href="funct.htm#function_now"><code>NOW()</code></a>, чтобы
использовать новый снимок. Это перезаписывает существующий снимок.
Используйте <code>NULL</code> для <code>in_table</code>, чтобы
использовать существующий снимок. Если <code>in_table</code>
<code>NULL</code> и никакой снимок не существует, новый снимок создается.
Параметр <code>in_views</code> и опция
<code>statement_performance_analyzer.limit</code> влияют на эту процедуру.
</li>

<li><code>delta</code>: Произвести анализ дельты. Дельта вычислена между
ссылочной таблицей, определенной <code>in_table</code>, и снимком, который
должен существовать. Это действие использует временную таблицу
<code>tmp_digests_delta</code> <a href="sys.htm"><code>sys</code></a> schema.
Параметр <code>in_views</code> и опция
<code>statement_performance_analyzer.limit</code> влияют на эту процедуру.
</li>

<li><code>create_table</code>: Составить регулярную таблицу, подходящую для
того, чтобы сохранить снимок для более позднего использования (например, для
того, чтобы вычислить дельты).</li>

<li><code>create_tmp</code>: Составить временную таблицу, подходящую для
того, чтобы сохранить снимок для более позднего использования (например, для
того, чтобы вычислить дельты).</li>

<li><code>save</code>: Сохранить снимок в таблице, определенной
<code>in_table</code>. Таблица должна существовать и иметь правильную
структуру. Если никакой снимок не существует, новый снимок создается.</li>

<li><code>cleanup</code>: Удалить временные таблицы, используемые
для снимка и дельты.</p></li></ul></li>
<li><code>in_table VARCHAR(129)</code>: Табличный параметр, используемый для
некоторых из действий, определенных параметром <code>in_action</code>.
Используйте формат <em><code>db_name.tbl_name</code></em> или
<em><code>tbl_name</code></em> не используя обратный апостроф
(<code>`</code>). Точка (<code>.</code>) не поддержана в именах
базы данных и таблиц.</p>
<p>Значение <code>in_table</code> для каждого <code>in_action</code>
детализировано в описании <code>in_action</code>.</li>

<li><code>in_views SET ('with_runtimes_in_95th_percentile',
'analysis', 'with_errors_or_warnings',
'with_full_table_scans', 'with_sorting',
'with_temp_tables', 'custom')</code>:
Какие представления включать. Этот параметр <code>SET</code>, таким образом,
это может содержать много имен представлений, отделенных запятыми. Значение
по умолчанию должно включать все представления, кроме <code>custom</code>.
Следующие значения разрешены:</p>

<ul><li><p><code>with_runtimes_in_95th_percentile</code>:
Используйте <a href="#sys-statements-with-runtimes-in-95th-percentile">
<code>statements_with_runtimes_in_95th_percentile</code></a>.</li>

<li><code>analysis</code>: Используйте
<a href="#sys-statement-analysis"><code>statement_analysis</code></a>.
</li>

<li><code>with_errors_or_warnings</code>: Используйте
<a href="#sys-statements-with-errors-or-warnings">
<code>statements_with_errors_or_warnings</code></a>.</li>

<li><code>with_full_table_scans</code>: Используйте
<a href="#sys-statements-with-full-table-scans">
<code>statements_with_full_table_scans</code></a>.</li>

<li><code>with_sorting</code>: Используйте
<a href="#sys-statements-with-sorting">
<code>statements_with_sorting</code></a>.</li>

<li><code>with_temp_tables</code>: Используйте
<a href="#sys-statements-with-temp-tables">
<code>statements_with_temp_tables</code></a>.</li>

<li><code>custom</code>: Используйте представление custom.
Это представление должно быть определено, используя опцию конфигурации
<code>statement_performance_analyzer.view</code>, чтобы
назвать запрос или существующее представление.</p></li></ul></li></ul>

<h5><a name="idm139965280986464"></a>Опции</h5>
<p>Работа <a href="#sys-statement-performance-analyzer"><code>
statement_performance_analyzer()</code></a> может быть изменена, используя
следующие параметры конфигурации или их соответствующие определяемые
пользователем переменные (см. <a href="#sys-sys-config">раздел
24.4.2.1</a>):</p>

<ul><li><p><code>debug</code>, <code>@sys.debug</code>.</p>
<p>Если эта опция <code>ON</code>, произвести вывод отладки.
Значение по умолчанию <code>OFF</code>.</li>

<li><code>statement_performance_analyzer.limit</code>,
<code>@sys.statement_performance_analyzer.limit</code>.</p>
<p>Максимальное количество строк, чтобы возвратить для представлений, у
которых нет никакого встроенного предела. Значение по умолчанию 100.</li>

<li><code>statement_performance_analyzer.view</code>,
<code>@sys.statement_performance_analyzer.view</code>.</p>
<p>Пользовательский запрос или представление, которое будет использоваться.
Если значение опции содержит пробел, оно интерпретируется как запрос. Иначе
это должно быть название существующего представления, которое запрашивает
таблицу Performance Schema <a href="perfor.htm#statement-summary-tables">
<code>events_statements_summary_by_digest</code></a>.
Не может быть никакого <code>LIMIT</code> в запросе или определение
представления, если параметр конфигурации
<code>statement_performance_analyzer.limit</code> больше 0. Определяя
представление, используйте тот же самый формат, что касается
<code>in_table</code>. Значение по умолчанию <code>NULL</code> (никакого
пользовательского определенного представления).</p></li></ul>

<h5><a name="idm139965280968832"></a>Пример</h5>
<p>Создать отчет с запросами в 95th percentile, начиная с последнего усечения
<a href="perfor.htm#statement-summary-tables"><code>
events_statements_summary_by_digest</code></a>
с одноминутным периодом дельты:</p>

<ol type="1"><li><p>Составьте временную таблицу, чтобы
сохранить начальный снимок.</li>
<li>Создайте начальный снимок.</li>
<li>Сохраните начальный снимок во временной таблице.</li>

<li>Ждите одну минуту.</li>
<li>Создайте новый снимок.</li>
<li>Выполните анализ, основанный на новом снимке.</li>
<li>Выполните анализ, основанный на дельте между
начальным и новым снимками.</p></li></ol>

<pre>
mysql&gt; CALL statement_performance_analyzer('create_tmp',
               'mydb.tmp_digests_ini', NULL);
Query OK, 0 rows affected (0.08 sec)

mysql&gt; CALL statement_performance_analyzer('snapshot', NULL, NULL);
Query OK, 0 rows affected (0.02 sec)

mysql&gt; CALL statement_performance_analyzer('save', 'mydb.tmp_digests_ini',
               NULL);
Query OK, 0 rows affected (0.00 sec)

mysql&gt; DO SLEEP(60);
Query OK, 0 rows affected (1 min 0.00 sec)

mysql&gt; CALL statement_performance_analyzer('snapshot', NULL, NULL);
Query OK, 0 rows affected (0.02 sec)

mysql&gt; CALL statement_performance_analyzer('overall', NULL,
               'with_runtimes_in_95th_percentile');
+-----------------------------------------+
| Next Output                             |
+-----------------------------------------+
| Queries with Runtime in 95th Percentile |
+-----------------------------------------+
1 row in set (0.05 sec)
...

mysql&gt; CALL statement_performance_analyzer('delta', 'mydb.tmp_digests_ini', 'with_runtimes_in_95th_percentile');
+-----------------------------------------+
| Next Output                             |
+-----------------------------------------+
| Queries with Runtime in 95th Percentile |
+-----------------------------------------+
1 row in set (0.03 sec)
...
</pre>

Создайте полное сообщение о запросах 95th percentile и
10 лучших запросах с полным сканированием таблицы:
<pre>
mysql&gt; CALL statement_performance_analyzer('snapshot', NULL, NULL);
Query OK, 0 rows affected (0.01 sec)

mysql&gt; SET @sys.statement_performance_analyzer.limit = 10;
Query OK, 0 rows affected (0.00 sec)

mysql&gt; CALL statement_performance_analyzer('overall', NULL,
               'with_runtimes_in_95th_percentile,with_full_table_scans');
+-----------------------------------------+
| Next Output                             |
+-----------------------------------------+
| Queries with Runtime in 95th Percentile |
+-----------------------------------------+
1 row in set (0.01 sec)
...
+-------------------------------------+
| Next Output                         |
+-------------------------------------+
| Top 10 Queries with Full Table Scan |
+-------------------------------------+
1 row in set (0.09 sec)
...
</pre>

Используйте пользовательское представление, показывая лучшие 10 запросов,
сортированных полным временем выполнения, освежая представление каждую
минуту, используя команду <span><strong>watch</strong></span> в Linux:
<pre>
mysql&gt; CREATE OR REPLACE VIEW mydb.my_statements AS
    -&gt; SELECT sys.format_statement(DIGEST_TEXT) AS query,
    -&gt;        SCHEMA_NAME AS db, COUNT_STAR AS exec_count,
    -&gt;        sys.format_time(SUM_TIMER_WAIT) AS total_latency,
    -&gt;        sys.format_time(AVG_TIMER_WAIT) AS avg_latency,
    -&gt;        ROUND(IFNULL(SUM_ROWS_SENT / NULLIF(COUNT_STAR, 0), 0)) AS
    -&gt;        rows_sent_avg,
    -&gt;        ROUND(IFNULL(SUM_ROWS_EXAMINED / NULLIF(COUNT_STAR, 0), 0))
    -&gt;        AS rows_examined_avg,
    -&gt;        ROUND(IFNULL(SUM_ROWS_AFFECTED / NULLIF(COUNT_STAR, 0), 0))
    -&gt;        AS rows_affected_avg, DIGEST AS digest
    -&gt;        FROM performance_schema.events_statements_summary_by_digest
    -&gt;        ORDER BY SUM_TIMER_WAIT DESC;
Query OK, 0 rows affected (0.01 sec)

mysql&gt; CALL statement_performance_analyzer('create_table',
               'mydb.digests_prev', NULL);
Query OK, 0 rows affected (0.10 sec)

shell&gt; watch -n 60 "mysql sys --table -e \"
     &gt; SET @sys.statement_performance_analyzer.view = 'mydb.my_statements';
     &gt; SET @sys.statement_performance_analyzer.limit = 10;
     &gt; CALL statement_performance_analyzer('snapshot', NULL, NULL);
     &gt; CALL statement_performance_analyzer('delta', 'mydb.digests_prev', 'custom');
     &gt; CALL statement_performance_analyzer('save', 'mydb.digests_prev', NULL);
     &gt; \""

Every 60.0s: mysql sys --table -e "...  Mon Dec 22 10:58:51 2014
+----------------------------------+
| Next Output                      |
+----------------------------------+
| Top 10 Queries Using Custom View |
+----------------------------------+
+-------+----+------------+---------------+-------------+---------------+-------------------+-------------------+--------+
| query | db | exec_count | total_latency | avg_latency | rows_sent_avg | rows_examined_avg | rows_affected_avg | digest |
+-------+----+------------+---------------+-------------+---------------+-------------------+-------------------+--------+
...
</pre>

<h4><a name="sys-table-exists"></a>24.4.4.26.
Процедура table_exists()</h4>
<p>Тестирует, существует ли данная таблица как регулярная,
<code>TEMPORARY</code> или представление. Процедура возвращает тип таблицы
в параметре <code>OUT</code>. Если временная и постоянная таблицы существуют
с этим именем, вернется <code>TEMPORARY</code>.</p>

<h5><a name="idm139965280922880"></a>Параметры</h5>
<ul><li><p><code>in_db VARCHAR(64)</code>: Название базы данных, в которой
можно проверить существование таблицы.</li>

<li><code>in_table VARCHAR(64)</code>: Название таблицы, чтобы проверить.
</li>
<li>
<code>out_exists ENUM('', 'BASE TABLE', 'VIEW', 'TEMPORARY')</code>:
Возвращаемое значение. Это параметр <code>OUT</code>, таким образом, это
должна быть переменная, в которую может быть сохранен табличный тип. Когда
процедура возвращается, у переменной есть одно из следующих значений,
чтобы указать, существует ли таблица:</p>

<ul><li><p><code>''</code>: Имя таблицы не существует как базовая таблица,
<code>TEMPORARY</code> или представление.</li>
<li><code>BASE TABLE</code>: Имя таблицы существует как
основная (постоянная) таблица.</li>

<li><code>VIEW</code>: Имя таблицы существует как представление.</li>
<li><code>TEMPORARY</code>: Имя таблицы существует как таблица
a <code>TEMPORARY</code>.</p></li></ul></li></ul>

<h5><a name="idm139965280908224"></a>Пример</h5>
<pre>
mysql&gt; CREATE DATABASE db1;
Query OK, 1 row affected (0.01 sec)

mysql&gt; USE db1;
Database changed
mysql&gt; CREATE TABLE t1 (id INT PRIMARY KEY);
Query OK, 0 rows affected (0.03 sec)

mysql&gt; CREATE TABLE t2 (id INT PRIMARY KEY);
Query OK, 0 rows affected (0.20 sec)

mysql&gt; CREATE view v_t1 AS SELECT * FROM t1;
Query OK, 0 rows affected (0.02 sec)

mysql&gt; CREATE TEMPORARY TABLE t1 (id INT PRIMARY KEY);
Query OK, 0 rows affected (0.00 sec)

mysql&gt; CALL sys.table_exists('db1', 't1', @exists); SELECT @exists;
Query OK, 0 rows affected (0.01 sec)
+-----------+
| @exists   |
+-----------+
| TEMPORARY |
+-----------+
1 row in set (0.00 sec)

mysql&gt; CALL sys.table_exists('db1', 't2', @exists); SELECT @exists;
Query OK, 0 rows affected (0.02 sec)
+------------+
| @exists    |
+------------+
| BASE TABLE |
+------------+
1 row in set (0.00 sec)

mysql&gt; CALL sys.table_exists('db1', 'v_t1', @exists); SELECT @exists;
Query OK, 0 rows affected (0.02 sec)

+---------+
| @exists |
+---------+
| VIEW    |
+---------+
1 row in set (0.00 sec)

mysql&gt; CALL sys.table_exists('db1', 't3', @exists); SELECT @exists;
Query OK, 0 rows affected (0.00 sec)
+---------+
| @exists |
+---------+
|         |
+---------+
1 row in set (0.00 sec)
</pre>

<h3><a name="sys-schema-functions"></a>24.4.5.
Хранимые функции sys Schema</h3>
<p>Следующие разделы описывают хранимые функции
<a href="sys.htm"><code>sys</code></a> schema.</p>

<h4><a name="sys-extract-schema-from-file-name"></a>24.4.5.1.
Функция extract_schema_from_file_name()</h4>
<p>Учитывая имя пути к файлу, возвращает компонент пути, который представляет
имя схемы. Эта функция предполагает, что имя файла находится в пределах
каталога схемы. Поэтому это не будет работать с разделением или таблицей,
определенной с использованием собственной табличной
опции <code>DATA_DIRECTORY</code>.

<p>Эта функция полезна, извлекая информацию о вводе/выводе файла из
Performance Schema, которая включает имена пути к файлу. Это обеспечивает
удобный способ вывести на экран имена схемы, которые могут быть более легко
поняты чем полные пути и могут использоваться в соединениях для
имен схемы объекта.</p>

<h5><a name="idm139965280888544"></a>Параметры</h5>
<ul><li><p><code>path VARCHAR(512)</code>: Весь путь к файлу с данными, из
которого можно извлечь имя схемы.</p></li></ul>

<h5><a name="idm139965280885904"></a>Возвращаемое значение</h5>
<p><code>VARCHAR(64)</code>.</p>
<h5><a name="idm139965280884080"></a>Пример</h5>
<pre>
mysql&gt; SELECT extract_schema_from_file_name('/usr/local/mysql/data/world/City.ibd');
+-----------------------------------------------------------------------+
| extract_schema_from_file_name('/usr/local/mysql/data/world/City.ibd') |
+-----------------------------------------------------------------------+
| world                                                                 |
+-----------------------------------------------------------------------+
</pre>

<h4><a name="sys-extract-table-from-file-name"></a>24.4.5.2.
Функция extract_table_from_file_name()</h4>
<p>Учитывая имя пути к файлу, возвращает компонент пути, который
представляет имя таблицы.</p>

<p>Эта функция полезна, извлекая информацию о вводе/выводе файла из
Performance Schema, которая включает имена пути к файлу. Это обеспечивает
удобный способ вывести на экран имена таблиц, которые могут быть более легко
поняты чем полные пути, и могут использоваться в соединениях для
имен таблиц объекта.</p>

<h5><a name="idm139965280874608"></a>Параметры</h5>
<ul><li><p><code>path VARCHAR(512)</code>: Весь путь к файлу с данными,
из которого можно извлечь имя таблицы.</p></li></ul>

<h5><a name="idm139965280871968"></a>Возвращаемое значение</h5>
<p><code>VARCHAR(64)</code>.</p>
<h5><a name="idm139965280870144"></a>Пример</h5>
<pre>
mysql&gt; SELECT extract_table_from_file_name('/usr/local/mysql/data/world/City.ibd');
+----------------------------------------------------------------------+
| extract_table_from_file_name('/usr/local/mysql/data/world/City.ibd') |
+----------------------------------------------------------------------+
| City                                                                 |
+----------------------------------------------------------------------+
</pre>

<h4><a name="sys-format-bytes"></a>24.4.5.3. Функция format_bytes()</h4>
<p>Учитывая значение в байтах, конвертирует это к удобочитаемому формату и
возвращает строку, состоящую из значения и индикатора модулей. В зависимости
от размера значения, части модулей: <code>bytes</code>, <code>KiB</code>
(kibibytes), <code>MiB</code> (mebibytes),
<code>GiB</code> (gibibytes), <code>TiB</code>
(tebibytes) или <code>PiB</code> (pebibytes).</p>

<h5><a name="idm139965280858512"></a>Параметры</h5>
<ul><li><p><code>bytes TEXT</code>: Значение байтов для формата.
</p></li></ul>

<h5><a name="idm139965280855920"></a>Возвращаемое значение</h5>
<p><code>TEXT</code>.</p>
<h5><a name="idm139965280854096"></a>Пример</h5>
<pre>
mysql&gt; SELECT format_bytes(512), format_bytes(18446644073709551615);
+-------------------+------------------------------------+
| format_bytes(512) | format_bytes(18446644073709551615) |
+-------------------+------------------------------------+
| 512 bytes         | 16383.91 PiB                       |
+-------------------+------------------------------------+
</pre>

<h4><a name="sys-format-path"></a>24.4.5.4. Функция format_path()</h4>
<p>Учитывая путь, возвращает измененный путь после замены подпутей, которые
соответствуют значениям следующих системных переменных в этом порядке:
<pre>
datadir
tmpdir
slave_load_tmpdir
innodb_data_home_dir
innodb_log_group_home_dir
innodb_undo_directory
basedir
</pre>

Значение, которое соответствует значению системной переменной
<em><code>sysvar</code></em> заменено строкой
<code>@@global.<em><code>sysvar</code></em></code>.</p>

<h5><a name="idm139965280844144"></a>Параметры</h5>
<ul><li><p><code>path VARCHAR(512)</code>: Путь, чтобы отформатировать.
</p></li></ul>

<h5><a name="idm139965280841552"></a>Возвращаемое значение</h5>
<p><code>VARCHAR(512) CHARACTER SET utf8</code>.</p>
<h5><a name="idm139965280839712"></a>Пример</h5>
<pre>
mysql&gt; SELECT format_path('/usr/local/mysql/data/world/City.ibd');
+-----------------------------------------------------+
| format_path('/usr/local/mysql/data/world/City.ibd') |
+-----------------------------------------------------+
| @@datadir/world/City.ibd                            |
+-----------------------------------------------------+
</pre>

<h4><a name="sys-format-statement"></a>24.4.5.5. Функция format_statement()
</h4>
<p>Учитывая строку (обычно представляющей запрос SQL), уменьшает это до
длины, данной параметром конфигурации <code>statement_truncate_len</code>,
и возвращает результат. Никакое усечение не происходит, если строка короче
<code>statement_truncate_len</code>. Иначе средняя часть строки заменена
многоточием (<code>...</code>).</p>

<p>Эта функция полезна для форматирования возможно длинных запросов,
полученных из таблиц Performance Schema до известной
установленной максимальной длины.</p>

<h5><a name="idm139965280829616"></a>Параметры</h5>
<ul><li><p><code>statement LONGTEXT</code>: запрос для форматирования.
</p></li></ul>

<h5><a name="idm139965280827024"></a>Опции</h5>
<p><a href="#sys-format-statement"><code>format_statement()</code></a>
может быть изменена, используя следующие параметры конфигурации или их
соответствующие определяемые пользователем переменные (см.
<a href="#sys-sys-config">раздел 24.4.2.1</a>):</p>

<ul><li><p><code>statement_truncate_len</code>,
<code>@sys.statement_truncate_len</code>.</p>
<p>Максимальная длина запросов, возвращенных функцией
<a href="#sys-format-statement"><code>format_statement()</code></a>.
Более длинные запросы усечены к этой длине. Значение по умолчанию 64.
</p></li></ul>

<h5><a name="idm139965280819536"></a>Возвращаемое значение</h5>
<p><code>LONGTEXT</code>.</p>
<h5><a name="idm139965280817712"></a>Пример</h5>
<p>По умолчанию <a href="#sys-format-statement"><code>
format_statement()</code></a> усекает запросы, чтобы они были не больше 64
символов. Установка <code>@sys.statement_truncate_len</code>
изменяет длину усечения для текущего сеанса:
<pre>
mysql&gt; SET @stmt = 'SELECT variable, value, set_time, set_by
                       FROM sys_config';
mysql&gt; SELECT format_statement(@stmt);
+----------------------------------------------------------+
| format_statement(@stmt)                                  |
+----------------------------------------------------------+
| SELECT variable, value, set_time, set_by FROM sys_config |
+----------------------------------------------------------+
mysql&gt; SET @sys.statement_truncate_len = 32;
mysql&gt; SELECT format_statement(@stmt);
+-----------------------------------+
| format_statement(@stmt)           |
+-----------------------------------+
| SELECT variabl ... ROM sys_config |
+-----------------------------------+
</pre>

<h4><a name="sys-format-time"></a>24.4.5.6. Функция format_time()</h4>
<p>Учитывая время ожидания Performance Schema или время ожидания в
пикосекундах, конвертирует это к удобочитаемому формату и возвращает строку,
состоящую из значения и индикатора модулей. В зависимости от размера
значения, часть модулей <code>ns</code> (nanoseconds), <code>us</code>
(microseconds), <code>ms</code> (milliseconds),
<code>s</code> (seconds), <code>m</code>
(minutes), <code>h</code> (hours), <code>d</code>
(days) или <code>w</code> (weeks).</p>

<h5><a name="idm139965280799536"></a>Параметры</h5>
<ul><li><p><code>picoseconds TEXT</code>: Пикосекунды для форматирования.
</p></li></ul>

<h5><a name="idm139965280796928"></a>Возвращаемое значение</h5>
<p><code>TEXT</code>.</p>
<h5><a name="idm139965280795104"></a>Пример</h5>
<pre>
mysql&gt; SELECT format_time(3501), format_time(188732396662000);
+-------------------+------------------------------+
| format_time(3501) | format_time(188732396662000) |
+-------------------+------------------------------+
| 3.50 ns           | 3.15 m                       |
+-------------------+------------------------------+
</pre>

<h4><a name="sys-list-add"></a>24.4.5.7. Функция list_add()</h4>
<p>Добавляет значение к списку разделенных запятой
значений и возвращает результат.</p>

<p>Эта функция и <a href="#sys-list-drop"><code>list_drop()</code></a>
могут быть полезны для управления значением таких системных переменных, как
<a href="server.htm#sysvar_sql_mode"><code>sql_mode</code></a> и
<a href="server.htm#sysvar_optimizer_switch"><code>optimizer_switch</code>
</a>, которым нужен список разделенных запятой значений.</p>

<h5><a name="idm139965280783760"></a>Параметры</h5>
<ul><li><p><code>in_list TEXT</code>: Список, который будет изменен.</li>
<li><code>in_add_value TEXT</code>: Значение, чтобы добавить к списку.
</p></li></ul>

<h5><a name="idm139965280779648"></a>Возвращаемое значение</h5>
<p><code>TEXT</code>.</p>
<h5><a name="idm139965280777824"></a>Пример</h5>
<pre>
mysql&gt; SELECT @@sql_mode;
+----------------------------------------+
| @@sql_mode                             |
+----------------------------------------+
| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES |
+----------------------------------------+
mysql&gt; SET @@sql_mode = list_add(@@sql_mode, 'NO_ENGINE_SUBSTITUTION');
mysql&gt; SELECT @@sql_mode;
+---------------------------------------------------------------+
| @@sql_mode                                                    |
+---------------------------------------------------------------+
| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION |
+---------------------------------------------------------------+
mysql&gt; SET @@sql_mode = list_drop(@@sql_mode, 'ONLY_FULL_GROUP_BY');
mysql&gt; SELECT @@sql_mode;
+--------------------------------------------+
| @@sql_mode                                 |
+--------------------------------------------+
| STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION |
+--------------------------------------------+
</pre>

<h4><a name="sys-list-drop"></a>24.4.5.8. Функция list_drop()</h4>
<p>Удаляет значение из списка разделенных запятой значений
и возвращает результат. Для получения дополнительной информации см. описание
<a href="#sys-list-add"><code>list_add()</code></a>.</p>

<h5><a name="idm139965280765456"></a>Параметры</h5>
<ul><li><p><code>in_list TEXT</code>: Список, который будет изменен.</li>
<li><code>in_drop_value TEXT</code>: Значение, чтобы удалить из списка.
</p></li></ul>
<h5><a name="idm139965280761344"></a>Возвращаемое значение</h5>
<p><code>TEXT</code>.</p>

<h4><a name="sys-ps-is-account-enabled"></a>24.4.5.9.
Функция ps_is_account_enabled()</h4>
<p>Возвращает <code>YES</code> или <code>NO</code>, чтобы
указать, включена ли инструментовка Performance Schema для
указанной учетной записи.</p>

<h5><a name="idm139965280753344"></a>Параметры</h5>
<ul><li><p><code>in_host VARCHAR(60)</code>: Имя хоста учетной записи.</li>
<li><code>in_user VARCHAR(32)</code>: Имя пользователя учетной записи.
</p></li></ul>

<h5><a name="idm139965280749200"></a>Возвращаемое значение</h5>
<p><code>ENUM('YES','NO')</code>.</p>
<h5><a name="idm139965280747376"></a>Пример</h5>
<pre>
mysql&gt; SELECT ps_is_account_enabled('localhost', 'root');
+--------------------------------------------+
| ps_is_account_enabled('localhost', 'root') |
+--------------------------------------------+
| YES                                        |
+--------------------------------------------+
</pre>

<h4><a name="sys-ps-is-consumer-enabled"></a>24.4.5.10.
Функция ps_is_consumer_enabled()</h4>
<p>Возвращает <code>YES</code> или <code>NO</code>, чтобы указать, включен
ли данный потребитель Performance Schema, или <code>NULL</code>,
если параметр не допустимое потребительское имя.</p>

<p>Эта функция составляет потребительскую иерархию, таким образом,
потребителя не считают включенным, если все потребители, от которых он
зависит, также не включены. Для информации о потребительской иерархии см.
<a href="perfor.htm#performance-schema-consumer-filtering">раздел 23.2.3.7
</a>.</p>

<h5><a name="idm139965280736688"></a>Параметры</h5>
<ul><li><p><code>in_consumer VARCHAR(64)</code>:
Имя потребителя, чтобы проверить.</p></li></ul>

<h5><a name="idm139965280734080"></a>Возвращаемое значение</h5>
<p><code>ENUM('YES','NO')</code>.</p>
<h5><a name="idm139965280732256"></a>Пример</h5>
<pre>
mysql&gt; SELECT ps_is_consumer_enabled('thread_instrumentation');
+--------------------------------------------------+
| ps_is_consumer_enabled('thread_instrumentation') |
+--------------------------------------------------+
| YES                                              |
+--------------------------------------------------+
</pre>

<h4><a name="sys-ps-is-instrument-default-enabled"></a>24.4.5.11.
The ps_is_instrument_default_enabled()</h4>
<p>Возвращает <code>YES</code> или <code>NO</code>, чтобы
указать, включен ли данный инструмент Performance Schema по умолчанию.</p>

<h5><a name="idm139965280723632"></a>Параметры</h5>
<ul><li><p><code>in_instrument VARCHAR(128)</code>:
Название инструмента, чтобы проверить.</p></li></ul>

<h5><a name="idm139965280721056"></a>Возвращаемое значение</h5>
<p><code>ENUM('YES','NO')</code>.</p>
<h5><a name="idm139965280719232"></a>Пример</h5>
<pre>
mysql&gt; SELECT ps_is_instrument_default_enabled('memory/innodb/row_log_buf');
+---------------------------------------------------------------+
| ps_is_instrument_default_enabled('memory/innodb/row_log_buf') |
+---------------------------------------------------------------+
| NO                                                            |
+---------------------------------------------------------------+
mysql&gt; SELECT ps_is_instrument_default_enabled('statement/sql/alter_user');
+--------------------------------------------------------------+
| ps_is_instrument_default_enabled('statement/sql/alter_user') |
+--------------------------------------------------------------+
| YES                                                          |
+--------------------------------------------------------------+
</pre>

<h4><a name="sys-ps-is-instrument-default-timed"></a>24.4.5.12.
Функция ps_is_instrument_default_timed()</h4>
<p>Возвращает <code>YES</code> или <code>NO</code>, чтобы указать, рассчитан
ли данный инструмент Performance Schema по умолчанию.</p>

<h5><a name="idm139965280709088"></a>Параметры</h5>
<ul><li><p><code>in_instrument VARCHAR(128)</code>:
Название инструмента, чтобы проверить.</p></li></ul>

<h5><a name="idm139965280706512"></a>Возвращаемое значение</h5>
<p><code>ENUM('YES','NO')</code>.</p>
<h5><a name="idm139965280704688"></a>Пример</h5>
<pre>
mysql&gt; SELECT ps_is_instrument_default_timed('memory/innodb/row_log_buf');
+-------------------------------------------------------------+
| ps_is_instrument_default_timed('memory/innodb/row_log_buf') |
+-------------------------------------------------------------+
| NO                                                          |
+-------------------------------------------------------------+
mysql&gt; SELECT ps_is_instrument_default_timed('statement/sql/alter_user');
+------------------------------------------------------------+
| ps_is_instrument_default_timed('statement/sql/alter_user') |
+------------------------------------------------------------+
| YES                                                        |
+------------------------------------------------------------+
</pre>

<h4><a name="sys-ps-is-thread-instrumented"></a>24.4.5.13.
Функция ps_is_thread_instrumented()</h4>
<p>Возвращает <code>YES</code> или <code>NO</code>, чтобы указать,
включена ли инструментовка Performance Schema для данного соединения,
<code>UNKNOWN</code>, если идентификатор неизвестен или <code>NULL</code>,
если ID <code>NULL</code>.</p>

<h5><a name="idm139965280692448"></a>Параметры</h5>
<ul><li><p><code>in_connection_id BIGINT UNSIGNED</code>: ID соединения. Это
ID из столбца <code>PROCESSLIST_ID</code> таблицы Performance Schema
<a href="perfor.htm#threads-table"><code>threads</code></a> или столбец
<code>Id</code> вывода <a href="sql.htm#show-processlist"><code>SHOW
PROCESSLIST</code></a>.</p></li></ul>

<h5><a name="idm139965280685856"></a>Возвращаемое значение</h5>
<p><code>ENUM('YES','NO','UNKNOWN')</code>.</p>
<h5><a name="idm139965280684016"></a>Пример</h5>
<pre>
mysql&gt; SELECT ps_is_thread_instrumented(43);
+-------------------------------+
| ps_is_thread_instrumented(43) |
+-------------------------------+
| UNKNOWN                       |
+-------------------------------+

mysql&gt; SELECT ps_is_thread_instrumented(CONNECTION_ID());
+--------------------------------------------+
| ps_is_thread_instrumented(CONNECTION_ID()) |
+--------------------------------------------+
| YES                                        |
+--------------------------------------------+
</pre>

<h4><a name="sys-ps-thread-account"></a>24.4.5.14. Функция ps_thread_account()
</h4>
<p>Учитывая ID потока Performance Schema, возвращает учетную запись
<code><em><code>user_name</code></em>@<em><code>host_name</code></em></code>,
связанную с этим потоком.</p>

<h5><a name="idm139965280674576"></a>Параметры</h5>
<ul><li><p><code>in_thread_id BIGINT UNSIGNED</code>: ID потока, для
которого нужно возвратить учетную запись. Значение должно соответствовать
столбцу <code>THREAD_ID</code> из строки таблицы Performance Schema
<a href="perfor.htm#threads-table"><code>threads</code></a>.</p></li></ul>

<h5><a name="idm139965280669888"></a>Возвращаемое значение</h5>
<p><code>TEXT</code>.</p>
<h5><a name="idm139965280668064"></a>Пример</h5>
<pre>
mysql&gt; SELECT ps_thread_account(ps_thread_id(CONNECTION_ID()));
+--------------------------------------------------+
| ps_thread_account(ps_thread_id(CONNECTION_ID())) |
+--------------------------------------------------+
| root@localhost                                   |
+--------------------------------------------------+
</pre>

<h4><a name="sys-ps-thread-id"></a>24.4.5.15. Функция ps_thread_id()</h4>
<p>Возвращает идентификатор потока Performance Schema для данного ID
соединения или ID потока для текущего соединения, если
идентификатор соединения <code>NULL</code>.</p>

<h5><a name="idm139965280660160"></a>Параметры</h5>
<ul><li><p><code>in_connection_id BIGINT UNSIGNED</code>: ID соединения, для
которого нужно возвратить идентификатор потока. Это идентификатор соединения
как в столбце <code>PROCESSLIST_ID</code> таблицы Performance Schema
<a href="perfor.htm#threads-table"><code>threads</code></a> или столбце
<code>Id</code> вывода <a href="sql.htm#show-processlist"><code>
SHOW PROCESSLIST</code></a>.</p></li></ul>

<h5><a name="idm139965280653520"></a>Возвращаемое значение</h5>
<p><code>BIGINT UNSIGNED</code>.</p>
<h5><a name="idm139965280651696"></a>Пример</h5>
<pre>
mysql&gt; SELECT ps_thread_id(260);
+-------------------+
| ps_thread_id(260) |
+-------------------+
| 285               |
+-------------------+
</pre>

<h4><a name="sys-ps-thread-stack"></a>24.4.5.16. Функция ps_thread_stack()
</h4>
<p>Возвращается отформатированный в JSON стек всех запросов, этапов и событий
в пределах Performance Schema для данного ID потока.</p>

<h5><a name="idm139965280644688"></a>Параметры</h5>
<ul><li><p><code>in_thread_id BIGINT</code>: ID потока, чтобы проследить.
Значение должно соответствовать столбцу <code>THREAD_ID</code> любой строки
таблицы Performance Schema <a href="perfor.htm#threads-table"><code>threads
</code></a>.</li>
<li><code>in_verbose BOOLEAN</code>: Включать ли информацию
<code>file:lineno</code> в событиях.</p></li></ul>

<h5><a name="idm139965280637792"></a>Возвращаемое значение</h5>
<p><code>LONGTEXT CHARACTER SET latin1</code>.</p>
<h5><a name="idm139965280635952"></a>Пример</h5>
<pre>
mysql&gt; SELECT ps_thread_stack(37, FALSE) AS thread_stack\G
*************************** 1. row ***************************
thread_stack: {"rankdir": "LR","nodesep": "0.10",
"stack_created": "2014-02-19 13:39:03", "mysql_version": "8.0.1-dmr-debug-log",
"mysql_user": "root@localhost","events": [{"nesting_event_id": "0",
"event_id": "10", "timer_wait": 256.35, "event_info": "sql/select",
"wait_info": "select @@version_comment limit 1\nerrors: 0\nwarnings: 0\nlock time:
...
</pre>

<h4><a name="sys-ps-thread-trx-info"></a>24.4.5.17. Функция
ps_thread_trx_info()</h4>
<p>Возвращает объект JSON, содержащий информацию о данном потоке. Информация
включает текущую транзакцию и запросы, которые это уже выполнило,
полученные из таблиц Performance Schema
<a href="perfor.htm#events-transactions-current-table"><code>
events_transactions_current</code></a> и
<a href="perfor.htm#events-statements-history-table"><code>
events_statements_history</code></a>. Потребителям для тех таблиц нужно
позволить получить полные данные в объекте JSON.</p>

<p>Если вывод превышает длину усечения (65535 по умолчанию), ошибочный объект
JSON будет возвращен:
<pre>
{ "error": "Trx info truncated: Row 6 was cut by GROUP_CONCAT()" }
</pre>
Подобные ошибочные объекты возвращены для других предупреждений,
и исключения подняты во время функционального выполнения.</p>

<h5><a name="idm139965280624048"></a>Параметры</h5>
<ul><li><p><code>in_thread_id BIGINT UNSIGNED</code>: ID потока, для которого
нужно возвратить информацию о транзакции. Значение должно соответствовать
столбцу <code>THREAD_ID</code> из некоторой строки таблицы Performance Schema
<a href="perfor.htm#threads-table"><code>threads</code></a>.</p></li></ul>

<h5><a name="idm139965280619360"></a>Опции</h5>
<p><a href="#sys-ps-thread-trx-info"><code>ps_thread_trx_info()</code>
</a> может быть изменена, используя следующие параметры конфигурации или их
соответствующие определяемые пользователем переменные (см.
<a href="#sys-sys-config">раздел 24.4.2.1</a>):</p>

<ul><li><p><code>ps_thread_trx_info.max_length</code>,
<code>@sys.ps_thread_trx_info.max_length</code>.</p>
<p>Максимальная продолжительность вывода. Значение по умолчанию 65535.
</p></li></ul>

<h5><a name="idm139965280613184"></a>Возвращаемое значение</h5>
<p><code>LONGTEXT</code>.</p>
<h5><a name="idm139965280611360"></a>Пример</h5>
<pre>
mysql&gt; SELECT ps_thread_trx_info(48)\G
*************************** 1. row ***************************
ps_thread_trx_info(48): [
  {
"time": "790.70 us",
"state": "COMMITTED",
"mode": "READ WRITE",
"autocommitted": "NO",
"gtid": "AUTOMATIC",
"isolation": "REPEATABLE READ",
"statements_executed": [
  {
"sql_text": "INSERT INTO info VALUES (1, \'foo\')",
"time": "471.02 us",
"schema": "trx",
"rows_examined": 0,
"rows_affected": 1,
"rows_sent": 0,
"tmp_tables": 0,
"tmp_disk_tables": 0,
"sort_rows": 0,
"sort_merge_passes": 0
  },
  {
"sql_text": "COMMIT",
"time": "254.42 us",
"schema": "trx",
"rows_examined": 0,
"rows_affected": 0,
"rows_sent": 0,
"tmp_tables": 0,
"tmp_disk_tables": 0,
"sort_rows": 0,
"sort_merge_passes": 0
  }
]
  },
  {
"time": "426.20 us",
"state": "COMMITTED",
"mode": "READ WRITE",
"autocommitted": "NO",
"gtid": "AUTOMATIC",
"isolation": "REPEATABLE READ",
"statements_executed": [
  {
"sql_text": "INSERT INTO info VALUES (2, \'bar\')",
"time": "107.33 us",
"schema": "trx",
"rows_examined": 0,
"rows_affected": 1,
"rows_sent": 0,
"tmp_tables": 0,
"tmp_disk_tables": 0,
"sort_rows": 0,
"sort_merge_passes": 0
  },
  {
"sql_text": "COMMIT",
"time": "213.23 us",
"schema": "trx",
"rows_examined": 0,
"rows_affected": 0,
"rows_sent": 0,
"tmp_tables": 0,
"tmp_disk_tables": 0,
"sort_rows": 0,
"sort_merge_passes": 0
  }
]
  }
]
</pre>

<h4><a name="sys-quote-identifier"></a>24.4.5.18. Функция quote_identifier()
</h4>
<p>Учитывая строковый параметр, эта функция производит заключенный в кавычки
идентификатор, подходящий для включения в запросы SQL. Это полезно, когда
значение, которое будет использоваться в качестве идентификатора, является
зарезервированным словом или содержит обратный апостроф (<code>`</code>).</p>

<h5><a name="idm139965280601936"></a>Параметры</h5>
<p><code>in_identifier TEXT</code>: Идентификатор, чтобы заключить в кавычки.
</p>

<h5><a name="idm139965280600112"></a>Возвращаемое значение</h5>
<p><code>TEXT</code>.</p>
<h5><a name="idm139965280598288"></a>Пример</h5>
<pre>
mysql&gt; SELECT quote_identifier('plain');
+---------------------------+
| quote_identifier('plain') |
+---------------------------+
| `plain`                   |
+---------------------------+

mysql&gt; SELECT quote_identifier('trick`ier');
+-------------------------------+
| quote_identifier('trick`ier') |
+-------------------------------+
| `trick``ier`                  |
+-------------------------------+

mysql&gt; SELECT quote_identifier('integer');
+-----------------------------+
| quote_identifier('integer') |
+-----------------------------+
| `integer`                   |
+-----------------------------+
</pre>

<h4><a name="sys-sys-get-config"></a>24.4.5.19. Функция
sys_get_config()</h4>
<p>Учитывая имя параметра конфигурации, возвращает значение опции из таблицы
<a href="#sys-sys-config"><code>sys_config</code></a> или обеспеченное
значение по умолчанию (которое может быть <code>NULL</code>), если опция
не существует в таблице.</p>

<p>Если <a href="#sys-sys-get-config"><code>sys_get_config()</code>
</a> возвращает значение по умолчанию, и это значение <code>NULL</code>,
ожидается, что вызывающий в состоянии обработать <code>NULL</code>
для данного параметра конфигурации.</p>

<p>В соответствии с соглашением, подпрограммы, которые вызывают
<a href="#sys-sys-get-config"><code>sys_get_config()</code></a>,
сначала проверят, существует ли соответствующая определяемая пользователем
переменная и она не <code>NULL</code>. Если так, подпрограмма использует
переменное значение, не читая таблицу <a href="#sys-sys-config"><code>
sys_config</code></a>. Если переменная не существует или <code>NULL</code>,
подпрограмма читает значение опции из таблицы и устанавливает определяемую
пользователем переменную в это значение. Для получения дополнительной
информации об отношениях между параметрами конфигурации и их соответствующими
определяемыми пользователем переменными см.
<a href="#sys-sys-config">раздел 24.4.2.1</a>.</p>

<p>Если Вы хотите проверить, был ли параметр конфигурации уже установлен, а
если нет, использовать возвращаемое значение
<code>sys_get_config()</code>, Вы можете использовать
<code>IFNULL(...)</code> (см. пример позже). Однако, это не должно быть
сделано в цикле (например, для каждой строки в наборе результатов), потому
что для повторных запросов, где назначение необходимо только в первой
итерации, используя <code>IFNULL(...)</code> как ожидают, будет значительно
медленнее чем использование блока <code>IF (...) THEN ... END IF;</code>
(см. пример позже).</p>

<h5><a name="idm139965280574704"></a>Параметры</h5>
<ul><li><p><code>in_variable_name VARCHAR(128)</code>:
Название параметра конфигурации, для которого нужно возвратить значение.</li>

<li><code>in_default_value VARCHAR(128)</code>: Значение по умолчанию, чтобы
возвратить, если параметр конфигурации не найден в таблице
<code>sys_config</code>.</p></li></ul>

<h5><a name="idm139965280569728"></a>Возвращаемое значение</h5>
<p><code>VARCHAR(128)</code>.</p>
<h5><a name="idm139965280567904"></a>Пример</h5>
<p>Получите значение конфигурации из таблицы
<a href="#sys-sys-config"><code>sys_config</code></a>, используя
128 как значение по умолчанию, если опция не присутствует в таблице:
<pre>
mysql&gt; SELECT sys.sys_get_config('statement_truncate_len', 128) AS Value;
+-------+
| Value |
+-------+
| 64    |
+-------+
</pre>

Проверьте, установлена ли опция, в противном случае назначьте результат
<code>IFNULL(...)</code> (использующий значение из таблицы
<a href="#sys-sys-config"><code>sys_config</code></a>):
<pre>
mysql&gt; SET @sys.statement_truncate_len =
    -&gt; IFNULL(@sys.statement_truncate_len,
    -&gt;    sys.sys_get_config('statement_truncate_len', 64));
</pre>

Пример блока <code>IF (...) THEN ... END IF;</code>:
Проверьте, установлена ли опция, в противном случае назначьте значение из
таблицы <a href="#sys-sys-config"><code>sys_config</code></a>:
<pre>
IF (@sys.statement_truncate_len IS NULL) THEN
   SET @sys.statement_truncate_len = sys.sys_get_config('statement_truncate_len', 64);
END IF;
</pre>

<h4><a name="sys-version-major"></a>24.4.5.20. Функция version_major()</h4>
<p>Эта функция возвращает главную версию сервера MySQL.</p>
<h5><a name="idm139965280550544"></a>Параметры</h5>
<p>Нет.</p>
<h5><a name="idm139965280549424"></a>Возвращаемое значение</h5>
<p><code>TINYINT UNSIGNED</code>.</p>

<h5><a name="idm139965280547600"></a>Пример</h5>
<pre>
mysql&gt; SELECT VERSION(), version_major();
+---------------------+-----------------+
| VERSION()           | version_major() |
+---------------------+-----------------+
| 8.0.1-dmr-debug-log | 8               |
+---------------------+-----------------+
</pre>

<h4><a name="sys-version-minor"></a>24.4.5.21. Функция version_minor()</h4>
<p>Эта функция возвращает младшую версию сервера MySQL.</p>
<h5><a name="idm139965280540560"></a>Параметры</h5>
<p>Нет.</p>
<h5><a name="idm139965280539440"></a>Возвращаемое значение</h5>
<p><code>TINYINT UNSIGNED</code>.</p>

<h5><a name="idm139965280537616"></a>Пример</h5>
<pre>
mysql&gt; SELECT VERSION(), version_minor();
+---------------------+-----------------+
| VERSION()           | version_minor() |
+---------------------+-----------------+
| 8.0.1-dmr-debug-log | 0               |
+---------------------+-----------------+
</pre>

<h4><a name="sys-version-patch"></a>24.4.5.22. Функция version_patch()</h4>
<p>Эта функция возвращает версию выпуска сервера MySQL.</p>
<h5><a name="idm139965280530560"></a>Параметры</h5>
<p>Нет.</p>
<h5><a name="idm139965280529440"></a>Возвращаемое значение</h5>
<p><code>TINYINT UNSIGNED</code>.</p>

<h5><a name="idm139965280527616"></a>Пример</h5>
<pre>
mysql&gt; SELECT VERSION(), version_patch();
+---------------------+-----------------+
| VERSION()           | version_patch() |
+---------------------+-----------------+
| 8.0.1-dmr-debug-log | 1               |
+---------------------+-----------------+
</pre>

</index></td><td width="20%">
<script type="text/javascript">
    var begun_auto_colors           = new Array();
    var begun_auto_fonts_size       = new Array();
    var begun_auto_pad              =       97517308;     // идентификатор площадки
    var begun_auto_limit            =              5;     // число объявлений выводимых на площадке
    var begun_auto_width            =            250;     // ширина блока объявлений
    begun_auto_colors[0]            =      '#0000CC';     // цвет ссылки объявлений
    begun_auto_colors[1]            =      '#000000';     // цвет текста объявления
    begun_auto_colors[2]            =      '#00CC00';     // цвет домена объявления
    begun_auto_colors[3]            =      '#FFFFFF';     // цвет фона блока объявлений
    begun_auto_fonts_size[0]        =          '9pt';     // р-мер шрифта ссылки объявлений
    begun_auto_fonts_size[1]        =          '9pt';     // р-мер шрифта текста объявления
    begun_auto_fonts_size[2]        =          '8pt';     // р-мер шрифта домена объявления
    begun_auto_fonts_size[3]        =          '8pt';     // р-мер шрифта заглушки
    var begun_block_type            =     'Vertical';     // тип блока
    var begun_rambler_type          =              1;     // цвет блока поиска Рамблер
    begun_koi8 = 1;
</script>
<script src="../../../autocontext.begun.ru/autocontext.js"
type="text/javascript"></script>
</td></tr></table>

<p><table><tr><td>
<form method="get" name="fform" onSubmit="fsearch(strf.value); return false;">
<input type="hidden" name="clid" value="39177">
<b>Поиск</b><table><tr>
<td><input type="text" name="strf" size="15" style="font-size: 9pt" /></td></tr>
<tr><td><font size="-1"><input type="radio" name="myradio" value="0"
checked id="at_site"/>
<label for="at_site">На сайте</label><br>
<input type="radio" name="myradio" value="1" id="at_ya">
<label for="at_ya">В Яндексе</label></font></td></tr>
<tr><td><input type="submit" value="Найти" style="font-size: 9pt"/></td></tr>
</table></form></td>
<td>&nbsp;</td><td><script language="JavaScript"
src="../../../b190.takru.com/in.php@id=199275">
</script></td></tr></table></p>

<p><center><table><tr><td><font size="+1"><B>Найди своих коллег!</B></font><BR>
<script language="javascript"
src="../../../rldp.lovemesweet.ru/banner/db.js.php@rows=01&cols=05&bg=33FF33&sex=0&afrom=18&ato=99&headgif=&sf=1&nwnd=1&pmin=0&cid=RU&tid=0&smu=0&tcl1=000000&tcl2=FF0000">
</script></td>

<td><iframe src="../../../www.linuxcenter.ru/trans/list.phtml@ref=121965&n=5&price=yes"
frameborder="0" vspace="0" hspace="0" width="300" height="350" marginwidth="0"
marginheight="0" scrolling="no"></iframe></td></tr></table></center></p>

<P><FONT SIZE=-1>Вы можете <A HREF="mailto:alexey.v.pautov@mail.ru">
направить письмо</A> администратору этой странички, Алексею Паутову.</FONT>
<A HREF="mailto:alexey.v.pautov@mail.ru"><IMG SRC="img/email.gif"
ALT="mailto:alexey.v.pautov@mail.ru" BORDER=0 valign="center" HEIGHT=35
WIDTH=105 ALIGN=ABSCENTER></A></P>

<script type="text/javascript" src="../../../bin-layer.ru/popup-686-1.js">
</script>

</body>
</html>
