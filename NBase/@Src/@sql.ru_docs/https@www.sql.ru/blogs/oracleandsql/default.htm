<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html lang="ru" xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru">
<head>
  <title>Oracle SQL / Sql.ru</title>
  <meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />
  <link rel="stylesheet" type="text/css" href="../../css/screen.css@v=1" media="screen" />

    <!--[if lte IE 6]>
            <link rel="stylesheet" type="text/css" href="../../css/ie.css" media="screen" />
            <![endif]-->
  <meta name="Description" content="Oracle SQL. Блоги на Sql.ru" />
  <script type="text/javascript">jQuery = false;</script>
  
<link rel="Alternate" type="application/rss+xml" title="Oracle SQL / Sql.ru" href="../blogrss.aspx@id=82" />

<style type="text/css">

    h2 {
        float:none !important;
    }

    li {
        list-style-type: none;
        margin: 0 0 0px 30px;
        padding: 0;
    }

</style>
<script src="../../../https@ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
     if (typeof jQuery == 'undefined')
     {
      document.write(unescape("%3Cscript src='../../js/jquery-1.4.4.min.js' type='text/javascript'%3E%3C/script%3E"));
     }
</script>
<script type="text/javascript" src="../../js/jquery.tagcloud.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
      $.fn.tagcloud.defaults = {
        size: {start: 14, end: 20, unit: "px"},
        color: {start: '#8eb4e7', end: '#396092'}
      }

      $("#tagcloud a").tagcloud();

    })

</script>

  <script type="text/javascript" src="../../js/utils.js"></script>
  <meta property="og:image" content="https://www.sql.ru/images/logofb.jpg"/>
	                                
 <!-- Google Analytics -->
 <script>
 window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
 ga('create', 'UA-265508-1', '../sql.ru');
 ga('send', 'pageview');
 </script>
 <script async src='../../../https@www.google-analytics.com/analytics.js'></script>
 <!-- End Google Analytics -->
</head>

<body>
  <div id="page-container">
    <div id="header">
      <div class="header-wrap">
        <div id="title">
          <a href="../../default.htm" title="На главную страницу">SQL.ru</a>
        </div>
		<!--begin case_isguest-->
        <div id="login">
          <form action="/forum/login.aspx" method="post">
            <span class="close" onclick="hideLoginWindow(); return false;">x</span>

            <div class="username">
              <label for="login-input">Логин:</label> <input type="text" name="login" id=
              "login-input" />
            </div>

            <div class="password">
              <label for="pass-input">Пароль:</label> <input type="password" name="password" id=
              "pass-input" />
            </div>
			
			<div style="text-align:left;">
				<input type="checkbox" name="cbremember" id="cbremember" checked="checked" />
				<label style="width:auto" for="cbremember">Запомнить меня</label>
			</div>

            <div class="submit">
              <input type="submit" value="Войти" />
            </div>

            <div class="links">
              <a href="../../forum/register.aspx">Регистрация</a> <a href="../../forum/remindpass.aspx">Забыли пароль?</a>
            </div>
          </form>
        </div>
		<span id="login-link" onclick="showLoginWindow(); return false">Вход на сайт</span>
		<!--end case_isguest-->
		
        <form action="/forum/afsearch.aspx" method="get" id="top-search" name="top-search">
          <div>
            <input type="text" name="s" id="search-query" value=" поиск" class="inactive"
            onfocus="tffocus(this)" onblur="tfblur(this)" /> <input type="submit" value="Найти" />
          </div>
        </form>

        <ul id="top-menu">
          <li class=""><a href="../../default.htm">Главная</a></li>

          <li class=""><a href="../../articles">Статьи</a></li>

          <li class=""><a href="../../forum">Форум</a></li>

          <li class="selected"><a href="../../blogs">Блоги</a></li>

          <li class=""><a href="../../books">Книги</a></li>

          <li class=""><a href="../../subscribe">Рассылка</a></li>

          <li class=""><a href="../../forum/job">Работа</a></li>

          <li class=""><a href="../../search">Поиск</a></li>

          <li class=""><a href="../../faq">FAQ</a></li>
        </ul><div id="top-advert"><!--banner.img--></div>
      </div>
    </div>

			<div id="middle" class="column-2">
				<div id="middle-wrap">
					<div id="side-1" class="side-blocks">
						<div class="wrap">

							<!-- блок "Основные темы" -->
							<div class="side-block art-themes">

                                

                                <h4>Блог</h4>
								<ul>
									<div><a href="../oracleandsql">Oracle SQL</a><div>
                                    <div>ORACLE SQL : необычные приемы, специальные функции , аналитический SQL, работа с xml</div>
                                    <li id="rss"><a href="../blogrss.aspx@id=82">RSS подписка</a></li>
								</ul>
                                <br />
                                <h4>Последние записи</h4>
                                <ul>
                                    
                                    <li><a href="../oracleandsql/2268">Платежи с нарастающим итогом решение задачи</a></li>
                                    
                                    <li><a href="../oracleandsql/2266">Представляю сообществу  свою книгу oracle sql</a></li>
                                    
                                    <li><a href="../oracleandsql/2263">уже МИЛЛИОН!!! 1 000 000!</a></li>
                                    
                                    <li><a href="../oracleandsql/2259">SERIALIZABLE режим</a></li>
                                    
                                    <li><a href="../oracleandsql/2258">Контекст сеанса</a></li>
                                    
                                    <li><a href="../oracleandsql/2257">Планировщик JOB заданий. Управление.</a></li>
                                    
                                    <li><a href="../oracleandsql/2256">Быстрая очистка таблиц и EXECUTE IMMEDIATE.</a></li>
                                    
                                    <li><a href="../oracleandsql/2255">Внешние таблицы External Table</a></li>
                                    
                                    <li><a href="../oracleandsql/2216">Sum по disitnct полю , в другой колонке</a></li>
                                    
                                    <li><a href="../oracleandsql/2213">Ретроспективные запросы и корзина ORACLE</a></li>
                                    
                                </ul>
                                <br />
                                <h4>Теги</h4>
                                <div id="tagcloud">
                                  
                                  <a href="../oracleandsql/tags/avg" rel="5">avg</a>
                                  
                                  <a href="../oracleandsql/tags/connect%20by" rel="5">connect by</a>
                                  
                                  <a href="../oracleandsql/tags/create%20table" rel="8">create table</a>
                                  
                                  <a href="../oracleandsql/tags/execute%20immediate" rel="4">execute immediate</a>
                                  
                                  <a href="../oracleandsql/tags/group%20by" rel="4">group by</a>
                                  
                                  <a href="../oracleandsql/tags/insert%20into" rel="7">insert into</a>
                                  
                                  <a href="../oracleandsql/tags/oracle" rel="12">oracle</a>
                                  
                                  <a href="../oracleandsql/tags/order%20by" rel="4">order by</a>
                                  
                                  <a href="../oracleandsql/tags/over" rel="5">over</a>
                                  
                                  <a href="../oracleandsql/tags/partition" rel="4">partition</a>
                                  
                                  <a href="../oracleandsql/tags/pl%20sql" rel="6">pl sql</a>
                                  
                                  <a href="../oracleandsql/tags/preceding" rel="5">preceding</a>
                                  
                                  <a href="../oracleandsql/tags/rows%20beetwen" rel="5">rows beetwen</a>
                                  
                                  <a href="../oracleandsql/tags/select" rel="11">select</a>
                                  
                                  <a href="../oracleandsql/tags/sql" rel="9">sql</a>
                                  
                                  <a href="../oracleandsql/tags/update" rel="3">update</a>
                                  
                                  <a href="../oracleandsql/tags/with" rel="3">with</a>
                                  
                                  <a href="../oracleandsql/tags/_25e4_25e8_25ed_25e0_25ec_25e8_25f7_25e5_25f1_25ea_25e8_25e9%20sql" rel="3">динамический sql</a>
                                  
                                  <a href="../oracleandsql/tags/_25f2_25ee_25f0_25e3_25ee_25e2_25e0_25ff%20_25f1_25e8_25f1_25f2_25e5_25ec_25e0" rel="3">торговая система</a>
                                  
                                  <a href="../oracleandsql/tags/_25f4_25e8_25ed_25e0_25ed_25f1_25ee_25e2_25fb_25e9%20_25f0_25fb_25ed_25ee_25ea" rel="3">финансовый рынок</a>
                                  
                                  
                                </div>
                                <h4>Информация</h4>
                                <ul>
                                    <li><a href="../judge/339/create-new-blog-on-sqlru">Завести свой блог</a></li>
                                    <li></li>
                                </ul>
							</div>
							<!-- конец блока "Основные темы" -->

						</div>
					</div>
					<div id="content-section">
						<div id="content-wrapper">
                            <h1>Oracle SQL</h1>
                            <h3></h3>
                            
							<div class="article short" id="b2268">
								<hr/>
								<div class="art_desc">
									<h2><a href="../oracleandsql/2268">Платежи с нарастающим итогом решение задачи</a></h2>
									<div style="margin:0 0 5px 0">Одна из студенток просила помочь с задачей , задача интересная, поэтому предлагаю вашему вниманию.<br /><br />  Необходимо вывести все месяцы текущего года, с указанием клиента и суммы его платежей, отдельной колонкой <br />  вывести сумму всех платежей клиента с начала года (нарастающий итог по клиенту с начала года). Если в каком-то <br />  месяце клиент не платил, вывести 0<br /><br /><br />я так решил<br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>create</span> <span style='color: #0000ff;'>table</span> pay1(userid number, dt <span style='color: #0000ff;'>date</span>, paysum number);
<span style='color: #0000ff;'>insert</span> <span style='color: #0000ff;'>into</span> pay1 <span style='color: #0000ff;'>values</span>(<span style='color: #00008b;'>1</span>, <span style='color: #800080;'>sysdate</span>-<span style='color: #00008b;'>10</span>, <span style='color: #00008b;'>22</span>);
<span style='color: #0000ff;'>insert</span> <span style='color: #0000ff;'>into</span> pay1 <span style='color: #0000ff;'>values</span>(<span style='color: #00008b;'>2</span>, <span style='color: #800080;'>sysdate</span>-<span style='color: #00008b;'>20</span>, <span style='color: #00008b;'>2</span>);
<span style='color: #0000ff;'>insert</span> <span style='color: #0000ff;'>into</span> pay1 <span style='color: #0000ff;'>values</span>(<span style='color: #00008b;'>2</span>, <span style='color: #800080;'>sysdate</span>-<span style='color: #00008b;'>90</span>, <span style='color: #00008b;'>72</span>);
<span style='color: #0000ff;'>insert</span> <span style='color: #0000ff;'>into</span> pay1 <span style='color: #0000ff;'>values</span>(<span style='color: #00008b;'>1</span>, <span style='color: #800080;'>sysdate</span>-<span style='color: #00008b;'>50</span>, <span style='color: #00008b;'>32</span>);
<span style='color: #0000ff;'>insert</span> <span style='color: #0000ff;'>into</span> pay1 <span style='color: #0000ff;'>values</span>(<span style='color: #00008b;'>1</span>, <span style='color: #800080;'>sysdate</span>-<span style='color: #00008b;'>50</span>, <span style='color: #00008b;'>90</span>);
<span style='color: #0000ff;'>insert</span> <span style='color: #0000ff;'>into</span> pay1 <span style='color: #0000ff;'>values</span>(<span style='color: #00008b;'>2</span>, <span style='color: #800080;'>sysdate</span>-<span style='color: #00008b;'>70</span>, <span style='color: #00008b;'>52</span>);
<span style='color: #0000ff;'>insert</span> <span style='color: #0000ff;'>into</span> pay1 <span style='color: #0000ff;'>values</span>(<span style='color: #00008b;'>1</span>, <span style='color: #800080;'>sysdate</span>-<span style='color: #00008b;'>50</span>, <span style='color: #00008b;'>92</span>);
<span style='color: #0000ff;'>insert</span> <span style='color: #0000ff;'>into</span> pay1 <span style='color: #0000ff;'>values</span>(<span style='color: #00008b;'>1</span>, <span style='color: #800080;'>sysdate</span>-<span style='color: #00008b;'>10</span>, <span style='color: #00008b;'>32</span>);
<span style='color: #0000ff;'>insert</span> <span style='color: #0000ff;'>into</span> pay1 <span style='color: #0000ff;'>values</span>(<span style='color: #00008b;'>1</span>, <span style='color: #800080;'>sysdate</span>-<span style='color: #00008b;'>90</span>, <span style='color: #00008b;'>90</span>);
<span style='color: #0000ff;'>insert</span> <span style='color: #0000ff;'>into</span> pay1 <span style='color: #0000ff;'>values</span>(<span style='color: #00008b;'>2</span>, <span style='color: #800080;'>sysdate</span>-<span style='color: #00008b;'>90</span>, <span style='color: #00008b;'>52</span>);
<span style='color: #0000ff;'>insert</span> <span style='color: #0000ff;'>into</span> pay1 <span style='color: #0000ff;'>values</span>(<span style='color: #00008b;'>1</span>, <span style='color: #800080;'>sysdate</span>-<span style='color: #00008b;'>150</span>, <span style='color: #00008b;'>92</span>);
<span style='color: #0000ff;'>insert</span> <span style='color: #0000ff;'>into</span> pay1 <span style='color: #0000ff;'>values</span>(<span style='color: #00008b;'>1</span>, <span style='color: #800080;'>sysdate</span>-<span style='color: #00008b;'>110</span>, <span style='color: #00008b;'>32</span>);
 
</pre>
<br /><br />Для нарастающего итога используется аналитическия функция SUM, с под запросом, нулевые значения создаем подзапросом с connect by level интервал дат задаем в конструкции connect by<br />в данном случае от 2019-05-01 до 2020-01-01<br /><br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>select</span> userid,mn,yy,passum , <span style='color: #0000ff;'>sum</span>(passum) <span style='color: #0000ff;'>over</span> (<span style='color: #0000ff;'>partition</span> <span style='color: #0000ff;'>by</span> userid <span style='color: #0000ff;'>order</span> <span style='color: #0000ff;'>by</span> yy,mn) <span style='color: #0000ff;'>from</span> ( 
    <span style='color: #0000ff;'>select</span> userid , <span style='color: #800080;'>extract</span>(<span style='color: #0000ff;'>month</span> <span style='color: #0000ff;'>from</span> dt) mn, <span style='color: #800080;'>extract</span>(<span style='color: #0000ff;'>year</span> <span style='color: #0000ff;'>from</span> dt) yy, <span style='color: #0000ff;'>sum</span>(pasum) passum <span style='color: #0000ff;'>from</span> (
    <span style='color: #0000ff;'>select</span> <span style='color: #800080;'>decode</span>( userid,<span style='color: #0000ff;'>null</span>, userid1, userid)  userid  , <span style='color: #800080;'>decode</span>(dt,<span style='color: #0000ff;'>null</span>,dt1,dt) dt , <span style='color: #800080;'>decode</span>(paysum,<span style='color: #0000ff;'>null</span>,<span style='color: #00008b;'>0</span>,paysum) pasum <span style='color: #0000ff;'>from</span> pay1
     right join
    (
        <span style='color: #0000ff;'>select</span> dt1,userid1 <span style='color: #0000ff;'>from</span>
        (
            (<span style='color: #0000ff;'>select</span> <span style='color: #0000ff;'>date</span><span style='color: #ff0000;'>'2019-05-01'</span>+<span style='color: #0000ff;'>level</span>-<span style='color: #00008b;'>1</span> <span style='color: #0000ff;'>as</span> dt1 <span style='color: #0000ff;'>from</span> dual <span style='color: #0000ff;'>connect</span> <span style='color: #0000ff;'>by</span> <span style='color: #0000ff;'>level</span> &lt;= <span style='color: #0000ff;'>date</span><span style='color: #ff0000;'>'2020-01-01'</span>-<span style='color: #0000ff;'>date</span><span style='color: #ff0000;'>'2019-05-01'</span>) dt
            cross join (<span style='color: #0000ff;'>select</span> <span style='color: #0000ff;'>distinct</span> userid userid1 <span style='color: #0000ff;'>from</span> pay1) pay
        )) payd 
    <span style='color: #0000ff;'>on</span> <span style='color: #800080;'>trunc</span>(dt) = <span style='color: #800080;'>trunc</span>(dt1) <span style='color: #0000ff;'>and</span> userid = userid1   
    ) mzt <span style='color: #0000ff;'>group</span> <span style='color: #0000ff;'>by</span> userid, <span style='color: #800080;'>extract</span>(<span style='color: #0000ff;'>month</span> <span style='color: #0000ff;'>from</span> dt), <span style='color: #800080;'>extract</span>(<span style='color: #0000ff;'>year</span> <span style='color: #0000ff;'>from</span> dt) <span style='color: #0000ff;'>order</span> <span style='color: #0000ff;'>by</span> yy,mn
    ) tt1
</pre>
</div>
                                    <div class="info">
                                        добавлено: 08&nbsp;дек&nbsp;19
                                        <span style="float:right">просмотры: 3299, комментарии: <a href="../oracleandsql/2268#add-comment">3</a></span>
                                        <br />
                                        <div id="tags"></div>
                                        <ul class="taglist">
                                        
                                            <li><a href="../oracleandsql/tags/connect%20by">connect by</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/cross%20join">cross join</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/join">join</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/dual">dual</a></li>
                                        
                                        
                                        </ul>
                                        <br />
    	                                

                                    </div>
								</div>
								<br clear="all" />
							</div>
							
							<div class="article short" id="b2266">
								<hr/>
								<div class="art_desc">
									<h2><a href="../oracleandsql/2266">Представляю сообществу  свою книгу oracle sql</a></h2>
									<div style="margin:0 0 5px 0">Попытался структурировать свои знания и опыт, получилось 600 страниц, прошу не быть строгими и критиковать аргументированно.<br />В электронном варианте книга бесплатна, 6 рублей - обязательная комиссия магазина, как я понял.<br /><a href="../../../https@www.ozon.ru/context/detail/id/154759045/default.htm" target="_blank">Oracle SQL. 100 шагов от новичка до профессионала. 20 дней новых знаний и практики</a><br />или печатная версия , но уже за деньги<br /><a href="../../../https@www.ozon.ru/context/detail/id/154784380/default.htm" target="_blank">Oracle SQL. 100 шагов от новичка до профессионала. 20 дней новых знаний и практики</a><br />Пользуйтесь.</div>
                                    <div class="info">
                                        добавлено: 20&nbsp;июл&nbsp;19
                                        <span style="float:right">просмотры: 6649, комментарии: <a href="../oracleandsql/2266#add-comment">15</a></span>
                                        <br />
                                        <div id="tags"></div>
                                        <ul class="taglist">
                                        
                                            <li><a href="../oracleandsql/tags/oracle">oracle</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/sql">sql</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/_25f3_25f7_25b8_25e1_25e0">учёба</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/_25f1_25ef_25f0_25e0_25e2_25ee_25f7_25ed_25e8_25ea">справочник</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/_25ca_25ed_25e8_25e3_25e0%20_25e4_25eb_25ff%20_25ef_25ee_25eb_25fc_25e7_25ee_25e2_25e0_25f2_25e5_25eb_25e5_25e9">Книга для пользователей</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/_25ca_25ed_25e8_25e3_25e0%20_25ed_25e0%20_25f0_25f3_25f1_25f1_25ea_25ee_25ec">Книга на русском</a></li>
                                        
                                        
                                        </ul>
                                        <br />
    	                                

                                    </div>
								</div>
								<br clear="all" />
							</div>
							
							<div class="article short" id="b2263">
								<hr/>
								<div class="art_desc">
									<h2><a href="../oracleandsql/2263">уже МИЛЛИОН!!! 1 000 000!</a></h2>
									<div style="margin:0 0 5px 0">Просмотров<br /><br />Сегодня	1718<br />В этом месяце	10530<br /><b>Всего	1000003</b><br /><br />Сегодня счетчик посещений моего блога превзошел миллион просмотров, что дальше ? Продолжаю вести курсы, публикую книгу , постараюсь и дальше радовать вас новыми интересными заметками, дорогие читатели.<br />С уважением, Чалышев Максим Михайлович.</div>
                                    <div class="info">
                                        добавлено: 14&nbsp;апр&nbsp;19
                                        <span style="float:right">просмотры: 6428, комментарии: <a href="../oracleandsql/2263#add-comment">5</a></span>
                                        <br />
                                        <div id="tags"></div>
                                        <ul class="taglist">
                                        
                                            <li><a href="../oracleandsql/tags/_25f7_25e0_25eb_25fb_25f8_25e5_25e2">чалышев</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/sql">sql</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/Excel">Excel</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/know%20how">know how</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/_25c1_25eb_25ee_25e3">Блог</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/_25f3_25f0_25ee_25ea_25e8">уроки</a></li>
                                        
                                        
                                        </ul>
                                        <br />
    	                                

                                    </div>
								</div>
								<br clear="all" />
							</div>
							
							<div class="article short" id="b2259">
								<hr/>
								<div class="art_desc">
									<h2><a href="../oracleandsql/2259">SERIALIZABLE режим</a></h2>
									<div style="margin:0 0 5px 0"><a href="../../../www.sqladv.ru/default.htm" target="_blank">Чалышев Максим Михайлович</a><br /><br />Моя книга, электронная версия бесплатно<br /><a href="../../../https@www.ozon.ru/context/detail/id/154759045/default.htm" target="_blank">Oracle SQL. 100 шагов от новичка до профессионала. 20 дней новых знаний и практики</a> или <a href="../../../https@www.ozon.ru/context/detail/id/154784380/default.htm" target="_blank">платная печатная версия</a><br /><br /><a href="../../../sql.orasource.ru/default.htm" target="_blank">SQL. 5 дней которые изменят вашу жизнь.</a> <br /><br />В СУБД ORACLE есть возможность, чтобы пользователь всегда видел только те данные в таблицах, которые были доступны с начала его сессии  <br />Такой режим (уровень изоляции) называется SERIALIZABLE. Для того чтобы включить этот режим используется команда <br /><br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>Alter</span> session <span style='color: #0000ff;'>set</span> isolation_level=<span style='color: #0000ff;'>serializable</span>;
</pre>
<br />Следующий пример показывает отличие режима SERIALIZABLE от стандартного режима эксплуатации СУБД. Уровня изоляции READ COMMITTED <br />Откроем в двух разных окнах программу SQL Developer (или создадим новый Worksheet) подключимся к схеме SYS как администратор. <br />создадим таблицу man5<br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>Create</span> <span style='color: #0000ff;'>table</span> Man5(prt number, <span style='color: #0000ff;'>name</span> varchar2(<span style='color: #00008b;'>50</span>));
</pre>
<br /><br /><br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>INSERT</span> <span style='color: #0000ff;'>INTO</span> man5 <span style='color: #0000ff;'>VALUES</span>(<span style='color: #00008b;'>20</span>, <span style='color: #ff0000;'>'Олег'</span>);
<span style='color: #0000ff;'>INSERT</span> <span style='color: #0000ff;'>INTO</span> man5 <span style='color: #0000ff;'>VALUES</span>(<span style='color: #00008b;'>21</span>, <span style='color: #ff0000;'>'Влад'</span>);
<span style='color: #0000ff;'>INSERT</span> <span style='color: #0000ff;'>INTO</span> man5 <span style='color: #0000ff;'>VALUES</span>(<span style='color: #00008b;'>22</span>, <span style='color: #ff0000;'>'Саша'</span>);
<span style='color: #0000ff;'>Commit</span>;
</pre>
<br /><br /><a href='../oracleandsql/2259'>читать дальше...</a></div>
                                    <div class="info">
                                        добавлено: 18&nbsp;фев&nbsp;19
                                        <span style="float:right">просмотры: 6234, комментарии: <a href="../oracleandsql/2259#add-comment">3</a></span>
                                        <br />
                                        <div id="tags"></div>
                                        <ul class="taglist">
                                        
                                            <li><a href="../oracleandsql/tags/serializable">serializable</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/sql">sql</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/insert%20into">insert into</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/create%20table">create table</a></li>
                                        
                                        
                                        </ul>
                                        <br />
    	                                

                                    </div>
								</div>
								<br clear="all" />
							</div>
							
							<div class="article short" id="b2258">
								<hr/>
								<div class="art_desc">
									<h2><a href="../oracleandsql/2258">Контекст сеанса</a></h2>
									<div style="margin:0 0 5px 0"><a href="../../../www.sqladv.ru/default.htm" target="_blank">Чалышев Максим Михайлович</a><br /><a href="../../../sql.orasource.ru/default.htm" target="_blank">SQL. 5 дней которые изменят твою жизнь.</a> <br /><br /><b>Введение</b><br />В каждой сессии есть возможность использовать специальные структуры данных, именуемые контекст.<br />Контексты - это набор данных вида - параметр значение. Контекст предоставляет дополнительные возможности для приложений, использующих СУБД Oracle.<br /><b>Теория и практика</b><br />Контекст - это предопределённый набор параметров и значений создаваемый в рамках определенной сессии. Несколько таких наборов параметр значение, объединяется с помощью структуры называемой контекстом.<br /><br />Задается значение контекста с помощью процедуры DBMS_SESSION.SET_CONTEXT<br /><br />Функция SYS_CONTEXT позволяет получить значение заданного контекста в раках сессии.<br />Для создания контекста специальная команда CREATE CONTEXT. <br />Сначала следует создать специальною процедуру для управления контекстом.<br /><br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>CREATE</span> <span style='color: #0000ff;'>OR</span> <span style='color: #0000ff;'>REPLACE</span> <span style='color: #0000ff;'>PROCEDURE</span> set_mycontext_value ( par <span style='color: #0000ff;'>IN</span> VARCHAR2, val <span style='color: #0000ff;'>IN</span> VARCHAR2 ) 
<span style='color: #0000ff;'>AS</span> <span style='color: #0000ff;'>BEGIN</span>  DBMS_SESSION.SET_CONTEXT ( <span style='color: #ff0000;'>'myctx'</span>, par, val ); <span style='color: #0000ff;'>END</span>;

<span style='color: #0000ff;'>CREATE</span> <span style='color: #0000ff;'>OR</span> <span style='color: #0000ff;'>REPLACE</span> <span style='color: #0000ff;'>CONTEXT</span> myctx <span style='color: #0000ff;'>USING</span> set_mycontext_value;
</pre>
<br /><a href='../oracleandsql/2258'>читать дальше...</a></div>
                                    <div class="info">
                                        добавлено: 18&nbsp;фев&nbsp;19
                                        <span style="float:right">просмотры: 6701, комментарии: <a href="../oracleandsql/2258#add-comment">0</a></span>
                                        <br />
                                        <div id="tags"></div>
                                        <ul class="taglist">
                                        
                                            <li><a href="../oracleandsql/tags/sys_context">sys_context</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/sql">sql</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/set_context">set_context</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/SQL%20Server">SQL Server</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/oracle">oracle</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/sql">sql</a></li>
                                        
                                        
                                        </ul>
                                        <br />
    	                                

                                    </div>
								</div>
								<br clear="all" />
							</div>
							
							<div class="article short" id="b2257">
								<hr/>
								<div class="art_desc">
									<h2><a href="../oracleandsql/2257">Планировщик JOB заданий. Управление.</a></h2>
									<div style="margin:0 0 5px 0"><a href="../../../www.sqladv.ru/default.htm" target="_blank">Чалышев Максим Михайлович</a><br /><br /><a href="../../../sql.orasource.ru/default.htm" target="_blank">SQL. 5 дней которые изменят твою жизнь.</a> <br />моя книга , изучаем Oracle SQL, бесплатно<br /><a href="../../../https@www.ozon.ru/context/detail/id/154759045/default.htm" target="_blank">Oracle SQL. 100 шагов от новичка до профессионала. 20 дней новых знаний и практики</a> или <a href="../../../https@www.ozon.ru/context/detail/id/154784380/default.htm" target="_blank">платная печатная версия</a><br /><br />Введение<br />В Oracle есть специальный механизм запланировать выполнение определённой программы, на заданное время, это может быть оператор SQL, программа на языке PLSQL, либо даже внешняя программа. Этот механизм называется механизмом заданий Job<br /><br />Данный механизм может применяться, например, для планирования запуска тяжелых запросов в ночное время или на выходные дни, распределения задач построения отчетности.<br /><br /><b>Теория и практика</b><br /><br />Для управления заданиями в Oracle существует специальные пакет DBMS_JOB:<br />Создание заданий <br />Можно использовать механизм dbms_job<br />Или механизм dbms_scheduler – более современный способ<br /><pre class="src lang-plsql">
DBMS_JOB.SUBMIT(
 JOB <span style='color: #0000ff;'>OUT</span> BINARY_INTEGER,
 WHAT <span style='color: #0000ff;'>IN</span> VARCHAR2,
 NEXT_DATE <span style='color: #0000ff;'>IN</span> <span style='color: #0000ff;'>DATE</span> <span style='color: #0000ff;'>DEFAULT</span> <span style='color: #800080;'>SYSDATE</span>,
 <span style='color: #0000ff;'>INTERVAL</span> <span style='color: #0000ff;'>IN</span> VARCHAR2 <span style='color: #0000ff;'>DEFAULT</span> <span style='color: #0000ff;'>NULL</span>,
 NO_PARSE <span style='color: #0000ff;'>IN</span> BOOLEAN <span style='color: #0000ff;'>DEFAULT</span> FALSE,
 INSTANCE <span style='color: #0000ff;'>IN</span> BINARY_INTEGER <span style='color: #0000ff;'>DEFAULT</span> any_instance,
 <span style='color: #0000ff;'>FORCE</span> <span style='color: #0000ff;'>IN</span> BOOLEAN <span style='color: #0000ff;'>DEFAULT</span> FALSE
);
</pre>
<br /><br />Здесь:<br />JOB – Входной параметр уникальный идентификатор задания. Идентификатор генерируется специальной системной последовательностью. <br />WHAT - анонимный PL/SQL блок, в данном блоке указывается последовательность команд которая будет выполнена в процессе работы задания.<br /> В же в этом параметре можно также писать команды вставки удаления редактирования (inser update delete), а так же команды для создания создания индексов таблиц, создания индексов, ограничений.<br />NEXT_DATE – дата время следующего выполнения задания. <br />Если будет указана дата меньше чем текущую дата, то выполнение задания будет начато немедленно. <br />INTERVAL – Вычисляемая дата следующего выполнения задания в столбце NEXT_DATE. Примеры интервала задания:<br />NULL<br />Задание выполнится однократно и удалится.<br /><a href='../oracleandsql/2257'>читать дальше...</a></div>
                                    <div class="info">
                                        добавлено: 18&nbsp;фев&nbsp;19
                                        <span style="float:right">просмотры: 10110, комментарии: <a href="../oracleandsql/2257#add-comment">2</a></span>
                                        <br />
                                        <div id="tags"></div>
                                        <ul class="taglist">
                                        
                                            <li><a href="../oracleandsql/tags/dbms_job.">dbms_job.</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/sql">sql</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/pl%20sql">pl sql</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/dbms_scheduler">dbms_scheduler</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/dbms_job.remove">dbms_job.remove</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/dba_jobs">dba_jobs</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/%20all_jobs"> all_jobs</a></li>
                                        
                                        
                                        </ul>
                                        <br />
    	                                

                                    </div>
								</div>
								<br clear="all" />
							</div>
							
							<div class="article short" id="b2256">
								<hr/>
								<div class="art_desc">
									<h2><a href="../oracleandsql/2256">Быстрая очистка таблиц и EXECUTE IMMEDIATE.</a></h2>
									<div style="margin:0 0 5px 0"><a href="../../../www.sqladv.ru/default.htm" target="_blank">Чалышев Максим Михайлович</a><br /><a href="../../../sql.orasource.ru/default.htm" target="_blank">SQL. 5 дней, которые изменят твою жизнь.</a> <br /><br /><b>Введение</b><br /><br /><br />Для быстрой очистки таблиц в Oracle применяется специальный оператор TRUNCATE TABLE.<br />Данный оператор является оператором DDL, оператором мгновенного выполнения и поэтому для его вызова нам потребуется оператор динамического SQL. <br />Динамический SQL используется в ORACLE с помощью команды EXECUTE IMMEDIATE <br /><b>Теория и практика</b><br />Оператор EXECUTE IMMEDIATE выполняет динамический оператор SQL или анонимный PL / SQL блок. В нашем случае мы будем использовать EXECUTE IMMEDIATE для работы с TRUNCATE TABLE.<br />Текст динамического SQL заключается в кавычки.<br />Оператор TRUNCATE TABLE используется для быстрого удаления всех записей из таблицы в Oracle. По результату аналогичен DELETE, без условий WHERE, но выполняется гораздо быстрее.<br />Синтаксис<br /><pre class="src lang-plsql">
TRUNCATE <span style='color: #0000ff;'>TABLE</span> table_name
  [ PRESERVE MATERIALIZED <span style='color: #0000ff;'>VIEW</span> <span style='color: #800080;'>LOG</span> | PURGE MATERIALIZED <span style='color: #0000ff;'>VIEW</span> <span style='color: #800080;'>LOG</span> ]
  [ <span style='color: #0000ff;'>DROP</span> STORAGE | REUSE STORAGE ] ;
</pre>
<br /><a href='../oracleandsql/2256'>читать дальше...</a></div>
                                    <div class="info">
                                        добавлено: 18&nbsp;фев&nbsp;19
                                        <span style="float:right">просмотры: 6566, комментарии: <a href="../oracleandsql/2256#add-comment">1</a></span>
                                        <br />
                                        <div id="tags"></div>
                                        <ul class="taglist">
                                        
                                            <li><a href="../oracleandsql/tags/sql">sql</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/truncate%20table">truncate table</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/delete">delete</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/sql">sql</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/truncate%20table">truncate table</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/delete">delete</a></li>
                                        
                                        
                                        </ul>
                                        <br />
    	                                

                                    </div>
								</div>
								<br clear="all" />
							</div>
							
							<div class="article short" id="b2255">
								<hr/>
								<div class="art_desc">
									<h2><a href="../oracleandsql/2255">Внешние таблицы External Table</a></h2>
									<div style="margin:0 0 5px 0"><a href="../../../www.sqladv.ru/default.htm" target="_blank">Чалышев Максим Михайлович</a><br /><a href="../../../sql.orasource.ru/default.htm" target="_blank">SQL. 5 дней, которые изменят вашу жизнь.</a> <br />Внешние таблицы – специальный механизм Oracle СУБД  с помощью которого можно  обращаться в данным , хранящимся в файлах вне базы данных как к обычным таблицам.<br /> <br />Для загрузки данных могут использоваться команды драйвера OracleLoader. В ExternalTable не могут применяться операторы изменения данных (DELETE INSERT UPDATE MERGE).<br /><br />Но, к таким таблицам вполне могут применяться стандартные запросы SELECT,  с использованием групповых операций, агрегатных функций, аналитического SQL.<br /><br />Все это делает механизм внешних таблиц особенно эффективным для проектов DWH(хранилищ данных) , при формировании ETL(процедур загрузки) для данных. <br /><br /><b>Теория и практика<br /></b><br />Предположим, у нас есть несколько файлов заданного формата, файлы расположены в каталоге temp на диске c:<br />Необходимо подключить эти файлы как внешние таблицы к экземпляру нашей базы данных.<br /><br />Название файлов city.csv и man.csv, кодировка UTF8 - ниже представлено содержание этих файлов текстовом виде.<br /><br />city.csv<br /><br /><pre class="src lang-plsql">
<span style='color: #00008b;'>1</span>,Москва,<span style='color: #00008b;'>10000000</span>
<span style='color: #00008b;'>2</span>,Владимир,<span style='color: #00008b;'>500000</span>
<span style='color: #00008b;'>3</span>,Орел,<span style='color: #00008b;'>300000</span>
<span style='color: #00008b;'>4</span>,Курск,<span style='color: #00008b;'>200000</span>
<span style='color: #00008b;'>5</span>,Казань,<span style='color: #00008b;'>2000000</span>
<span style='color: #00008b;'>7</span>,Котлас,<span style='color: #00008b;'>110000</span>
<span style='color: #00008b;'>8</span>,Мурманск,<span style='color: #00008b;'>400000</span>
<span style='color: #00008b;'>9</span>,Ярославль,<span style='color: #00008b;'>500000</span> 
</pre>
<br />man.csv<br /><pre class="src lang-plsql">
<span style='color: #00008b;'>9152222221</span>,Андрей,Николаев,<span style='color: #00008b;'>1</span>,<span style='color: #00008b;'>22</span>
<span style='color: #00008b;'>9152222222</span>,Максим,Москитов,<span style='color: #00008b;'>1</span>,<span style='color: #00008b;'>31</span>
<span style='color: #00008b;'>9153333333</span>,Олег,Денисов,<span style='color: #00008b;'>3</span>,<span style='color: #00008b;'>34</span>
<span style='color: #00008b;'>9173333334</span>,Алиса,Никифорова,<span style='color: #00008b;'>4</span>,<span style='color: #00008b;'>31</span>
<span style='color: #00008b;'>9173333335</span>,Таня,Иванова,<span style='color: #00008b;'>4</span>,<span style='color: #00008b;'>31</span>
<span style='color: #00008b;'>9213333336</span>,Алексей,Иванов,<span style='color: #00008b;'>7</span>,<span style='color: #00008b;'>25</span>
<span style='color: #00008b;'>9213333331</span>,Андрей,Некрасов,<span style='color: #00008b;'>2</span>,<span style='color: #00008b;'>27</span>
<span style='color: #00008b;'>9213333332</span>,Миша,Рогозин,<span style='color: #00008b;'>2</span>,<span style='color: #00008b;'>21</span>
<span style='color: #00008b;'>9214444444</span>,Алексей,Галкин,<span style='color: #00008b;'>1</span>,<span style='color: #00008b;'>38</span>
</pre>
<br />Вы можете создать эти файлы сами с помощью любого текстового редактора. Напоминаю, что кодировка файлов UTF8.<br />Перед использованием внешних таблиц необходимо создать специальный объект directory указывающий на каталог, где расположены файлы для внешних таблиц<br /><br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>CREATE</span> <span style='color: #0000ff;'>OR</span> <span style='color: #0000ff;'>REPLACE</span> DIRECTORY ext_tab_data <span style='color: #0000ff;'>AS</span> <span style='color: #ff0000;'>'c:/temp'</span>;
</pre>
<br />Здесь <br />•	ext_tab_data – название объекта directory<br />•	AS 'c:/temp' – каталог, где расположены файлы для формирования внешних таблиц.<br />Далее формируем временные таблицы<br />Создаем таблицу для файла city.csv<br /><a href='../oracleandsql/2255'>читать дальше...</a></div>
                                    <div class="info">
                                        добавлено: 18&nbsp;фев&nbsp;19
                                        <span style="float:right">просмотры: 7342, комментарии: <a href="../oracleandsql/2255#add-comment">1</a></span>
                                        <br />
                                        <div id="tags"></div>
                                        <ul class="taglist">
                                        
                                            <li><a href="../oracleandsql/tags/sql">sql</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/oracle">oracle</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/pl%20sql">pl sql</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/create%20table">create table</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/external">external</a></li>
                                        
                                        
                                        </ul>
                                        <br />
    	                                

                                    </div>
								</div>
								<br clear="all" />
							</div>
							
							<div class="article short" id="b2216">
								<hr/>
								<div class="art_desc">
									<h2><a href="../oracleandsql/2216">Sum по disitnct полю , в другой колонке</a></h2>
									<div style="margin:0 0 5px 0"><a href="../../../www.sqladv.ru/default.htm" target="_blank">Чалышев Максим Михайлович</a><br /><a href="../../../landingsql.orasource.ru/default.htm" target="_blank">Учебный тренинг. SQL от новичка до профессионала.</a> <br />  <a href="../../../https@www.youtube.com/channel/UCCMANdkq1T47prGmK9-A3fA" target="_blank">Бесплатные авторские видеокурсы SQL, PLSQL, JAVA</a><br />-- итак требуется найти сумму по distinct полю на основе идентификатора, который находится в другой колонке<br />-- е1сть доп условие нельзя использовать подзапрос, то есть необходимо выполнить задачу за одно обращение<br /><br /><br />-- подготовим данные для тестового примера<br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>drop</span> <span style='color: #0000ff;'>table</span> t; <span style='color: #008000;font-style:italic;'>-- если надо</span>
<span style='color: #0000ff;'>create</span> <span style='color: #0000ff;'>table</span> t <span style='color: #0000ff;'>as</span>
<span style='color: #0000ff;'>WITH</span> r <span style='color: #0000ff;'>AS</span> (
<span style='color: #0000ff;'>select</span> <span style='color: #008080;font-weight:bold;'>/*+ materialize */</span> * <span style='color: #0000ff;'>from</span> ALL_OBJECTS <span style='color: #0000ff;'>WHERE</span> ROWNUM &lt; <span style='color: #00008b;'>100</span> )
<span style='color: #0000ff;'>select</span> object_id <span style='color: #0000ff;'>as</span> id,<span style='color: #0000ff;'>length</span>(r.object_name) <span style='color: #0000ff;'>as</span> fid,
 (<span style='color: #0000ff;'>select</span> <span style='color: #0000ff;'>count</span>(<span style='color: #00008b;'>1</span>) <span style='color: #0000ff;'>from</span> r a <span style='color: #0000ff;'>where</span> <span style='color: #0000ff;'>length</span>(r.object_name) = <span style='color: #0000ff;'>length</span>(a.object_name))  <span style='color: #0000ff;'>as</span> price   
<span style='color: #0000ff;'>from</span> r
</pre>
<br /><br />-- есть  вторичный ключ fid от которого зависит значение в поле price<br />-- необходимо найти сумму по полю price в distinct поля fid одним запросом, то есть без вложенного select<br /><br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>select</span> <span style='color: #0000ff;'>sum</span>(price) sm <span style='color: #0000ff;'>from</span> t 
</pre>
-- это неправильное решение <br /><br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>select</span> <span style='color: #0000ff;'>sum</span>(<span style='color: #0000ff;'>distinct</span> price) sm <span style='color: #0000ff;'>from</span> t 
</pre>
 -- и это неправильное решение price может быть одинаковый для разных fid<br />-- надо как то так   <br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>select</span> <span style='color: #0000ff;'>sum</span>(price <span style='color: #0000ff;'>distinct</span> fid) sm <span style='color: #0000ff;'>from</span> t
</pre>
  -- но так написать нельзя<br /><br />-- первое решение, <br />-- работает быстро, но решение не идеально, ключ может быть и не числовой<br />-- сумма Id + price - сумма id <br />-- , во избежание неприятностей использовали to_number(rpad(fid, 20)<br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>select</span> <span style='color: #0000ff;'>sum</span>(<span style='color: #0000ff;'>distinct</span> <span style='color: #800080;'>to_number</span>(<span style='color: #800080;'>rpad</span>(fid,<span style='color: #00008b;'>10</span>,<span style='color: #ff0000;'>'0'</span>)) +price) -  <span style='color: #0000ff;'>sum</span>(<span style='color: #0000ff;'>distinct</span> <span style='color: #800080;'>to_number</span>(<span style='color: #800080;'>rpad</span>(fid,<span style='color: #00008b;'>10</span>,<span style='color: #ff0000;'>'0'</span>))) <span style='color: #0000ff;'>as</span> sm  <span style='color: #0000ff;'>from</span> t
</pre>
<br /><br />-- решение второе - используем model<br /><pre class="src lang-plsql">
  <span style='color: #0000ff;'>select</span> r <span style='color: #0000ff;'>from</span>  t 
   model
   <span style='color: #0000ff;'>return</span> updated rows   
   <span style='color: #0000ff;'>dimension</span> <span style='color: #0000ff;'>by</span>(id)
  <span style='color: #0000ff;'>measures</span>(<span style='color: #00008b;'>0</span> r, <span style='color: #800080;'>nullif</span>(price, <span style='color: #800080;'>lag</span>(price)<span style='color: #0000ff;'>over</span>(<span style='color: #0000ff;'>partition</span> <span style='color: #0000ff;'>by</span> fid <span style='color: #0000ff;'>order</span> <span style='color: #0000ff;'>by</span> id)) lg)
  <span style='color: #0000ff;'>rules</span> upsert(r[<span style='color: #00008b;'>0</span>] = <span style='color: #0000ff;'>sum</span>(lg)[<span style='color: #0000ff;'>any</span>])
</pre>
</div>
                                    <div class="info">
                                        добавлено: 23&nbsp;май&nbsp;18
                                        <span style="float:right">просмотры: 3029, комментарии: <a href="../oracleandsql/2216#add-comment">1</a></span>
                                        <br />
                                        <div id="tags"></div>
                                        <ul class="taglist">
                                        
                                            <li><a href="../oracleandsql/tags/model">model</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/distinct">distinct</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/select">select</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/sum">sum</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/return">return</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/dimention%20by">dimention by</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/measures">measures</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/with">with</a></li>
                                        
                                        
                                        </ul>
                                        <br />
    	                                

                                    </div>
								</div>
								<br clear="all" />
							</div>
							
							<div class="article short" id="b2213">
								<hr/>
								<div class="art_desc">
									<h2><a href="../oracleandsql/2213">Ретроспективные запросы и корзина ORACLE</a></h2>
									<div style="margin:0 0 5px 0"><a href="../../../www.sqladv.ru/default.htm" target="_blank">Чалышев Максим Михайлович</a><br /><a href="../../../landingsql.orasource.ru/default.htm" target="_blank">Учебный тренинг. SQL от новичка до профессионала.</a> <br />  <a href="../../../https@www.youtube.com/channel/UCCMANdkq1T47prGmK9-A3fA/videos" target="_blank">Бесплатные авторские видеокурсы SQL, PLSQL, JAVA</a><br /><br />А что если нам необходимо узнать , какие данные были в раньше до выполнения операций модификации данных....<br />как это сделать ?, <br />Для этого в Oracle предусмотрен механизм ретроспективных запросов (Flashback Query);<br />То есть, мы можем с помощью запросов посмотреть в прошлое.<br />Пример подобного запроса<br />для примера нам понадобится таблица<br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>create</span> <span style='color: #0000ff;'>table</span> obj_t <span style='color: #008000;font-style:italic;'>-- table </span>
<span style='color: #0000ff;'>as</span> <span style='color: #0000ff;'>select</span> owner, object_type  <span style='color: #0000ff;'>from</span> all_objects <span style='color: #0000ff;'>group</span> <span style='color: #0000ff;'>by</span> owner, object_type;
;
</pre>
<br />запомним время создания таблицы 17:01:01<br /><br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>delete</span> obj_t <span style='color: #0000ff;'>where</span> object_type = <span style='color: #ff0000;'>'TABLE'</span>;
</pre>
<br />удалим наименования таблиц <br />и запомним время 17:10:14<br /><br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>delete</span> obj_t <span style='color: #0000ff;'>where</span> owner <span style='color: #0000ff;'>in</span> (<span style='color: #ff0000;'>'SYS'</span>, <span style='color: #ff0000;'>'SYSTEM'</span>);
</pre>
<br />удалим наименования таблиц <br />и запомним время и запомним время 17:11:22<br /><br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>select</span> *
  <span style='color: #0000ff;'>from</span> obj_t ;
</pre>
<br />нет таблиц , нет обьектов owner = sys system<br /><br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>select</span> *
  <span style='color: #0000ff;'>from</span> obj_t <span style='color: #0000ff;'>as</span> <span style='color: #0000ff;'>of</span> scn timestamp_to_scn(<span style='color: #800080;'>to_timestamp</span>(<span style='color: #ff0000;'>'19/04/2018 17:10:00'</span>,<span style='color: #ff0000;'>'DD/MM/YYYY HH24:MI:SS'</span>)) ;
</pre>
<br />есть таблицы, нет обьектов owner = sys system<br /><br /><pre class="src lang-plsql">
<span style='color: #0000ff;'>select</span> *
  <span style='color: #0000ff;'>from</span> obj_t <span style='color: #0000ff;'>as</span> <span style='color: #0000ff;'>of</span> scn timestamp_to_scn(<span style='color: #800080;'>to_timestamp</span>(<span style='color: #ff0000;'>'19/04/2018 17:11:00'</span>,<span style='color: #ff0000;'>'DD/MM/YYYY HH24:MI:SS'</span>)) ;
</pre>
<br />видим обьекты owner = sys system<br /><a href='../oracleandsql/2213'>читать дальше...</a></div>
                                    <div class="info">
                                        добавлено: 17&nbsp;май&nbsp;18
                                        <span style="float:right">просмотры: 4716, комментарии: <a href="../oracleandsql/2213#add-comment">0</a></span>
                                        <br />
                                        <div id="tags"></div>
                                        <ul class="taglist">
                                        
                                            <li><a href="../oracleandsql/tags/select">select</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/scn">scn</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/to_timestamp">to_timestamp</a></li>
                                        
                                            <li><a href="../oracleandsql/tags/flashback%20">flashback </a></li>
                                        
                                            <li><a href="../oracleandsql/tags/recyclebin">recyclebin</a></li>
                                        
                                        
                                        </ul>
                                        <br />
    	                                

                                    </div>
								</div>
								<br clear="all" />
							</div>
							
                            <!--begin case_hasmoredata-->
						    <div class="order-links">
								<p style="float:right"><a href="../oracleandsql/@skip=11">предыдущие записи</a></p>
								<br clear="all" />
							</div><!--end case_hasmoredata-->
						</div>
					</div>
					<div id="bottom-fade"><div class="wrap"></div></div>
				</div>
			</div>



			<div id="footer" style="padding-bottom:20px">
				<div  style="float:left">2000-2020 © Alex Sibilev, SQL.ru<br/>
					<a style="font: 10px Verdana;color:#88C" href="../../feedback.aspx">Свяжитесь с нами</a></div>
<div style="float:right">Рекомендуем <a href="../../../https@www.datahouse.ru/price/kurskaya_colocation">colocation</a> в DataHouse.RU.</div>
				<div class="counters">
                
				</div>
			</div>
		</div>
		<script>initScripts()</script>
<!-- Yandex.Metrika counter -->
<!--ipt type="text/javascript" > (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)}; m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym"); ym(9237463, "init", { clickmap:true, trackLinks:true, accurateTrackBounce:true });</scri-->
<noscript><div><img src="../../../https@mc.yandex.ru/watch/9237463" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

	</body>
</html>